<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://blog.openenergymonitor.org/posts/16/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="https://blog.openenergymonitor.org/posts/16/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
    
    
    
    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
	
  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    
    <span style="color:#555;font-weight:bold;font-family:Arial;font-size:20"'>
Open</span><span style="color:#0699fa;font-weight:bold;font-family:Arial;font-size:20"'>EnergyMonitor</span>

  </a>
</div>

<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="https://openenergymonitor.org">Main Site</a></li>
  <li><a href="https://guide.openenergymonitor.org">User Guide</a></li>
  <li><a href="https://emoncms.org">Emoncms</a></li>
  <li><a href="https://community.openenergymonitor.org">Community</a></li>
  <li><a href="https://shop.openenergymonitor.com    ">Shop<i class="icon icon-shopping-cart"></i></a></li>
</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

            
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/getting-air-quality-egg-to-work-with/">Getting the Air Quality Egg to work with the OpenEnergyMonitor system and emoncms </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-10T21:16:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-10 21:16:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/air-quality-egg/'>Air Quality Egg</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/getting-air-quality-egg-to-work-with/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">I spent a bit of time today putting a sketch together to get the <a href="http://openenergymonitor.blogspot.co.uk/2013/02/air-quality-egg-sensor-shield.html">AirQuality Egg Shield</a> and <a href="http://openenergymonitor.blogspot.co.uk/2013/02/air-quality-egg.html">Air Quality Egg Remote node</a> to work as a standard sensor node with the OpenEnergyMonitor system, so that I could log data into emoncms to visualise changes over time and use the existing raspberrypi + rfm12pi base station setup thats already receiving data from an emontx and low power temperature nodes.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><span style="font-size: small;">I placed the shield on top of a NanodeRF as it has the RFM12 RF module but Im not actually using the Ethernet part, Im just using the nanode as an arduino with an RFM12 module to form a remote sensor node. This is the same setup as is found inside the&nbsp;</span>Air Quality Egg Remote node.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-hFLyp7hugOI/UbY_UoDQ9rI/AAAAAAAACqk/8k--rKEg83U/s1600/shield.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="357" src="http://1.bp.blogspot.com/-hFLyp7hugOI/UbY_UoDQ9rI/AAAAAAAACqk/8k--rKEg83U/s400/shield.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The sketch is adapted from the PollEggBus_EPA sketch developed by <a href="http://wickeddevice.com/">Wicked Device</a> who develop and make the Air Quality Egg and just puts the NO2, CO, temperature and humidity data in the standard data structure of a series of integer values that the emontx and other nodes use.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Download the sketch here to try it out:</div><div style="margin-bottom: 0cm;"><a href="https://github.com/openenergymonitor/Air-Quality-Egg/blob/master/libraries/EggBus/examples/PollEggBus_openenergymonitor/PollEggBus_openenergymonitor.ino">https://github.com/openenergymonitor/Air-Quality-Egg/blob/master/libraries/EggBus/examples/PollEggBus_openenergymonitor/PollEggBus_openenergymonitor.ino</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I've now been logging for about 3 hours and there's already some interesting data to look at, I got back from being out on my bike and had a shower at 20:50 you can see the RH shoot up, there also seems to be a spike in NO2 and a dip in CO not sure what that means, any ideas?</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-y5QCTJd00pI/UbY_dqJ-P8I/AAAAAAAACqs/uUOOpyo0e6U/s1600/aqe.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="330" src="http://4.bp.blogspot.com/-y5QCTJd00pI/UbY_dqJ-P8I/AAAAAAAACqs/uUOOpyo0e6U/s640/aqe.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">Check out the live dashboard here:</div><div style="margin-bottom: 0cm;"><a href="http://emoncms.org/trystan/aqe">http://emoncms.org/trystan/aqe</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Air quality is not something I know much about but after discussing it with the <a href="http://openenergymonitor.blogspot.co.uk/2013/05/carbon-coop.html">Carbon Coop</a> guys recently it sounds like a fascinating and important area to understand, Matt from Carbon Coop explained that high levels of CO2 (not monitored on the AQE shield above but something that would be great to add - but more expensive) in buildings create problems around drowsiness and ability to concentrate and so monitoring these things could be important when designing and making sure a building after having undergone retrofit work has healthy air. It would also be interesting to understand in greater detail the longer term health implications of air quality and the aspects of this that we can measure. There certainly seems to be a lot of resources on this on the Air Quality Egg wiki here which should make interesting reading: <a href="http://airqualityegg.wikispaces.com/AirQualityEgg">http://airqualityegg.wikispaces.com/AirQualityEgg</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/what-kind-of-information-can-we-extract/">What kind of information can we extract from power measurements?</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-10T11:05:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-10 11:05:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> seven minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/what-kind-of-information-can-we-extract/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">The most direct representation of power data is power over time which is what we get if we simply log the power values transmitted from a monitor.  With this we can see what our power consumption or power generation looks like throughout a day, you can see the relative magnitude of different loads, identify visually different appliances from kettle's to LED&nbsp;light bulbs.</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-pVwxv1iYDHc/UbWl2mW8CtI/AAAAAAAACp0/BowLPfaHiaI/s1600/realtimepowerdata.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="275" src="http://4.bp.blogspot.com/-pVwxv1iYDHc/UbWl2mW8CtI/AAAAAAAACp0/BowLPfaHiaI/s640/realtimepowerdata.png" width="640" /></a></td></tr><tr><td class="tr-caption">The power vs time visualisation can be found under the Vis tab in emoncms by selecting the rawdata visualisation.</td></tr></tbody></table><div style="margin-bottom: 0cm;">Its a useful visual tool and with a little extra stats overlayed on the graph such as how many kwh are  contained in the window being viewed and the average power you can start to do things like calculate roughly how much energy individual appliances use such as a fridge or a particular evenings immersion heater use.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Beyond the basic power vs time graph we can gain more information by processing the incoming power data into kwh per day data. kwh per day data can be calculated as either the average power in watts for a day x 0.024 or the sum of the time spent at different powers divided by the energy in 1 kwh. A graph of kwh per day vs time makes it easy to compare one day against another and see trends over months or years.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-dJHKrtPOmqs/UbWmDU3HFoI/AAAAAAAACp8/dNmlIyznDVE/s1600/kwhddata.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="276" src="http://3.bp.blogspot.com/-dJHKrtPOmqs/UbWmDU3HFoI/AAAAAAAACp8/dNmlIyznDVE/s640/kwhddata.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The daily visualisation can be found under the Vis tab in emoncms by selecting the bargraph visualisation.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">That's pretty good but we can extract more information from the power data if we process the power data to record the energy used at different power levels in a particular day, how much energy is used at 100W, 200W or 3000W. This is what the histogram input processor does in emoncms. The following graph shows the result of recording energy used at different power levels with a 25W resolution over 7 months from my own house. The spike at 2.5kW is an electric heater which we used a lot throughout the winter, the 3.5kW spike is the immersion heater and 0-500W is lights, laptops, hifi etc.</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-XTKqi4OoA04/UbWmPv8ozAI/AAAAAAAACqE/odjmArEnBvs/s1600/detailedhistogram.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="276" src="http://2.bp.blogspot.com/-XTKqi4OoA04/UbWmPv8ozAI/AAAAAAAACqE/odjmArEnBvs/s640/detailedhistogram.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: left;"><b>Note: </b>The histogram visualisation can be found under the Vis tab by selecting histgraph. The default histogram has smaller resolution bars at higher power levels, i need to add an option for higher detailed histogram data calculation in the input process model to make this easier to achieve. To produce the graph above I&nbsp;actual&nbsp;converted the power data feed to histogram data using a conversion module that can be found <a href="https://github.com/emoncms/feedconvert">here</a>. The code that produces the histogram as data is coming in can be found on lines 543 to 608 in the <a href="http://process_model.php/">process_model.php</a>.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">The histogram data can also be visualised within the kwh per day type graph so that we can see how a particular days energy consumption breaks down into energy used at less than say 1kw, energy used between 1 and 3 kW and 3kW up but then also easily compare one day to the next:</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-W9ab4J6RzzE/UbWmaCVzmPI/AAAAAAAACqM/Qd9blj7h1FM/s1600/colhistogram.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="248" src="http://4.bp.blogspot.com/-W9ab4J6RzzE/UbWmaCVzmPI/AAAAAAAACqM/Qd9blj7h1FM/s400/colhistogram.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From the emoncms report module.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">For me, what I want to get out of monitoring my electricity consumption is to first understand how I use electricity and then work out what definite actions I can take to reduce any my electricity consumption and then be able to confirm that those actions did indeed produce the expected result. After all optimisations are done, Id like the monitor and reporting tools to help keep me informed that I am maintaining an optimum electricity use level overtime, that it does not creep up again.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To answer these questions  directly I found I needed one other thing that goes hand in hand with the monitoring and visualisations above, I needed a rough model of my electricity consumption that breaks electricity consumption down on a per appliance basis. Any actions that we take are on an per appliance basis and so we really need a per appliance level of&nbsp;specificity.&nbsp; In the absence of per appliance monitoring or working <a href="http://openenergymonitor.org/emon/buildingblocks/appliance-inference">applianceinference </a>which would be the ultimate solution, this can be done with a simple model where a list of all the appliances in a house is entered manually including how many watts they use (which the energy monitor can be used to find out) and roughly how many hours per day they are used. This produces an estimate for how much electricity is used in a day, what the baseload should be and how much energy is consumed at different powers which can then be cross checked with the actual monitored data, the model can then be adjusted until the values align.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The<a href="https://github.com/emoncms/report"> reporting module</a> in emoncms bring all this together on one page, the screen below shows the monitored data and model for the openenergymonitor lab and the small cottage next door:</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-yHfVXBfcvWg/UbWmtMkigWI/AAAAAAAACqU/4r5H2W8V_4Y/s1600/report.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://2.bp.blogspot.com/-yHfVXBfcvWg/UbWmtMkigWI/AAAAAAAACqU/4r5H2W8V_4Y/s640/report.png" width="403" /></a></td></tr><tr><td class="tr-caption">You can find the reporting module in emoncms.org by clicking on Extras and then report. For local installations install the report module from github <a href="https://github.com/emoncms/report">here</a></td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">To align the model to the monitored data its a matter of aligning the model pie chart to the monitored data pie chart. In our case electricity consumption is highly variable day to day, month to month so the model can only apply to either the average of the days in the selected view or a single particular day, its informative to adjust the model for different times of the year.&nbsp;Once the model aligns well, its then possible to experiment with changing the appliances in the model and how many hours they are used for to see what effect that might have on total daily consumption.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The conclusion of our electricity consumption investigation is that we could save 5-10% by changing all CFL's to LED's and turning standby items off at the plug (especially the hifi and soldering iron station), continuing to optimise kettle use and immersion heater is also super important as leaving a 2800W kettle on for an extra minute uses as much as a 6W LED left on for 7-8 hours and so can easily remove any savings achieved by turning lights off.&nbsp;</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To significantly reduce electricity consumption further we would need to change the heating system and to take a whole house view: improve the building fabric performance by increasing insulation levels, reducing draughts and improving solar gain in order to reduce heating demand in the first place which is where recent work on temperature sensing, building energy modelling, the SAP calculator comes in but I will come back to that in further blog posts.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It would be nice to add additional tabs to the report module so that current and projected consumption levels can be easily compared, Id also like to add a feature to send a regular report email that keeps me updated on my week to week electricity consumption so that I can get at a glance information that minimises the effort I need to go to to see how I'm doing.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/emontx-shield-smt-with-new-layout-in/">Emontx Shield SMT with new layout in development</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-06T08:58:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-06 08:58:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emontxshield/'>emonTxShield</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/emontx-shield-smt-with-new-layout-in/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">Several weeks ago we got an email with a series of pictures showing the problem that the emontx shield does not stack well with many of the base boards and other shields it may be used in conjunction with.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It got me thinking about different ways the shield could be arranged that would make it stack better with a variety of different boards. The main idea I had was to move the AC-AC Adapter and CT inputs over to the other side of the PCB away from the side the Ethernet and USB sockets are usually located on most of the Arduino boards and the NanodeRF. The second idea was to mount these sockets on the underside of the PCB which allows for a really thin profile NanodeRF + EmonTx shield stack which I think is pretty neat if a little unconventional. Here's the concept drawing:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ebSgZTNiTfQ/UbBM01WOocI/AAAAAAAACpM/o9PdnM3zn_M/s1600/emontxhield_concept.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="135" src="http://1.bp.blogspot.com/-ebSgZTNiTfQ/UbBM01WOocI/AAAAAAAACpM/o9PdnM3zn_M/s400/emontxhield_concept.jpg" width="400" /></a></div><div align="CENTER" style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">As you may be aware I have not really ventured into PCB design much before (I usually work on software) but its been something I wanted to do for a while so I thought Id have a go at the emontx shield redesign as its one of the simplest layouts. With Glyn's helpful guidance I started by loading the existing&nbsp;schematic&nbsp;and board files for the through hole emontx shield in eagle, I then ripped up all the existing PCB tracks, rearranged the components in different layouts and&nbsp;switched&nbsp;the resistors and capacitors over to SMT packages. Here's a screenshot of the resultant board design:</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-XGmRf3-FXA8/UbBNCmP3KqI/AAAAAAAACpU/zM5G-Bgo7ow/s1600/board.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="305" src="http://3.bp.blogspot.com/-XGmRf3-FXA8/UbBNCmP3KqI/AAAAAAAACpU/zM5G-Bgo7ow/s400/board.png" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">I spend most of my dev time writing lines of code which becomes a visual output in a second step, PCB design is a different experience as its all&nbsp;immediately&nbsp;visual, dragging and dropping pcb tracks, trying to see if this track that way or another in its place looks neater, its a nice change. If your intrigued to have a go I'd recommend installing eagle, loading up one of the board designs that are all up on solderpad and experiment with routing tracks, maybe adding/removing a temperature sensor.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The PCB's arrived on Tuesday, I built it up and have started to test it, so far everything seems to be working, energy monitoring part, RFM12, Led, DS18B20 temperature sensor, Arduino Uno, Arduino Duemilanove. Next I will test the NanodeRF and Id also like to test an Arduino official Ethernet shield.  </div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-w5udfxyOmRo/UbBNfsmIzUI/AAAAAAAACpc/Clmgc4ezTSU/s1600/emontxshieldsmt_01.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="210" src="http://1.bp.blogspot.com/-w5udfxyOmRo/UbBNfsmIzUI/AAAAAAAACpc/Clmgc4ezTSU/s400/emontxshieldsmt_01.jpg" width="400" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-4-C2YEWW5YQ/UbBNiYu1VSI/AAAAAAAACpk/bRTI26DWHhM/s1600/emontxshieldsmt_02.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="275" src="http://3.bp.blogspot.com/-4-C2YEWW5YQ/UbBNiYu1VSI/AAAAAAAACpk/bRTI26DWHhM/s400/emontxshieldsmt_02.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div align="CENTER" style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><b>Things to improve</b></div><div style="margin-bottom: 0cm;">There is a very slight misalignment on the ISP header that needs fixing although it still stacks together fine and Glyn pointed out that the option to choose different SS (SEL) and IRQ pins for the RFM12 could be achieved using a manual jumper rather than solderable pads. Id also like to add a terminal for the DS18B20 on the edge of the board for neater connection of temperature sensor strings.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Once these are fixed we will get a run of boards made, it will probably be another month or two at least until its in the shop as these things take time.  </div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><b>Open Hardware Schematics and Board files</b></div><div style="margin-bottom: 0cm;">All available on solderpad here:</div><div style="margin-bottom: 0cm;"><a href="http://solderpad.com/trystanlea/emontx-shield-smt/">http://solderpad.com/trystanlea/emontx-shield-smt/</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/removing-redundant-datapoints-algorithm/">Removing redundant datapoints – algorithm 1</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-05T11:22:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-05 11:22:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/removing-redundant-datapoints-algorithm/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">You could probably say that the aim of an algorithm that removes redundant datapoints is to create a line plot who's standard deviation compared to the raw data line is as small as possible while minimising the number of datapoints. This is probably a good rough criteria for evaluating a prospective algorithm.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Here's one idea for an algorithm, I think it can certainly be improved upon but its a start.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">If we start with our monitor that's posting once every 10 seconds. If we note down the first datapoint received and then as subsequent datapoints come in draw a line between the first and the last datapoint.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-POXZpyzURpw/Ua8dhYHXDZI/AAAAAAAACos/u0n-xrGlb7Q/s1600/algorithm1_01.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="182" src="http://2.bp.blogspot.com/-POXZpyzURpw/Ua8dhYHXDZI/AAAAAAAACos/u0n-xrGlb7Q/s400/algorithm1_01.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;">Then lets say there is a step change, a light goes on, suddenly the line is much higher than the actual data for most datapoints:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-0uEjg3xFhN0/Ua8dpNt6r5I/AAAAAAAACo0/THdnRwLHAKE/s1600/algorithm1_02.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="185" src="http://1.bp.blogspot.com/-0uEjg3xFhN0/Ua8dpNt6r5I/AAAAAAAACo0/THdnRwLHAKE/s400/algorithm1_02.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;">If we measure the standard deviation of the raw datapoints vs the line to begin with it will be small, once that step change happens it will become much larger.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">At this point we note a significant change has happened (stdev is larger than a threshold) and create a datapoint one back from the last datapoint (the bottom of the step).</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">We can then move our 'start' datapoint forward to this created datapoint and repeat the process. This should do a pretty good job of tracking the raw data.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To test it I have created a visualisation that applies this algorithm using javascript in the browser here is the result:</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-2S_rUF2Qns8/Ua8dyeX9RtI/AAAAAAAACo8/TXvcY5KBAC4/s1600/algorithm01_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="173" src="http://1.bp.blogspot.com/-2S_rUF2Qns8/Ua8dyeX9RtI/AAAAAAAACo8/TXvcY5KBAC4/s400/algorithm01_3.png" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It works pretty well reducing 1064 datapoints to 52, but it does look messy in places.</div><div style="margin-bottom: 0cm;">To try out the code for the above, make a backup of the script:</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><i>emoncms/Modules/vis/visualisations/rawdata.php</i> in your local emoncms installation.&nbsp;</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">and replace with this:</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><a href="https://github.com/emoncms/usefulscripts/blob/master/ideas/rawdata.php">https://github.com/emoncms/usefulscripts/blob/master/ideas/rawdata.php</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">If you can think of a good algorithm to do this, It would be great to hear about it.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/removing-redundant-datapoints-part-1/">Removing redundant datapoints - part 1</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-04T09:38:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-04 09:38:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/removing-redundant-datapoints-part-1/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">As I mentioned before another idea for reducing disk use is compression by removing redundant datapoints. Describing our plot with the least possible number of datapoints. Before energy monitoring I first learnt programming writing some basic 3d games and physics simulations using OpenGL, I was always&nbsp;fascinated&nbsp;by trying to create 3d landscapes, one of the techniques used to generated large landscapes is called level-of-detail terrains where you increase the polygon count where there is lots of detail I.e a mountain ridge or reduce the polygon count where there isnt ie a flat plain. I've been wondering for a while whether a similar approach could be taken to describe timeseries data so we increase the datapoint rate where there is a big change (ie when the kettle, light, fridge goes on) so that we get that event exactly at the right point in time and reduce the rate when not much is happening.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I tried to do something along these lines a few years back where the hardware would only post to the server on a step change in the power signal, the code is still up here as part of the appliance inference work I was experimenting with: <a href="http://openenergymonitor.org/emon/buildingblocks/appliance-inference">http://openenergymonitor.org/emon/buildingblocks/appliance-inference</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The problem was that it was failing when events happened too frequently, ie a thermostat controlled cooker&nbsp;cycling&nbsp;on and off. The event detection algorithm relied upon two 5 datapoint segments next to each other, when the difference between the average of the segments where larger than a threshold an event would be registered. A 10 datapoint segment spanning ~ 100s at 10s per datapoint or 50 seconds at 5s is too large and will miss events that happen to frequently. The other problem with this approach is that it wont work for temperature data which is more a change of gradient than power data steps.  </div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Anyway with the problem of large emoncms disk space demand I have been thinking about this idea again. Could it be used to reduce disk space use significantly without loosing vital timing on events that would happen by just reducing the post interval rate. I had a good conversation with the guys at houseahedron <a href="https://twitter.com/Housahedron">https://twitter.com/Housahedron</a>who came to visit last week about this, they had been thinking along similar lines and saw parallels with an approach used in path plotting, they took a couple of example datasets back with them to see if they can find a way to parse it.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The screenshot below shows the solar hot water pump coming on for 40 mins at the beginning of a bright sunny day. The raw data would use 720 datapoints at a 10s post interval to describe the plot. Overlayed on the raw data plot I have drawn a second line that only has datapoints where needed to keep the  standard deviation between the lines roughly within an acceptable limit, in this case 10 datapoints seems to be enough to do this. If this kind of datapoint reduction rate is typical then a 60Mb mysql table with the current emoncms implementation might only take up 0.83Mb of space per year.</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-9484HO0ijiA/Ua20PKS7ivI/AAAAAAAACoU/bEP6NlDbjnE/s1600/01.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="http://3.bp.blogspot.com/-9484HO0ijiA/Ua20PKS7ivI/AAAAAAAACoU/bEP6NlDbjnE/s640/01.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Zooming in a bit, rather than 270 datapoints, this could be described with 8. (at this datapoint reduction rate 60Mb would compress to ~1.8Mb)</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ezmsjqyzuzw/Ua20VzX0VGI/AAAAAAAACoc/u_HXX1dlLYU/s1600/02.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="278" src="http://2.bp.blogspot.com/-ezmsjqyzuzw/Ua20VzX0VGI/AAAAAAAACoc/u_HXX1dlLYU/s640/02.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">In addition to reducing disk space, it may be possible to use this technique to increase the resolution of our measurement as we are oversampling in regions where there are no large changes</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">This atmel appnote describes how to use oversampling and decimation to achieve greater measurement resolution:</div><div style="margin-bottom: 0cm;"><a href="http://www.atmel.com/Images/doc8003.pdf">http://www.atmel.com/Images/doc8003.pdf</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I think there are two main development questions facing this idea:</div><ol><li><div style="margin-bottom: 0cm;">Can a good enough algorithm be  developed to compress the data while retaining the detail we want.</div></li><li><div style="margin-bottom: 0cm;">What are the implications for data  query speeds?</div></li></ol><div style="margin-bottom: 0cm;">The above said, I think <a href="http://openenergymonitor.blogspot.com/2013/06/timestore-timeseries-database.html">timestore looks like the leading solution at the moment</a> for data storage and fast query speeds. With timestore we can achieve an 80% reduction in disk space demand from <a href="http://openenergymonitor.blogspot.com/2013/05/the-current-emoncms-feed-storage.html">60Mb per 10s feed per year</a> to 12.3 Mb, this would reduce the disk space use on emoncms.org from 47GB to 9.6GB, disk space use would increase at 20GB per year (costing £96 per 20GB stored inc backup <a href="http://openenergymonitor.blogspot.com/2013/05/emoncmsorg-load-stats.html">instead of £480/year</a>) and most of its already there in terms of implementation.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It might just be interesting to explore the datapoint reduction idea in parallel to see if further disk space&nbsp;reductions&nbsp;can be achieved but without sacrificing on query speeds which is the open question. If feeds could be compressed to 1.8Mb from 60Mb emoncms.org disk use would shrink from 47GB to 1.2GB and disk space would increase at a rate of 2.6 GB a year which would make server disk space costs pretty&nbsp;negligible.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/timestore-timeseries-database/">Timestore timeseries database</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-03T14:03:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-03 14:03:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/timestore-timeseries-database/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    The first and most developed solution to both the query speed problem and disk space problem is timestore.<br /><br /><a href="http://www.mike-stirling.com/redmine/projects/timestore" style="color: #3465a4;">http://www.mike-stirling.com/redmine/projects/timestore</a><br /><br />Timestore is a lightweight time-series database developed by Mike Stirling. It uses a NoSQL approach to store an arbitrary number of time points without an index.<br /><br /><b>Query speeds</b><br />Timestore is fast, here's the figures given by Mike Stirling on the documentation page:<br /><br />From the resulting data set containing 1M points spanning about 1 year on 30 second intervals:<br /><br />Retrieve 100 points from the first hour: 2.6 ms<br />Retrieve 1000 points from the first hour (duplicates inserted automatically): 6.2 ms<br />Retrieve 100 points over the entire dataset (about a year worth): 2.5 ms<br />Retrieve 1000 points over the entire dataset: 7.0 ms<br /><br /><b>Disk use</b><br /><br />Timestore uses a double as a default data type which is 8 bytes. The current emoncms mysql database stores data values as floats which take up 4 bytes, its easy to change the data type in timestore so for a fair comparison we can change the default datatype to a 4-byte float:<br /><br />Layer 1: 10s layer = 3153600 datapoints x 4 bytes = 12614400 bytes<br />Layer 2: 60 layer1 datapoints averaged = 52560 datapoints x 4 bytes = 210240 Bytes<br />Layer 3: 10 layer2 datapoints averaged = 5256 datapoints x 4 bytes = 21024 bytes<br />Layer 4: 6 layer3 datapoints averaged = 876 datapoints x 4 bytes = 7008 bytes<br />Layer 5: 6 layer4 datapoints averaged = 146 datapoints x 4 bytes = 1168 bytes<br />Layer 6: 4 layer5 datapoints averaged = 36 datapoints x 4 bytes = 288 bytes<br />Layer 7: 7 layer6 datapoints averaged = 5 datapoints x 4 bytes = 40 bytes<br /><br /><b>total size = 12854168 Bytes or 12.26Mb</b><br /><br />The current emoncms data storage implementation uses 60Mb to hold the same data as it saves both the timestamp and an associated index. Timestore therefore has the potential to reduce diskuse by 80% for realtime data feeds.<br /><br />Interestingly all the downsampled layers created by timestore only come too <b>0.23 Mb</b>. Before doing the calculation above I used to think that adding all the downsampled layers would add to the problem of disk space significantly but evidently it a very small contribution compared with the full resolution data layer.<br /><br /><b>Emoncms timestore development branch</b><br /><br />I made a start on integrating timestore in emoncms, there's still a lot to do to make it fully functional but it works as a demo for now, here's how to get it setup:<br /><br /><b>1) Download, make and start timestore</b><br /><br />$ git clone <a href="http://mikestirling.co.uk/git/timestore.git" style="color: #3465a4;">http://mikestirling.co.uk/git/timestore.git</a><br />$ cd timestore<br />$ make<br />$ cd src<br />$ sudo ./timestore -d<br /><br />Fetch the admin key<br /><br />$ cd <a href="http://www.blogger.com/var/lib/timestore" style="color: #3465a4;">/var/lib/timestore</a><br />$ nano adminkey.txt<br /><br />copy the admin key which looks something like this: POpP)@H=1[#MJYX&lt;(i{YZ.0/Ni.5,g~&lt;<br />the admin key is generated anew every time timestore is restarted.<br /><br /><b>2) Download and setup the emoncms timestore branch</b><br /><br />Download copy of the timestore development branch<br /><br />$ git clone -b timestore <a href="https://github.com/emoncms/emoncms.git" style="color: #3465a4;">https://github.com/emoncms/emoncms.git</a> timestore<br /><br />Create a mysql database for emoncms and enter database settings into settings.php.<br /><br />Add a line to settings.php with the timestore adminkey:<br />$timestore_adminkey = "POpP)@H=1[#MJYX&lt;(i{YZ.0/Ni.5,g~&lt;";<br /><br />Create a user and login<br /><br />The development branch currently only implements timestore for realtime data and the feed/data api is restricted to timestore data only which means that daily data does not work. The use of timestore for daily data needs to be implemented.<br /><br />The feed model methods implemented to use timestore so far are create, insert_data and get_data.<br /><br /><b>Try it out</b><br /><br />Navigate to the feeds tab, click on feed API helper, create a new feed by typing:<br /><a href="http://localhost/timestore/feed/create.json?name=power&amp;type=1" style="color: #3465a4;">http://localhost/timestore/feed/create.json?name=power&amp;type=1</a><br /><br />It should return {"success":true,"feedid":1}<br /><br />Navigate back to feeds, you should now see your power feed in the list.<br />Navigate again to the api helper to fetch the insert data api url<br /><br />Call the insert data api a few times over say a minute (so that we have at least 6 datapoints - one every 10 seconds).&nbsp;Vary the value to make it more interesting:<br /><a href="http://localhost/timestore/feed/insert.json?id=1&amp;value=100.0" style="color: #3465a4;">http://localhost/timestore/feed/insert.json?id=1&amp;value=100.0</a><br /><br />Select the rawdata visualisation from the vis menu<br /><a href="http://localhost/timestore/vis/rawdata&amp;feedid=1" style="color: #3465a4;">http://localhost/timestore/vis/rawdata&amp;feedid=1</a><br /><br />zoom to the last couple of minutes to see the data.<br /><br /><br />I met Mike Stirling a little over a month ago in Chester for a beer and a chat after Mike originally got in contact to let me know about timestore. We discussed data storage, secure authentication, low cost temperature sensing and <a href="http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html">openTRV</a> the project Mike is working on. I think there could be great benefit to work on making what we're developing here with openenergymonitor interoperable with what Mike and others are developing with openTRV, especially as we develop more building heating and building fabric performance monitoring tools. This could all develop into a super nice open source whole building energy (both electric and heat) monitoring and control ecosystem of hardware and software tools.<br /><br />Check out Mike's blog here:<br /><br /><a href="http://www.mike-stirling.com/">http://www.mike-stirling.com/</a><br />and&nbsp;<a href="http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html">http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html</a>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/the-current-emoncms-feed-storage/">The current emoncms feed storage implementation</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-31T21:39:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-31 21:39:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
     <br>
    
      <a class='comments'
         href="/2013/05/the-current-emoncms-feed-storage/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div>Following on from the last blog post on <a href="http://openenergymonitor.blogspot.co.uk/2013/05/emoncmsorg-load-stats.html">emoncms.org server load and disk use</a>, lets look at the current emoncms implementation of feed storage in a bit more depth before going on to look at how it can be improved.</div><div><br /></div><div>Emoncms currently stores realtime feed data in a mysql database, every feed has its own mysql table. A feed table contains two fields: timestore and data value. Feed data is usually on a regular time interval, ie: 5,10,60s data. The time interval is set by the posting sensor node rather than emoncms.</div><div><b><br /></b></div><div><b>Calculating feed disk use</b></div><div>We can calculate the estimated feed table size using the current implementation used in emoncms.</div><br />Lets say we want to store a year of 10s data. There are 31536000 seconds in a year and so 3153600 datapoints at a 10s data rate.<br /><br />A single datapoint is made up of a timestamp which is stored as an unsigned integer, which takes up 4 bytes, and a float data value which also takes up 4 bytes.<br /><br />3153600 datapoints x 8 bytes per datapoint (table row) = 24 Mb<br /><br />In addition to the feed data we also have a table index which speeds up queries considerably. The worst case index size can be estimated with the equation detailed on this page:<br /><br /><a href="http://dev.mysql.com/doc/refman/5.0/en/key-space.html" style="color: #3465a4;">http://dev.mysql.com/doc/refman/5.0/en/key-space.html</a><br /><br />index row size = (key_length+4) / 0.67<br /><br />The key we are using is the time field which is 4 bytes and so the index row size is = (4 + 4) / 0.67 =~ 12 bytes<br /><br />The index size for 3153600 datapoints is&nbsp;therefore&nbsp;approximately = 3153600 * (4 + 4) / 0.67  = 36Mb<br /><br />The total feed table size will therefore be approximately 60Mb.<div><br /></div><div><b>Feed query speeds</b></div><div>        <div style="margin-bottom: 0cm;">As emoncms has developed a fair bit of work has gone into improving the method that realtime data is queried.&nbsp;At first improvements seem promising, see this documentation page for detailed discussion on the query implementation and query speeds:</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><a href="http://emoncms.org/site/docs/developdatastorage">http://emoncms.org/site/docs/developdatastorage</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">But&nbsp;growing&nbsp;server demand on emoncms.org and feed table size means they have often only staved off an eventual slow down.&nbsp;</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I think the last idea I had of using a php for-loop to request a single row at given intervals that originally &nbsp;reduced query times by about 10x is no longer working well on emoncms.org, it still gives the 1.6s query time on my local installation of emoncms but on emoncms.org Im getting a mixture of short query times 500ms and much longer query times 20s+ (in the more than 55 hour timewindow).&nbsp;The reason for this I think is due to the php for loop having to wait when the server is under heavy load for other mysql queries to complete. I think another solution is needed.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">In the next few blog posts I will look at some of the potential solutions to both disk use and query speeds.</div></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/emoncmsorg-load-stats/">Emoncms.org load stats</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-30T12:10:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-30 12:10:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> five minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/emoncmsorg-load-stats/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div class="separator" style="clear: both; text-align: left;">You might be wondering what kind of load is on emoncms.org, maybe you have experienced it slow down from time to time and then other times be much faster, maybe your just intrigued&nbsp;about how much its used and what are the challenges with hosting a site like this. So what better way to investigate the load on emoncms.org that use the visualisation features built into emoncms itself.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">This first graph is of server load since late January 2013 as recorded by the command 'uptime'. You can see a clear drop in load on the 16th of March where the&nbsp;re-factored emoncms v5 was introduced with its reduction in mysql queries in input processing:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-vz--c_fGLKc/UaZzZ_sRaWI/AAAAAAAACns/vQlipYYkFzU/s1600/1minload.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="273" src="http://2.bp.blogspot.com/-vz--c_fGLKc/UaZzZ_sRaWI/AAAAAAAACns/vQlipYYkFzU/s640/1minload.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;">On a shorter time scale the load fluctuates at what seems to be periodic intervals with a significant spike every 10-12 minutes, a load of 3 is enough to make emoncms feel slightly sluggish on feed data requests.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-JhEGB9gOyE0/UaZzZYkYMfI/AAAAAAAACnc/bO55U8Par4M/s1600/4h1min.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="268" src="http://3.bp.blogspot.com/-JhEGB9gOyE0/UaZzZYkYMfI/AAAAAAAACnc/bO55U8Par4M/s640/4h1min.png" width="640" /></a></div>This graph shows the number of feeds that where updated sometime in the last 5 minutes (not the number of feed updates in the last 5 mins which is much higher). I use this graph to check that an emoncms update has not caused a big drop off in active feeds, I check to make sure that the number of active feeds returns to the same level after an update.<br /><br />The number of active feeds has grown from around 1350 to 2100 (750) since early March 2013, just over 300 new active feeds a month. The total number of feeds created in all time is 15660 a portion of these will have been deleted and replaced with new feeds, a portion will just be inactive.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-0aFZMWgBnbE/UaZzZ5X2ZrI/AAAAAAAACng/vinsexlFFHQ/s1600/activefeeds5min.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="278" src="http://1.bp.blogspot.com/-0aFZMWgBnbE/UaZzZ5X2ZrI/AAAAAAAACng/vinsexlFFHQ/s640/activefeeds5min.png" width="640" /></a></div>Zooming in again on the last 4 hours shows that there are about 120 feeds that are updated on a longer than 5 min timescale and there&nbsp;doesn't&nbsp;seem to be a clear correlation between the server load spikes above and the update spikes here. Maybe some kind of&nbsp;mechanism&nbsp;to&nbsp;even&nbsp;out the load could be a beneficial feature to look into.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-uCaBsAHSkbs/UaZzaUPToWI/AAAAAAAACno/vBNAL13zP-Y/s1600/activefeeds5min_last4hours.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="http://1.bp.blogspot.com/-uCaBsAHSkbs/UaZzaUPToWI/AAAAAAAACno/vBNAL13zP-Y/s640/activefeeds5min_last4hours.png" width="640" /></a></div><br /><div class="separator" style="clear: both; text-align: left;">The next graph is the last server load related graph, it shows the time in seconds taken by the server to serve all requests, you can see again the time saved by the emoncms v5 implementation of input processing (the change of gradient on the 16th of March). High load events are also clearly visible as steps, some of these events made emoncms.org unresponsive for quite sometime, one of the larger high load events lasted 40 mins.</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-424rxwcdk38/UaZzbdHO_8I/AAAAAAAACoA/GcSUNwgdlz8/s1600/timelog.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="http://3.bp.blogspot.com/-424rxwcdk38/UaZzbdHO_8I/AAAAAAAACoA/GcSUNwgdlz8/s640/timelog.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b>Emoncms.org disk use</b></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Apart from load spikes, disk use is probably the most pressing concern with emoncms.org and probably emoncms in general. Disk use is growing pretty fast rising from 22GB at the start of&nbsp;February&nbsp;to 47GB now at the end of May. The vast majority of this is realtime feed data. I need to measure for certain but I think all the other tables including daily averages and histogram data come to only a few hundred MB.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-Kz6SS2XHOlk/UaZzahpekrI/AAAAAAAACn4/ZtG6cbYHGmc/s1600/diskspace.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="278" src="http://2.bp.blogspot.com/-Kz6SS2XHOlk/UaZzahpekrI/AAAAAAAACn4/ZtG6cbYHGmc/s640/diskspace.png" width="640" /></a></div><br /><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">Disk use is rising at about 280 Mb a day so about 100 GB a year, disk space is charged for on a monthly basis (£2 per month for 10GB&nbsp;<a href="http://www.bigv.io/prices">http://www.bigv.io/prices</a>). For every 100GB stored the annual cost would therefore be £240 per 100GB per year without backup and £480 a year with second bigv server used for backup, so even if the number of feeds that are posting to emoncms.org stay constant and there are no new users, disk use costs for&nbsp;existing&nbsp;users will continue to rise if historic data is retained in its current form.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">Luckily there are several potential solutions to this which I will come back to in another blog post, the most promising one being a method of compressing the data without loosing the vital time resolution on feed events.&nbsp;Essentially&nbsp;removing redundant datapoints, only preserving datapoints where changes are happening. This should be a beneficial feature for raspberry pi installations of emoncms as well where disk space is also at a premium.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">So to summarise, I think there are two design challenges identified above that would be good to tackle going forward with emoncms:</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">- How to identify the source of and either distribute or limit the effect of whatever is causing load spikes.</div><div class="separator" style="clear: both;">- How to fix the disk space use problem.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">While fixing these it would also be good to reduce query times and retain the vital resolution on feed events.</div><div class="separator" style="clear: both;"><br /></div><div class="separator" style="clear: both;">Apart from challenges the above graphs show the success of emoncms.org which is exciting, its great to see people use it, that's really encouraging. Lets keep rising the bar with what's possible with a fully open source cloud&nbsp;application energy monitoring service.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/recent-commits-to-emoncms/">Recent commits to emoncms</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-29T11:33:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-29 11:33:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/recent-commits-to-emoncms/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br />There have been many great recent commits to emoncms thanks to PlaneteDomo, Baptiste Gaultier, Simon Stamm, Erik Karlsson (IntoMethod), Bryan Mayland (CapnBry), Ildefonso Martínez, Paul Reed and Jerome. Including improved translations, ability to translate javascript, query speed-ups, a working remember me implementation and work on the raspberry pi module. I thought Id write this blog post to draw attention to the great contributions that are being made and so that credit goes where its due:<br /><br /><b>Summary of additions:</b><br /><br /><a href="https://github.com/PlaneteDomo"><b>PlaneteDomo</b></a> - Implementation of a clean way of adding ability to translate text previously defined in javascript <a href="https://github.com/emoncms/emoncms/pull/72">https://github.com/emoncms/emoncms/pull/72</a><br /><br /><a href="https://github.com/bgaultier"><b>Baptiste Gaultier</b></a> (bgaultier) - A lot of French translation work<br /><br /><a href="https://github.com/simonstamm"><b>Simon Stamm</b></a> - Added ability to display yen and euro in zoom visualisation, including an option to place the currency after the value ( 1 = after value, 0 = before value)<br /><a href="https://github.com/simonstamm/emoncms/commit/39af426ecd9eabffefbc12712bfea9ed2503a5f5">https://github.com/simonstamm/emoncms/commit/39af426ecd9eabffefbc12712bfea9ed2503a5f5</a><br />and fixed issue with floatval and json_decode: <a href="https://github.com/emoncms/emoncms/pull/78">https://github.com/emoncms/emoncms/pull/78</a><br /><br /><a href="https://github.com/IntoMethod"><b>Erik Karlsson</b></a> (IntoMethod) -&nbsp;Fixed dashboard height issue, thanks to Paul Reed for reporting this bug on the forums: <a href="http://openenergymonitor.org/emon/node/2013">http://openenergymonitor.org/emon/node/2013</a><br /><br />Addition of async ajax calls for some visualisations <a href="https://github.com/emoncms/emoncms/pull/71">https://github.com/emoncms/emoncms/pull/71</a> this makes the dashboard feel alot snappier and page load is about 4-5 times faster.<br /><br />Also a really significant fix that I've been really enjoying, Erik&nbsp;Karlsson&nbsp;fixed the remember me implementation that I failed to get to work properly: <a href="https://github.com/emoncms/emoncms/pull/69">https://github.com/emoncms/emoncms/pull/69</a><br /><br /><a href="https://github.com/CapnBry"><b>Bryan Mayland</b> </a>(CapnBry) -&nbsp;Improved feed/data request query times: <a href="https://github.com/emoncms/emoncms/pull/63">https://github.com/emoncms/emoncms/pull/63</a> adds a 3rd query type using the mysql average method for times less than 50 hours (180,000 seconds).<br /><br /><b><a href="https://github.com/ildemartinez">Ildefonso Martínez</a> </b>(ildemartinez) - javascript code&nbsp;re-factoring<br /><br /><a href="https://github.com/Paul-Reed"><b>Paul Reed</b></a> - tab between fields when logging in, average field in visualisations moved to the right.<br /><br /><a href="https://github.com/Jerome-github"><b>Jerome</b></a> (Jerome-github)&nbsp;A lot of work on the RaspberryPI emoncms module including continued work on the python gateway script. For ongoing discussion on raspberrypi module development see the github issues page here: <a href="https://github.com/emoncms/raspberrypi/issues/30">https://github.com/emoncms/raspberrypi/issues/30</a><br /><br />Id really like to thank these guys and everyone who continues to help out with development, there's a lot of hard work going in that's really pushing things forward.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/05/emoncmsorg-backup/">Emoncms.org backup</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-05-28T11:15:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-05-28 11:15:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/05/emoncmsorg-backup/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p dir=ltr>I'm happy to announce that emoncms.org is fully backed up and has incremental backup implemented, all data is incrementally backed up once every 24 hours, a backup cron job runs hourly syncing 640 feeds each time so 15360 feeds every 24 hours. emoncms.org disk use is currently growing at a rate of about 300MB a day and the transfer format is csv which gives you an idea of the volume of data that the backup implementation needs to sync. The total volume of data I have synced so far using this is 49 GB. </p><p dir=ltr>The backup implementation uses many of the things already developed as part of the sync module which allows you to download feed data from a remote server. I've put the full emoncms backup script in the tools repository on github here:</p><p dir=ltr><a href="https://github.com/emoncms/usefulscripts/blob/master/backupemoncms.php">https://github.com/emoncms/usefulscripts/blob/master/backupemoncms.php</a></p><p dir=ltr>For the above script to run, you need to first copy the users and feeds table from the master server to the backup server using the more common backup procedure of using mysqldump and scp, the steps to do this are described in the header comments of the backup script.</p><p dir=ltr>This method of backing up is much faster than using rsync which I originally tried for incremental backup as it does not go through each feed looking for changes it just checks when was the last datapoint in the backed up feed and downloads every new datapoint from the master server recorded after that time, one disadvantage of this is that any changes to feed data using the datapoint editor tools in emoncms will not get updated to the backup server. It would be good though to make it possible to delete data on the backup server if its deleted off the master server, as disk space is expensive and if you delete data off emoncms.org you would expect no copy to remain from a data privacy point of view.</p><p dir=ltr>I implemented the backup system like this because I had most of what I needed already in place in the sync module and so it was the quickest way for me to get this up and running using what I already knew. I'm aware the database replication can be performed with mysql replication, where a transaction log is stored on the master server and transferred to and then executed on the backup server. I'm interested in exploring this option too and if anyone can tell me that using mysql replication will offer significant performance benefits over the method above and why, that would certainly motivate me to look at it sooner.</p><p dir=ltr>I'm still reluctant to guarantee data on emoncms.org as both vm servers are in the same datacenter and they are part of bigv cloud which could even mean that both share the same disk (which would invalidate one of the reasons for a separate backup to protect against disk failure) although bigv suggested that this is unlikely as there are plenty of tails. They recognise this as a weakness and something they hope to change soon. </p><p dir=ltr>So if you want extra peace of mind I suggest installing a local installation of emoncms on your own computer and downloading your data periodically using the sync module, I do this both for extra backup and so that I can access the raw data for trying new visualisation and data analysis, processing ideas. I will write a guide on how to do this soon. The sync module is available here:</p><p dir=ltr><a href="http://github.com/emoncms/sync">http://github.com/emoncms/sync</a></p><p dir=ltr>I'm interested in being transparent about how emoncms.org is hosted, so that rather than give opaque promises you can asses things like how its backed up for yourself. You often here people say that no system is absolutely secure and completely safe from failure so I hope that by being transparent about this you can see what has been done. I'm relatively new to administering web services and I'm sure if your a more experienced web admin reading this you may know how this can be done better, I would appreciate hearing how you think it could be improved.</p>
    
  </div>
  </article>
  <hr>
  
 
  <div class="pagination">
    
      <a class="btn pull-left" href="/posts/17">&larr; Older</a>
    

    
    <a class="btn pull-right" href="/posts/15">Newer &rarr;</a>
    
  </div>




<!--Site Nav-->


<style>
.dropbtn {
  position: fixed;
  bottom: 0;
  left: 0;
  color: #ffffff;
  background-color: #FFA500;
  cursor: pointer;
  height: 70px;
  width: 70px;
  border-top-right-radius: 10%;
  text-align: center;
  padding-top: 8px;
  font-size: 40px;
  color: #000000;
  font-weight: bold;
}
.dropdown {
    position: relative;
    z-index: 22;
}
.dropdown-content {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    background-color: #000000;
    width: 9em;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}
.dropdown-content a {
    text-align: left;
    color: white;
    text-decoration: none;
    padding: 15px;
    display: block;
    font-weight: bold;
}
.dropdown a:hover {
	background-color: #0699fa;
	color: #000000;
}
.show {
	display: block;
}
</style>
  
<div class="dropdown">
   
<div onclick="myFunction()" class="dropbtn">+</i>
</div>
  <div id="myDropdown" class="dropdown-content">
    <a href="https://openenergymonitor.org/"><i class="icon-globe" style="color:#FFA500"></i>&nbsp;&nbsp;Main Site</a>
    <a href="https://guide.openenergymonitor.org/"><i class="icon-bookmark"  style="color:#FFA500"></i>&nbsp;&nbsp;User Guide</a>
    <a href="https://shop.openenergymonitor.org/"><i class="icon-shopping-cart"  style="color:#FFA500"></i>&nbsp;&nbsp;Shop</a>
    <a href="https://community.openenergymonitor.org/"><i class="icon-comment" style="color:#FFA500"></i>&nbsp;&nbsp;Community</a>
    <a href="https://guide.openenergymonitor.org/technical/resources/"><i class="icon-book"  style="color:#FFA500"></i>&nbsp;&nbsp;Resources</a>
    <a href="https://twitter.com/Openenergymon/"><i class="icon-twitter"  style="color:#FFA500"></i>&nbsp;&nbsp;Twitter</a>
    <a onclick="myFunction()" style="cursor:pointer;text-align:center;background-color:#000000;">&#10006;</a>
  </div>
</div>

<script>
/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
	document.getElementById("myDropdown").classList.toggle("show");
}
// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>

<!--End of Site Nav-->

        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2016/05/emonsd-update-03may16/">Substantial update to emonPi</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/emonpi-raspberrypi3/">emonPi / emonBase Raspberry Pi 3</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/emoncms-qr/">Emoncms android App QR Code Scanner Setup</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/website-changes/">New Forum, Blog and User Guide Website</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/Part3-Aggregated-supply-and-demand/">Part 3: Aggregated supply and demand across multiple households</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Part2-Exploring-carbon-intensity/">Part 2: Exploring carbon intensity and renewable energy matching</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Understand-CO2-intensity-grid-electricity/">Part 1: Attempting to measure and understand the CO2 intensity of grid electricity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Git-Sub-Modules/">GitHub Submodules</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Home-Assistant/">Home Assistant and emonPi</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/03/raspberry-pi-3/">Raspberry Pi 3 </a>
        </li>
      
    
  </ul>
</section>
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided">
    
    
      <li><a href="/categories/air quality egg/">Air Quality Egg</a></li>
    
      <li><a href="/categories/antenna/">Antenna</a></li>
    
      <li><a href="/categories/building energy modelling/">Building Energy Modelling</a></li>
    
      <li><a href="/categories/china/">China</a></li>
    
      <li><a href="/categories/christmas/">Christmas</a></li>
    
      <li><a href="/categories/course/workshop/">Course/Workshop</a></li>
    
      <li><a href="/categories/dc/">DC</a></li>
    
      <li><a href="/categories/dc current sensing/">DC current sensing</a></li>
    
      <li><a href="/categories/esp8266/">ESP8266</a></li>
    
      <li><a href="/categories/heat pump/">Heat Pump</a></li>
    
      <li><a href="/categories/kaizen/">Kaizen</a></li>
    
      <li><a href="/categories/kicad/">KiCad</a></li>
    
      <li><a href="/categories/mqtt/">MQTT</a></li>
    
      <li><a href="/categories/nanoderf/">NanodeRF</a></li>
    
      <li><a href="/categories/nodered/">NodeRed</a></li>
    
      <li><a href="/categories/oem labs/">OEM Labs</a></li>
    
      <li><a href="/categories/okg/">OKG</a></li>
    
      <li><a href="/categories/oscilloscope/">Oscilloscope</a></li>
    
      <li><a href="/categories/rfm12/">RFM12</a></li>
    
      <li><a href="/categories/rfm69/">RFM69</a></li>
    
      <li><a href="/categories/rs485/">RS485</a></li>
    
      <li><a href="/categories/sap 2012/">SAP 2012</a></li>
    
      <li><a href="/categories/shw/">SHW</a></li>
    
      <li><a href="/categories/srf/">SRF</a></li>
    
      <li><a href="/categories/tasker/">Tasker</a></li>
    
      <li><a href="/categories/android/">android</a></li>
    
      <li><a href="/categories/app/">app</a></li>
    
      <li><a href="/categories/arduino/">arduino</a></li>
    
      <li><a href="/categories/award/">award</a></li>
    
      <li><a href="/categories/backup/">backup</a></li>
    
      <li><a href="/categories/batteries/">batteries</a></li>
    
      <li><a href="/categories/benchmarking/">benchmarking</a></li>
    
      <li><a href="/categories/build sesh/">build sesh</a></li>
    
      <li><a href="/categories/business/">business</a></li>
    
      <li><a href="/categories/ciseco/">ciseco</a></li>
    
      <li><a href="/categories/community energy/">community energy</a></li>
    
      <li><a href="/categories/community smart grid/">community smart grid</a></li>
    
      <li><a href="/categories/control/">control</a></li>
    
      <li><a href="/categories/current sensor/">current sensor</a></li>
    
      <li><a href="/categories/current transformer/">current transformer</a></li>
    
      <li><a href="/categories/dashboard/">dashboard</a></li>
    
      <li><a href="/categories/display/">display</a></li>
    
      <li><a href="/categories/diy drones/">diy drones</a></li>
    
      <li><a href="/categories/documentation/">documentation</a></li>
    
      <li><a href="/categories/efergy/">efergy</a></li>
    
      <li><a href="/categories/electronics/">electronics</a></li>
    
      <li><a href="/categories/elektrocamp/">elektrocamp</a></li>
    
      <li><a href="/categories/email notifications/">email notifications</a></li>
    
      <li><a href="/categories/embodied energy/">embodied energy</a></li>
    
      <li><a href="/categories/emonbase/">emonBase</a></li>
    
      <li><a href="/categories/emonctrl/">emonCtrl</a></li>
    
      <li><a href="/categories/emonglcd/">emonGLCD</a></li>
    
      <li><a href="/categories/emonpi/">emonPi</a></li>
    
      <li><a href="/categories/emonsd/">emonSD</a></li>
    
      <li><a href="/categories/emonth/">emonTH</a></li>
    
      <li><a href="/categories/emontx/">emonTx</a></li>
    
      <li><a href="/categories/emontx v2/">emonTx V2</a></li>
    
      <li><a href="/categories/emontxsmt/">emonTxSMT</a></li>
    
      <li><a href="/categories/emontxshield/">emonTxShield</a></li>
    
      <li><a href="/categories/emoncms/">emoncms</a></li>
    
      <li><a href="/categories/emonpi/">emonpi</a></li>
    
      <li><a href="/categories/end-to-end/">end to end</a></li>
    
      <li><a href="/categories/energy monitor/">energy monitor</a></li>
    
      <li><a href="/categories/energy monitoring/">energy monitoring</a></li>
    
      <li><a href="/categories/feed storage/">feed storage</a></li>
    
      <li><a href="/categories/forum/">forum</a></li>
    
      <li><a href="/categories/github/">github</a></li>
    
      <li><a href="/categories/graphing/">graphing</a></li>
    
      <li><a href="/categories/hackathon/">hackathon</a></li>
    
      <li><a href="/categories/hall effect/">hall effect</a></li>
    
      <li><a href="/categories/hardware/">hardware</a></li>
    
      <li><a href="/categories/heating/">heating</a></li>
    
      <li><a href="/categories/home assistant/">home Assistant</a></li>
    
      <li><a href="/categories/home camp/">home camp</a></li>
    
      <li><a href="/categories/humidity/">humidity</a></li>
    
      <li><a href="/categories/integrations/">integrations</a></li>
    
      <li><a href="/categories/interface/">interface</a></li>
    
      <li><a href="/categories/interview/">interview</a></li>
    
      <li><a href="/categories/java/">java</a></li>
    
      <li><a href="/categories/job/">job</a></li>
    
      <li><a href="/categories/kickstarter/">kickstarter</a></li>
    
      <li><a href="/categories/lightwaverf/">lightwaverf</a></li>
    
      <li><a href="/categories/linux/">linux</a></li>
    
      <li><a href="/categories/logo/">logo</a></li>
    
      <li><a href="/categories/manufacturing/">manufacturing</a></li>
    
      <li><a href="/categories/measurement/">measurement</a></li>
    
      <li><a href="/categories/media/">media</a></li>
    
      <li><a href="/categories/mobile/">mobile</a></li>
    
      <li><a href="/categories/mobile app/">mobile app</a></li>
    
      <li><a href="/categories/modbus/">modbus</a></li>
    
      <li><a href="/categories/nanode/">nanode</a></li>
    
      <li><a href="/categories/ook/">ook</a></li>
    
      <li><a href="/categories/open source/">open source</a></li>
    
      <li><a href="/categories/openhab/">openHAB</a></li>
    
      <li><a href="/categories/openenergymonitor/">openenergymonitor</a></li>
    
      <li><a href="/categories/optical pulse/">optical pulse</a></li>
    
      <li><a href="/categories/pcb/">pcb</a></li>
    
      <li><a href="/categories/pebble/">pebble</a></li>
    
      <li><a href="/categories/pluse/">pluse</a></li>
    
      <li><a href="/categories/presentation/">presentation</a></li>
    
      <li><a href="/categories/raspberry pi/">raspberry pi</a></li>
    
      <li><a href="/categories/renewable/">renewable</a></li>
    
      <li><a href="/categories/serial/">serial</a></li>
    
      <li><a href="/categories/shop/">shop</a></li>
    
      <li><a href="/categories/showcase/">showcase</a></li>
    
      <li><a href="/categories/smartwatch/">smartwatch</a></li>
    
      <li><a href="/categories/social energy monitoring/">social energy monitoring</a></li>
    
      <li><a href="/categories/solarpv/">solarPV</a></li>
    
      <li><a href="/categories/sparkfun/">sparkfun</a></li>
    
      <li><a href="/categories/sustainability/">sustainability</a></li>
    
      <li><a href="/categories/temperature/">temperature</a></li>
    
      <li><a href="/categories/three phase/">three phase</a></li>
    
      <li><a href="/categories/tutorials/">tutorials</a></li>
    
      <li><a href="/categories/upgrade/">upgrade</a></li>
    
      <li><a href="/categories/user guide/">user guide</a></li>
    
      <li><a href="/categories/utility meters/">utility meters</a></li>
    
      <li><a href="/categories/voltage sensing/">voltage sensing</a></li>
    
      <li><a href="/categories/website/">website</a></li>
    
      <li><a href="/categories/wind/">wind</a></li>
    
      <li><a href="/categories/wind turbine/">wind turbine</a></li>
    
      <li><a href="/categories/wireless/">wireless</a></li>
    
      <li><a href="/categories/workshop/">workshop</a></li>
    
  </ul>
</section>
  
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <style>


div.searchtool {
  position: relative;
  display: inline-block;
  top: -6px;
}

input[type=text] {
  border: 3px solid #0699fa;
}

fieldset {
  border: 0;
}

</style>
<div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i class="icon-github"></i></a>
  <a rel="me" href='https://blog.openenergymonitor.org/feed.xml'><i class="icon-rss"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>

<div class="searchtool">


<form action="https://encrypted.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.openenergymonitor.org" />
    <input class="search" id="search" type="text" name="q" results="0" placeholder="Search..." />
  </fieldset>
</form>


</div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>