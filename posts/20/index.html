<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://blog.openenergymonitor.org/posts/20/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="https://blog.openenergymonitor.org/posts/20/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
    
    
    
    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
	
  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    
    <span style="color:#555;font-weight:bold;font-family:Arial;font-size:20"'>
Open</span><span style="color:#0699fa;font-weight:bold;font-family:Arial;font-size:20"'>EnergyMonitor</span>

  </a>
</div>

<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="https://openenergymonitor.org">Main Site</a></li>
  <li><a href="https://guide.openenergymonitor.org">User Guide</a></li>
  <li><a href="https://emoncms.org">Emoncms</a></li>
  <li><a href="https://community.openenergymonitor.org">Community</a></li>
  <li><a href="https://shop.openenergymonitor.com    ">Shop<i class="icon icon-shopping-cart"></i></a></li>
</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

            
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/10/introducing-emontx-shield/">Introducing the emonTx Shield </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-10-23T15:53:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-10-23 15:53:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emontxshield/'>emonTxShield</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/10/introducing-emontx-shield/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <div class="separator" style="clear: both; text-align: left;">The OpenEnergyMonitor project started in 2009 playing about with an Arduino Duemilanove. Since then the project has very much built on the Arduino platform, both hardware and software.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">We love Arduino, it's fantastic how quick and easy Arduino makes it is to get started blinking an LED and or reading an analoge voltage level.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">With that in mind it's with great pride that we are launching an Arduino&nbsp;compatible&nbsp;emonTx Energy Monitoring Shield to make getting started in energy monitoring just as easy.&nbsp;</div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-vFoKHC56LHY/UIiAfgS_W1I/AAAAAAAAcqE/1ECmUyhdorg/s1600/emonTx_Shield_top3D_web.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="227" src="http://3.bp.blogspot.com/-vFoKHC56LHY/UIiAfgS_W1I/AAAAAAAAcqE/1ECmUyhdorg/s320/emonTx_Shield_top3D_web.png" width="320" /></a></div><a href="http://1.bp.blogspot.com/-fknSe6f2UFI/UIiAbsR9mmI/AAAAAAAAcp8/RSA_k_VSyN4/s1600/current100a.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="150" src="http://1.bp.blogspot.com/-fknSe6f2UFI/UIiAbsR9mmI/AAAAAAAAcp8/RSA_k_VSyN4/s200/current100a.jpg" width="200" /></a><br /><br /><div class="separator" style="clear: both;">We are very pleased that the emonTx shield is&nbsp;compatible with the new Arduino Leonardo as well as the Uno and&nbsp;Duemilanove.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The emonTx Shield has got four CT current sensor inputs, an AC voltage sample input, on-board temperature sensor and RFM12B wireless transceiver. With just a CT sensor the shield can monitor current and apparent power. With the addition of an AC-AC adapter to provide an AC voltage sample the shield can monitor real power, AC RMS voltage and power factor.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The inclusion of the RFM12B wireless transceiver enables the emonTx shield to integrate with other OpenEnergyMonitor modules such an an <a href="http://openenergymonitor.org/emon/emonglcd">emonGLCD</a> display unit an <a href="http://openenergymonitor.org/emon/emonbase">emonBase</a> web-connected base-station for logging an&nbsp;visualisation&nbsp;with <a href="http://openenergymonitor.org/emon/emoncms">emoncms</a>.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The emonTx shield is now available as a full kit (with or without the RF module) or PCB only in the <a href="http://shop.openenergymonitor.com/emontx-shield/">OpenEnergyMonitor shop</a>.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">As with all OpenEnergyMonitor hardware modules it's fully open-source, fully documented and has got plenty of Arduino example software sketches. Follow the links from the main documentation page:&nbsp;<a href="http://openenergymonitor.org/emon/emontxshield">http://openenergymonitor.org/emon/emontxshield</a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The emonTx Shield is based on the popular <a href="http://openenergymonitor.org/emon/emontx">emonTx</a>&nbsp;a low power&nbsp;stand-alone energy monitoring unit. The stand-alone&nbsp;original emonTx is better suited to long term energy monitoring installations and/or low power&nbsp;operation. The&nbsp;original&nbsp;emonTx can also be bought in kit form from the <a href="http://shop.openenergymonitor.com/emontx-v2/">OpenEnergyMonitor shop</a>.&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">If you have any questions or run into problems please post on our active <a href="http://openenergymonitor.org/emon/forum">community forums</a>.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Thank you to everyone who has helped contribute to the project.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/display-live-energy-data-on-your-desktop/">Display live emoncms energy data on your desktop </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-27T20:06:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-27 20:06:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/display-live-energy-data-on-your-desktop/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Alexander Price ‏<a href="https://twitter.com/saelaenx">@saelaenx</a>&nbsp;has documented a neat setup where he uses <a href="http://itunes.apple.com/gb/app/geektool/id456877552?mt=12">Geektool</a> on his Mac to pull his live energy data and current temperatures from emoncms. The data it's self comes from an emonTx, emonGLCD posted online with a NanodeRF.<br /><br />It would be great to have a similar&nbsp;arrangement&nbsp;for Ubuntu Linux using open-source tools, that way I can have have the same on my desktop :-)<br /><br />The same goes for an android&nbsp;widget to display my live energy data on my home screen...one for the future.<br /><br />Great work Alex, read his full blog <a href="http://saelaenx.wordpress.com/2012/09/27/geektool-setup/">here</a> and see below for a summary:<br /><br /><div style="background-color: #eeeeee; border: 1px solid #ccc; margin: 5px; padding: 10px;">Since I got a few people asking about this on twitter I decided to write a quick blog post on how I set up my current Geektool arrangement. Obviously this method only works on a mac, but I imagine a similar result could be achieved on Windows using Rainmeter.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-LBz8wu1xU_c/UGSt21tuNeI/AAAAAAAAcmA/2C_4FNrKZhw/s1600/geektool-setup.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="137" src="http://2.bp.blogspot.com/-LBz8wu1xU_c/UGSt21tuNeI/AAAAAAAAcmA/2C_4FNrKZhw/s320/geektool-setup.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">GeekTool Desktop&nbsp;Widget&nbsp;</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-xwkpZu0fSpQ/UGSt7Coz5kI/AAAAAAAAcmI/y-qT3PYUKNg/s1600/screen-shot-2012-09-27-at-13-10-36.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="223" src="http://1.bp.blogspot.com/-xwkpZu0fSpQ/UGSt7Coz5kI/AAAAAAAAcmI/y-qT3PYUKNg/s320/screen-shot-2012-09-27-at-13-10-36.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">emoncms dashboard</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-tGbk8BR3irI/UGSuF4cDKoI/AAAAAAAAcmQ/T9sRPea_nL4/s1600/img_1252.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="239" src="http://4.bp.blogspot.com/-tGbk8BR3irI/UGSuF4cDKoI/AAAAAAAAcmQ/T9sRPea_nL4/s320/img_1252.jpg" width="320" /></a></td></tr><tr><td class="tr-caption">emonGLCD with Alex's nice custom&nbsp;monospaced fonts</td></tr></tbody></table></div><br />Read his full blog post here:&nbsp;<a href="http://saelaenx.wordpress.com/2012/09/27/geektool-setup/">http://saelaenx.wordpress.com/2012/09/27/geektool-setup/</a>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/logo-ideas/">Logo Ideas </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-27T12:21:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-27 12:21:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/logo/'>logo</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/logo-ideas/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Recently our friend and freelance artist/graphic designer <a href="http://gwilnoble.com/">Gwil Noble</a> has knocked up a few logo possibilities for OpenEnergyMonitor. <br /><br />Gwil has also made some gorgeous little context icons we will be using in our new front page re-design soon.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_VI0FaO4410/UGRFhuP4NxI/AAAAAAAAclo/1HAmJxHx5iU/s1600/LogoPrototypes_web.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="160" src="http://1.bp.blogspot.com/-_VI0FaO4410/UGRFhuP4NxI/AAAAAAAAclo/1HAmJxHx5iU/s400/LogoPrototypes_web.png" width="400" /></a></div><br /><br /><br />For the main icon there are three possibilities so far, their all in prototype stage, there is a possibility that we end up using something totally different! If you have any creative ideas for 'D', 'E' or even 'F' we would love to be able to add more options to the list. <br /><br />We have setup a poll to enable you to vote on which logo you prefer:&nbsp;<a href="http://openenergymonitor.org/emon/logovote">http://openenergymonitor.org/emon/logovote</a><br /><br />Forum discussion thread here: <a href="http://openenergymonitor.org/emon/node/1093">http://openenergymonitor.org/emon/node/1093</a>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/data-portability-version-1-complete/">Data portability: Version 1 complete!</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-25T18:34:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-25 18:34:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/data-portability-version-1-complete/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Following on from the<a href="http://openenergymonitor.blogspot.co.uk/2012/09/data-portability-importing-feed-data.html"> last series of posts</a> detailing an implementation for exporting and importing data into emoncms to make it possible to move feed data between emoncms instances with ease, these features are now fully integrated in to the<a href="https://github.com/openenergymonitor/emoncms3"> latest emoncms version</a>.<br /><br />I have also created a rough initial interface for selecting the remote account to download from and for selecting the feeds to download, you can get to this page by clicking on the Sync feeds button on the feedlist page:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-amhA1bKxg0c/UGHyvmnvsvI/AAAAAAAACfU/f5llCeQkeWo/s1600/sync_01.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="252" src="http://1.bp.blogspot.com/-amhA1bKxg0c/UGHyvmnvsvI/AAAAAAAACfU/f5llCeQkeWo/s640/sync_01.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;">To select an account enter the account URL and write apikey and click ok, after a moment the feed list of the remote account will appear.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">You can then click on the feeds you wish to download. This will enter the feeds into a download queue. As detailed in the last post the download and import process is run by a&nbsp;separate&nbsp;script.&nbsp;&nbsp;The script is called import.php and can be found in the root directory of the emoncms install. You can either run this script manually or set up a cron job to run it periodically.</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-tCmNdNFJY18/UGHyusPl3GI/AAAAAAAACfM/XEli3nyrIEw/s1600/sync.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="http://3.bp.blogspot.com/-tCmNdNFJY18/UGHyusPl3GI/AAAAAAAACfM/XEli3nyrIEw/s640/sync.png" width="640" /></a></div><br />Once you start downloading feeds, if you refresh the page you will see the<i> remote ahead by</i> value decrease as data is downloaded starting with the oldest data first.&nbsp;It is also possible to sync the data again at a later data to bring the local copy up to date.<br /><br />This feature makes for a really convenient way to backup feed data, as you only need to download the latest changes rather than all the data every time.<br /><br />There are still a few things missing in the current implementation, that would be great to add:<br /><br />- The first is that histogram data is not downloaded correctly as the import and export script only works at present with one column of data.<br /><br />- It would be great to have a feature to select all the remote feeds to download, rather than having to click each one.<br /><br />- It would be nice to have the sync&nbsp;interface&nbsp;page built in javascript/jquery to have it automatically update on progress without having to refresh the page.<br /><br />But I think other than these which can be fixed and improved in time, its largely functional and good to go.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/data-portability-importing-feed-data/">Data portability: Importing feed data into emoncms</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-21T10:57:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-21 10:57:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> eight minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/data-portability-importing-feed-data/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    The<a href="http://openenergymonitor.blogspot.co.uk/2012/09/data-portability-exporting-feed-data.html"> last post</a> detailed an implementation for exporting feed data from emoncms, this post explores an implementation for importing feed data, which can be used in conjunction with the export implementation to sync or download feed data from one emoncms instance to another enabling full feed data portability.<br /><br />I started by trying to create an import script that was build into a normal page action, you would go to a page ie:<br /><br /><i>sync/feed?id=10...</i><br /><br />The problem with this is that downloading and importing a feed takes a long time and so the page will appear unresponsive for that time, the loading animation just turns and turns. <br /><br />If you mistakenly click on the refresh button, the initial process will not close and so you will start to get duplicate processes which will mess up the data and increase the server load.<br /><br />Ideally while downloading and importing the data there would be a progress bar so that you can see what's happening and any other useful feedback if things go wrong.<br /><br />To get this kind of feedback you need to be able to update the browser as the process is running.<br /><br />You also want the syncing to happen directly between servers rather than server to local computer to server as this would be faster in instances where both servers are remote and the internet access to the local computer is relatively slow, - i.e you want the import process handled in php which is server side (you could use another server side language if you wanted).<br /><br />The way to get feedback about what's happening while having the import process being handled in php is to have two separate scripts one that handles the importing and another that can be refreshed regularly serves the gui webpage.<br /><br />We can extend the idea of a separate import script to sort the problem of duplicate processes too by implementing a download and import queue.<br /><br />When a user clicks to download/sync a feed in the sync page, the action behind this enters the details of the feed to be downloaded in the queue, it can also check at this point that it does not already exist in the queue.<br /><br />We can then run the import script independently of the gui page, such as via a scheduled cron job that runs the script one a minute. We can put a check in there to ensure that only one instance of the script is running at any given time too.<br /><br />The import script then checks if there are feeds to be downloaded in the import queue, working through each queue item sequentially.<br /><br />The added advantage of the queue implementation is that we can keep the load that importing places on the server low allowing only one feed to be downloaded and imported at any given time.<br /><br />So all in all this implementation:<br /><ul><li>Enables feedback on import progress.</li><li>Ensures we don’t get duplicate feed syncing processes.</li><li>Ensures that the server load is kept under control.</li></ul><div>On to the code, here's the import script that works through the import queue and downloads and imports each item sequentially, I would be interested to hear if there are any ways the efficiency of the export and import process can be improved.</div><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #bc7a00;">&lt;?php</span><br /><br />  <span style="color: #408080; font-style: italic;">// Ensure only one instance of the script can run at any one time.</span><br />  <span style="color: #19177c;">$fp</span> <span style="color: #666666;">=</span> <span style="color: green;">fopen</span>(<span style="color: #ba2121;">"importlock"</span>, <span style="color: #ba2121;">"w"</span>);<br />  <span style="color: green; font-weight: bold;">if</span> (<span style="color: #666666;">!</span> <span style="color: green;">flock</span>(<span style="color: #19177c;">$fp</span>, LOCK_EX <span style="color: #666666;">|</span> LOCK_NB)) { <span style="color: green; font-weight: bold;">echo</span> <span style="color: #ba2121;">"Already running</span><span style="color: #bb6622; font-weight: bold;">\n</span><span style="color: #ba2121;">"</span>; <span style="color: green; font-weight: bold;">die</span>; }<br /><br />  <span style="color: #408080; font-style: italic;">// Connect to the database</span><br />  <span style="color: green;">define</span>(<span style="color: #ba2121;">'EMONCMS_EXEC'</span>, <span style="color: #666666;">1</span>);<br />  <span style="color: green; font-weight: bold;">require</span> <span style="color: #ba2121;">"Includes/process_settings.php"</span>;<br />  <span style="color: green; font-weight: bold;">require</span> <span style="color: #ba2121;">"Includes/db.php"</span>;<br />  <span style="color: green; font-weight: bold;">switch</span>(db_connect()) {<br />    <span style="color: green; font-weight: bold;">case</span> <span style="color: #666666;">0:</span> <span style="color: green; font-weight: bold;">break</span>;<br />    <span style="color: green; font-weight: bold;">case</span> <span style="color: #666666;">1:</span> <span style="color: green; font-weight: bold;">break</span>;  <br />    <span style="color: green; font-weight: bold;">case</span> <span style="color: #666666;">3:</span> show_dbsettingserror_message(); <span style="color: green; font-weight: bold;">die</span> ;<br />  }<br /><br />  <span style="color: #408080; font-style: italic;">// Fetch the import queue</span><br />  <span style="color: #19177c;">$result</span> <span style="color: #666666;">=</span> db_query(<span style="color: #ba2121;">"SELECT * FROM importqueue ORDER BY `queid` Asc"</span>);<br /><br />  <span style="color: #408080; font-style: italic;">// For each item in the queue</span><br />  <span style="color: green; font-weight: bold;">while</span>(<span style="color: #19177c;">$row</span> <span style="color: #666666;">=</span> db_fetch_array(<span style="color: #19177c;">$result</span>))<br />  {<br />    <span style="color: #19177c;">$queid</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'queid'</span>];<br />    <span style="color: #19177c;">$feedname</span> <span style="color: #666666;">=</span> <span style="color: #ba2121;">"feed_"</span><span style="color: #666666;">.</span>trim(<span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'localfeedid'</span>])<span style="color: #666666;">.</span><span style="color: #ba2121;">""</span>;<br /><br />    <span style="color: #408080; font-style: italic;">// Check if we have already downloaded part of the feed and get the last </span><br />    <span style="color: #408080; font-style: italic;">// value entered so that we dont download and insert data that has already </span><br />    <span style="color: #408080; font-style: italic;">// been inserted this makes this utility useful for syncing in general </span><br />    <span style="color: #408080; font-style: italic;">// and in particlar backup that only downloads the latest changes. </span><br />    <span style="color: #19177c;">$feed_result</span> <span style="color: #666666;">=</span> db_query(<span style="color: #ba2121;">"SELECT * FROM </span><span style="color: #bb6688; font-weight: bold;">$feedname</span><span style="color: #ba2121;"> ORDER BY time Desc LIMIT 1"</span>);<br />    <span style="color: #19177c;">$feed_row</span> <span style="color: #666666;">=</span> db_fetch_array(<span style="color: #19177c;">$feed_result</span>);<br />    <span style="color: #19177c;">$start</span> <span style="color: #666666;">=</span> <span style="color: #666666;">0</span>; <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$feed_row</span>[<span style="color: #666666;">0</span>]) <span style="color: #19177c;">$start</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$feed_row</span>[<span style="color: #666666;">0</span>];<br /><br />    <span style="color: #408080; font-style: italic;">// Open the file served from the export page on the remote server</span><br />    <span style="color: #19177c;">$url</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'baseurl'</span>]<span style="color: #666666;">.</span><span style="color: #ba2121;">'/feed/export?apikey='</span><span style="color: #666666;">.</span><span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'apikey'</span>]<span style="color: #666666;">.</span><span style="color: #ba2121;">'&amp;id='</span><br />    <span style="color: #666666;">.</span><span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'feedid'</span>]<span style="color: #666666;">.</span><span style="color: #ba2121;">'&amp;start='</span><span style="color: #666666;">.</span><span style="color: #19177c;">$start</span>;<br /><br />    <span style="color: green; font-weight: bold;">echo</span> <span style="color: #ba2121;">"Opening file </span><span style="color: #bb6688; font-weight: bold;">$url</span><span style="color: #bb6622; font-weight: bold;">\n</span><span style="color: #ba2121;">"</span>;<br />    <span style="color: #19177c;">$fh</span> <span style="color: #666666;">=</span> <span style="color: #666666;">@</span><span style="color: green;">fopen</span>( <span style="color: #19177c;">$url</span>, <span style="color: #ba2121;">'r'</span> );<br /> <br />    <span style="color: #408080; font-style: italic;">// Read through the file</span><br />    <span style="color: #19177c;">$i</span> <span style="color: #666666;">=</span> <span style="color: #666666;">0</span>;<br />    <span style="color: green; font-weight: bold;">while</span> ((<span style="color: #19177c;">$data</span> <span style="color: #666666;">=</span> <span style="color: green;">fgetcsv</span>(<span style="color: #19177c;">$fh</span>, <span style="color: #666666;">0</span>, <span style="color: #ba2121;">","</span>)) <span style="color: #666666;">!==</span> <span style="color: green; font-weight: bold;">FALSE</span>) <br />    {<br />      <span style="color: #19177c;">$feedtime</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$data</span>[<span style="color: #666666;">0</span>]; <span style="color: #19177c;">$value</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$data</span>[<span style="color: #666666;">1</span>];<br /><br />      <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$feedtime</span><span style="color: #666666;">!=</span><span style="color: #ba2121;">''</span> <span style="color: #666666;">&amp;&amp;</span> <span style="color: #19177c;">$value</span><span style="color: #666666;">!=</span><span style="color: #ba2121;">''</span>)<br />      {<br />        <span style="color: #19177c;">$i</span><span style="color: #666666;">++</span>;<br />        <span style="color: #408080; font-style: italic;">//Contruct values part of the query</span><br />        <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$i</span><span style="color: #666666;">!=1</span>) <span style="color: #19177c;">$vals</span> <span style="color: #666666;">.=</span> <span style="color: #ba2121;">','</span>;<br />        <span style="color: #19177c;">$vals</span> <span style="color: #666666;">.=</span> <span style="color: #ba2121;">"('</span><span style="color: #bb6688; font-weight: bold;">$feedtime</span><span style="color: #ba2121;">','</span><span style="color: #bb6688; font-weight: bold;">$value</span><span style="color: #ba2121;">')"</span>;<br /><br />        <span style="color: #408080; font-style: italic;">// Execute query every 400 rows (same block size as export script)</span><br />        <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$i</span><span style="color: #666666;">&gt;400</span>)<br />        {<br />          <span style="color: #19177c;">$i</span> <span style="color: #666666;">=</span> <span style="color: #666666;">0</span>;<br />          <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$vals</span>) db_query(<span style="color: #ba2121;">"INSERT INTO </span><span style="color: #bb6688; font-weight: bold;">$feedname</span><span style="color: #ba2121;"> (`time`,`data`) VALUES "</span><span style="color: #666666;">.</span><span style="color: #19177c;">$vals</span>);<br />          <span style="color: #19177c;">$vals</span> <span style="color: #666666;">=</span> <span style="color: #ba2121;">""</span>;<br />        }<br />      }<br />    }<br />    <span style="color: #408080; font-style: italic;">// If there are lines to be inserted left over insert them here at the end</span><br />    <span style="color: green; font-weight: bold;">if</span> (<span style="color: #19177c;">$vals</span>) db_query(<span style="color: #ba2121;">"INSERT INTO </span><span style="color: #bb6688; font-weight: bold;">$feedname</span><span style="color: #ba2121;"> (`time`,`data`) VALUES "</span><span style="color: #666666;">.</span><span style="color: #19177c;">$vals</span>);    <br /><br />    <span style="color: green;">fclose</span>(<span style="color: #19177c;">$fh</span>);<br /><br />    <span style="color: green; font-weight: bold;">echo</span> <span style="color: #ba2121;">"Transfer complete</span><span style="color: #bb6622; font-weight: bold;">\n</span><span style="color: #ba2121;">"</span>;<br />    <span style="color: green; font-weight: bold;">echo</span> <span style="color: #ba2121;">"Deleting item </span><span style="color: #bb6688; font-weight: bold;">$queid</span><span style="color: #ba2121;"> from queue</span><span style="color: #bb6622; font-weight: bold;">\n</span><span style="color: #ba2121;">"</span>;<br />    db_query(<span style="color: #ba2121;">"DELETE FROM importqueue WHERE queid = </span><span style="color: #bb6688; font-weight: bold;">$queid</span><span style="color: #ba2121;">"</span>);<br />  }<br /><br /><span style="color: #bc7a00;">?&gt;</span><br /></pre></div><br />In the next post I will explain the interface for generating the feed import queue.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/data-portability-exporting-feed-data/">Data portability: exporting feed data from emoncms</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-19T21:26:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-19 21:26:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/data-portability-exporting-feed-data/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Following on from the previous two posts:<br /><a href="http://openenergymonitor.blogspot.com/2012/09/making-emoncms-data-portable.html">Making emoncms data portable</a><br /><a href="http://openenergymonitor.blogspot.com/2012/09/data-portability-challenges.html">Data portability challenges</a><br /><br />Here's my initial solution for feed export code that also&nbsp;allows&nbsp;it's load on the server to be regulated.<br /><br />In trying to work this out I first tired requesting all the feed data (which could be millions of rows) in one mysql query and then writing the data to a file in one push, Testing on my laptop server installation and monitoring the load with the linux top tool the mysql query can use around 97% of the cpu for up to tens of seconds depending on the feed size. Once the query is complete the writing of the file (an apache process) then takes up another block of 97% cpu use until the file has completed downloading. Emoncms still seems fairly responsive in that time.<br /><br />My next thought was to break up that larger query into smaller blocks and introducing a delay between the reading of each block, maybe the delay could wait for other actions to finish before continuing in future versions.<br /><br />Spiting&nbsp;the query into blocks of 400 rows,&nbsp;alternately&nbsp;loading and writing to the file without a delay drops the load to around 50% for both the mysql and apache processes.<br /><br />By introducing a delay of about 80 microseconds its then possible to drop the load down to roughly 10% for the apache process and a little less for the mysql process.<br /><br />Increasing the block size or/and reducing the delay speeds the transfer rate up, reducing the block size or/and increasing the delay slows the transfer rate down.<br /><br />Any thoughts on improving this would be welcome, I will try and add it to the emoncms repo soon.<br /><br />Here's the code:<br /><br /><!-- HTML generated using hilite.me --><br /><div style="background: #f8f8f8; background: white; border-width: .1em .1em .1em .8em; border: solid gray; color: black; overflow: auto; padding: .2em .6em; width: auto;"><pre style="line-height: 125%; margin: 0;"><span style="color: #bc7a00;">&lt;?php</span><br /><span class="Apple-style-span" style="font-family: 'Times New Roman'; line-height: normal; white-space: normal;"><pre style="line-height: 16px;">  <span style="color: #408080; font-style: italic;">// Open database etc here</span></pre></span><span class="Apple-style-span" style="font-family: 'Times New Roman'; line-height: normal; white-space: normal;"><pre style="line-height: 16px;">  <span style="color: #408080; font-style: italic;">// Extend timeout limit from 30s to 2mins</span></pre></span><span class="Apple-style-span">  <span style="color: green;">set_time_limit</span> (<span style="color: #666666;">120</span>);    <span style="color: #408080; font-style: italic;">// Feed id and start time of feed to export</span>  <span style="color: #19177c;">$feedid</span> <span style="color: #666666;">=</span> <span style="color: #666666;">1</span></span>;<span class="Apple-style-span">  <span style="color: #19177c;">$start</span> <span style="color: #666666;">=</span> <span style="color: #666666;">0</span></span>;<span class="Apple-style-span">     <span style="color: #408080; font-style: italic;">// Regulate mysql and apache load.</span>  <span style="color: #19177c;">$block_size</span> <span style="color: #666666;">=</span> <span style="color: #666666;">400</span>;   <span style="color: #19177c;">$sleep</span> <span style="color: #666666;">=</span> <span style="color: #666666;">80000</span>;    <span style="color: #19177c;">$feedname</span> <span style="color: #666666;">=</span> <span style="color: #ba2121;">"feed_"</span><span style="color: #666666;">.</span>trim(<span style="color: #19177c;">$feedid</span>)<span style="color: #666666;">.</span><span style="color: #ba2121;">""</span>;   <span style="color: #19177c;">$fileName</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$feedname</span><span style="color: #666666;">.</span><span style="color: #ba2121;">'.csv'</span>;     <span style="color: #408080; font-style: italic;">// There is no need for the browser to cache the output</span>  header(<span style="color: #ba2121;">"Cache-Control: no-cache, no-store, must-revalidate"</span>);    <span style="color: #408080; font-style: italic;">// Tell the browser to handle output as a csv file to be downloaded</span>  header(<span style="color: #ba2121;">'Content-Description: File Transfer'</span>);   header(<span style="color: #ba2121;">"Content-type: text/csv"</span>);   header(<span style="color: #ba2121;">"Content-Disposition: attachment; filename=</span><span style="color: #bb6688; font-weight: bold;">{</span><span style="color: #19177c;">$fileName</span><span style="color: #bb6688; font-weight: bold;">}</span><span style="color: #ba2121;">"</span>);    header(<span style="color: #ba2121;">"Expires: 0"</span>);   header(<span style="color: #ba2121;">"Pragma: no-cache"</span>);    <span style="color: #408080; font-style: italic;">// Write to output stream</span>  <span style="color: #19177c;">$fh</span> <span style="color: #666666;">=</span> <span style="color: #666666;">@</span><span style="color: green;">fopen</span>( <span style="color: #ba2121;">'php://output'</span>, <span style="color: #ba2121;">'w'</span> );    <span style="color: #408080; font-style: italic;">// Load new feed blocks until there is no more data </span>  <span style="color: #19177c;">$moredata_available</span> <span style="color: #666666;">=</span> <span style="color: #666666;">1</span>;   <span style="color: green; font-weight: bold;">while</span> (<span style="color: #19177c;">$moredata_available</span>)   {     <span style="color: #408080; font-style: italic;">// 1) Load a block</span>    <span style="color: #19177c;">$result</span> <span style="color: #666666;">=</span> db_query(<span style="color: #ba2121;">"SELECT * FROM </span><span style="color: #bb6688; font-weight: bold;">$feedname</span><span style="color: #ba2121;"> WHERE time&gt;</span><span style="color: #bb6688; font-weight: bold;">$start</span><span style="color: #ba2121;"> &nbsp;</span></span></pre><pre style="line-height: 125%; margin: 0;"><span style="color: #ba2121;">    ORDER BY time Asc Limit </span><span style="color: #bb6688; font-weight: bold;">$block_size</span><span style="color: #ba2121;">"</span>);<br /><br />    <span style="color: #19177c;">$moredata_available</span> <span style="color: #666666;">=</span> <span style="color: #666666;">0</span>;<br />    <span style="color: green; font-weight: bold;">while</span>(<span style="color: #19177c;">$row</span> <span style="color: #666666;">=</span> db_fetch_array(<span style="color: #19177c;">$result</span>)) {<br /><br />      <span style="color: #408080; font-style: italic;">// Write block as csv to output stream</span><br />      <span style="color: green;">fputcsv</span>(<span style="color: #19177c;">$fh</span>, <span style="color: green; font-weight: bold;">array</span>(<span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'time'</span>],<span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'data'</span>]));<br /><br />      <span style="color: #408080; font-style: italic;">// Set new start time so that we read the next block along</span><br />      <span style="color: #19177c;">$start</span> <span style="color: #666666;">=</span> <span style="color: #19177c;">$row</span>[<span style="color: #ba2121;">'time'</span>];<br />      <span style="color: #19177c;">$moredata_available</span> <span style="color: #666666;">=</span> <span style="color: #666666;">1</span>;<br />    }<br />    <span style="color: #408080; font-style: italic;">// 2) Sleep for a bit</span><br />    <span style="color: green;">usleep</span>(<span style="color: #19177c;">$sleep</span>);<br />  }<br /><br />  <span style="color: green;">fclose</span>(<span style="color: #19177c;">$fh</span>);<br /></pre></div><br />In the next post I will discuss creating a script to import feed data by pointing directly at the export script on the other server, plus a background running&nbsp;daemon&nbsp;process and queueing&nbsp;mechanism&nbsp;to manage the import process.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/data-portability-challenges/">Data portability challenges</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-19T08:26:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-19 08:26:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/data-portability-challenges/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Continuing from yesterday's post on <a href="http://openenergymonitor.blogspot.co.uk/2012/09/making-emoncms-data-portable.html">making emoncms data portable</a>.<br /><br />There are some challenges with implementing data portability for energy data. 5s energy feed data can grow to be quite large, I have several feeds that are approaching 100Mb and a total account size of about 700Mb and thats only just approaching one year.<br /><br />Moving large quantities of data uses server resources including: cpu, memory and bandwidth. Emoncms.org is hosted on a <a href="http://www.bigv.io/">BigV virtual machine</a>, where you get 1GiB Ram, 25GiB Disk space, 200GiB transfer for £10 a month, which is a fantastic deal for those specs.<br /><br />As exporting or importing large feeds takes time its important that it does not hog resources on the server making the server unusable for other users, any import or export code needs to use a small percentage of the server resources and ideally the amount of resources used could be adjustable. We also need to keep an eye on the data transfer limits.<br /><br />In the next post I will post up the initial working feed export code.<br /><br /><br /><br /><br /><br />
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/making-emoncms-data-portable/">Making emoncms data portable</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-18T20:43:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-18 20:43:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/making-emoncms-data-portable/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    One of the features I've wanted in emoncms for some time is the ability to move feed data between different server's with ease.<br /><div><br /></div><div>I want to be able to log in the emoncms instance running on my local machine and go to a page where I can enter the authentication details and location of my account on a remote emoncms server such as emoncms.org at which point it would bring up a list of the feeds that are available and I could either download particular feeds or just click download all and it would automatically download the whole account.</div><div><br /></div><div>This would allow me to get at my data when I'm offline and it could serve as a personal backup of the data.&nbsp;Another need for this feature is we have an old remote emoncms instance that has some old energy data on, this feature would make it really easy to move the data to the new instance.</div><div><br /></div><div>This feature could also work in a similar way to a ubuntu one or dropbox like service, there could be an automatic syncing option.</div><div><br /></div><div>This would make the energy data very portable, data potability helps to create an open web, ensures that we can be in full control of our energy data, we can remove it from a service if we no longer want to be with a particular service, use it in other applications and for other applications that may not have been thought of in the original application design.</div><div><br /></div><div>Over the next few blog posts I'm going to try and explore how this can be implemented. I've already got some working code, but a lot of work will need to be done to make this a nice well implemented feature, so if you can help with the coding or/and provide insight into better ways of doing things, that would be most welcome.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/cleanweb-uk/">Cleanweb UK</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-18T15:37:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-18 15:37:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/presentation/'>presentation</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/cleanweb-uk/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    Last&nbsp;Thursday&nbsp;Glyn and I attended the Ignite&nbsp;<a href="http://www.cleanweb.org.uk/ignite.html">Cleanweb UK</a> event in London, an event exploring the power and potential of the web to help us solve our environmental challenges.<br /><br />The format of the talks where all 5&nbsp;minute,&nbsp;20 slides, 15 seconds per slide which was a challenge to create but makes for a really fascinating event where you here about a lot of different projects in a short space of time. Videos of all the presentations talks are up on the web here:&nbsp;<a href="http://www.cleanweb.org.uk/ignite.html">http://www.cleanweb.org.uk/ignite.html</a>.<br /><br />Here's a video of our presentation on OpenEnergyMonitor:<br /><br /><iframe allowfullscreen="allowfullscreen" frameborder="0" height="315" src="http://www.youtube.com/embed/zqKMDogFuNU" width="560"></iframe> <br /><br />The slides on their own can be viewed on slideshare:<br /><br /><iframe allowfullscreen="allowfullscreen" frameborder="0" height="356" marginheight="0" marginwidth="0" scrolling="no" src="http://www.slideshare.net/slideshow/embed_code/14308610" style="border-width: 1px 1px 0; border: 1px solid #CCC; margin-bottom: 5px;" width="427"> </iframe> <br /><div style="margin-bottom: 5px;"><strong> <a href="http://www.slideshare.net/OpenEnergyMonitor/ignite-cleanweb-openenergymonitor-presentation" target="_blank" title="Ignite CleanWeb OpenEnergyMonitor presentation">Ignite CleanWeb OpenEnergyMonitor presentation</a> </strong> from <strong><a href="http://www.slideshare.net/OpenEnergyMonitor" target="_blank">OpenEnergyMonitor</a></strong> </div><br /><br />Thanks a lot to James Smith (<a href="https://twitter.com/Floppy">@floppy)</a> for organising the event and inspiring us with the <a href="http://www.youtube.com/watch?v=j68tLsRRJ90&amp;feature=player_embedded">cleanweb uk manifesto</a> at the end.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2012/09/emontx-and-nanoderf-code-guides/">EmonTx and NanodeRF Code guides</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-09-04T15:58:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-09-04 15:58:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emonbase/'>emonBase</a></li>
      
        <li><a class='category' href='/categories/emontx/'>emonTx</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/09/emontx-and-nanoderf-code-guides/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <span class="Apple-style-span" style="background-color: white; color: #333333; font-family: Helvetica, arial, freesans, clean, sans-serif; font-size: 14px; line-height: 22px;"></span><br />These EmonTx and NanodeRF code guides go through the main components required to put a full EmonTx and NanodeRF (or ENC28J60 based OpenKontrolGateway) firmware together.<br /><div><br /></div><div>If your just starting out, you might find going through these guide examples first better than starting straight in with the fully fledged firmware examples.</div><div><br /></div><div>The examples are contained in the normal&nbsp;emonTxFirmware and&nbsp;NanodeRF&nbsp;repositories on github.<br /><div><h3>EmonTx Code guide</h3><div><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/a_SingleCT/a_SingleCT.ino">01 - Single CT</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/b_SecondCT/b_SecondCT.ino">02 - Second CT</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/c_ACVoltage/c_ACVoltage.ino">03 - AC Voltage</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/d_Temperature/d_Temperature.ino">04 - Temperature</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/e_PulseCounting/e_PulseCounting.ino">05 - Pulse Counting</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/f_ElsterMeter/f_ElsterMeter.ino">06 - Elster Meter Reader</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/g_TransmittingData/g_TransmittingData.ino">07 - Transmitting Data</a><br /><a href="https://github.com/openenergymonitor/emonTxFirmware/blob/master/Guide/h_watchdog/h_watchdog.ino">08 - Watchdog</a></div><div><br /></div><div><a href="https://github.com/openenergymonitor/emonTxFirmware">https://github.com/openenergymonitor/emonTxFirmware</a><br /><h3>NanodeRF Code guide</h3></div><div><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/a_FixedPackets/a_FixedPackets.ino">01 - Fixed Packets</a><br /><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/b_MultiNode/b_MultiNode.ino">02 - MultiNode</a><br /><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/c_BasicWebClient/c_BasicWebClient.ino">03 - Basic Web Client</a><br /><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/d_PacketBuffer/d_PacketBuffer.ino">04 - PacketBuffer</a><br /><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/e_BasicMultiNodeWebClient/e_BasicMultiNodeWebClient.ino">05 - Basic MultiNode Web Client</a><br /><a href="https://github.com/openenergymonitor/NanodeRF/blob/master/Guide/f_ReceivingReply/f_ReceivingReply.ino">06 - Receiving a Reply</a></div><div><br /></div><div><a href="https://github.com/openenergymonitor/NanodeRF">https://github.com/openenergymonitor/NanodeRF</a></div></div></div>
    
  </div>
  </article>
  <hr>
  
 
  <div class="pagination">
    
      <a class="btn pull-left" href="/posts/21">&larr; Older</a>
    

    
    <a class="btn pull-right" href="/posts/19">Newer &rarr;</a>
    
  </div>




<!--Site Nav-->


<style>
.dropbtn {
  position: fixed;
  bottom: 0;
  left: 0;
  color: #ffffff;
  background-color: #FFA500;
  cursor: pointer;
  height: 70px;
  width: 70px;
  border-top-right-radius: 10%;
  text-align: center;
  padding-top: 8px;
  font-size: 40px;
  color: #000000;
  font-weight: bold;
}
.dropdown {
    position: relative;
    z-index: 22;
}
.dropdown-content {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    background-color: #000000;
    width: 9em;
    overflow: auto;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
}
.dropdown-content a {
    text-align: left;
    color: white;
    text-decoration: none;
    padding: 15px;
    display: block;
    font-weight: bold;
}
.dropdown a:hover {
	background-color: #0699fa;
	color: #000000;
}
.show {
	display: block;
}
</style>
  
<div class="dropdown">
   
<div onclick="myFunction()" class="dropbtn">+</i>
</div>
  <div id="myDropdown" class="dropdown-content">
    <a href="https://openenergymonitor.org/"><i class="icon-globe" style="color:#FFA500"></i>&nbsp;&nbsp;Main Site</a>
    <a href="https://guide.openenergymonitor.org/"><i class="icon-bookmark"  style="color:#FFA500"></i>&nbsp;&nbsp;User Guide</a>
    <a href="https://shop.openenergymonitor.org/"><i class="icon-shopping-cart"  style="color:#FFA500"></i>&nbsp;&nbsp;Shop</a>
    <a href="https://community.openenergymonitor.org/"><i class="icon-comment" style="color:#FFA500"></i>&nbsp;&nbsp;Community</a>
    <a href="https://guide.openenergymonitor.org/technical/resources/"><i class="icon-book"  style="color:#FFA500"></i>&nbsp;&nbsp;Resources</a>
    <a href="https://twitter.com/Openenergymon/"><i class="icon-twitter"  style="color:#FFA500"></i>&nbsp;&nbsp;Twitter</a>
    <a onclick="myFunction()" style="cursor:pointer;text-align:center;background-color:#000000;">&#10006;</a>
  </div>
</div>

<script>
/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
	document.getElementById("myDropdown").classList.toggle("show");
}
// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>

<!--End of Site Nav-->

        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2016/06/emonpi-vrms-line-fault/">Electrical Supply Line Vault</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/emonsd-update-03may16/">Substantial update to emonPi</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/emonpi-raspberrypi3/">emonPi / emonBase Raspberry Pi 3</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/emoncms-qr/">Emoncms android App QR Code Scanner Setup</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/website-changes/">New Forum, Blog and User Guide Website</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/Part3-Aggregated-supply-and-demand/">Part 3: Aggregated supply and demand across multiple households</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Part2-Exploring-carbon-intensity/">Part 2: Exploring carbon intensity and renewable energy matching</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Understand-CO2-intensity-grid-electricity/">Part 1: Attempting to measure and understand the CO2 intensity of grid electricity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Git-Sub-Modules/">GitHub Submodules</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Home-Assistant/">Home Assistant and emonPi</a>
        </li>
      
    
  </ul>
</section>
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided">
    
    
      <li><a href="/categories/air quality egg/">Air Quality Egg</a></li>
    
      <li><a href="/categories/antenna/">Antenna</a></li>
    
      <li><a href="/categories/building energy modelling/">Building Energy Modelling</a></li>
    
      <li><a href="/categories/china/">China</a></li>
    
      <li><a href="/categories/christmas/">Christmas</a></li>
    
      <li><a href="/categories/course/workshop/">Course/Workshop</a></li>
    
      <li><a href="/categories/dc/">DC</a></li>
    
      <li><a href="/categories/dc current sensing/">DC current sensing</a></li>
    
      <li><a href="/categories/esp8266/">ESP8266</a></li>
    
      <li><a href="/categories/heat pump/">Heat Pump</a></li>
    
      <li><a href="/categories/kaizen/">Kaizen</a></li>
    
      <li><a href="/categories/kicad/">KiCad</a></li>
    
      <li><a href="/categories/mqtt/">MQTT</a></li>
    
      <li><a href="/categories/nanoderf/">NanodeRF</a></li>
    
      <li><a href="/categories/nodered/">NodeRed</a></li>
    
      <li><a href="/categories/oem labs/">OEM Labs</a></li>
    
      <li><a href="/categories/okg/">OKG</a></li>
    
      <li><a href="/categories/oscilloscope/">Oscilloscope</a></li>
    
      <li><a href="/categories/rfm12/">RFM12</a></li>
    
      <li><a href="/categories/rfm69/">RFM69</a></li>
    
      <li><a href="/categories/rs485/">RS485</a></li>
    
      <li><a href="/categories/sap 2012/">SAP 2012</a></li>
    
      <li><a href="/categories/shw/">SHW</a></li>
    
      <li><a href="/categories/srf/">SRF</a></li>
    
      <li><a href="/categories/tasker/">Tasker</a></li>
    
      <li><a href="/categories/android/">android</a></li>
    
      <li><a href="/categories/app/">app</a></li>
    
      <li><a href="/categories/application/">application</a></li>
    
      <li><a href="/categories/arduino/">arduino</a></li>
    
      <li><a href="/categories/award/">award</a></li>
    
      <li><a href="/categories/backup/">backup</a></li>
    
      <li><a href="/categories/batteries/">batteries</a></li>
    
      <li><a href="/categories/benchmarking/">benchmarking</a></li>
    
      <li><a href="/categories/build sesh/">build sesh</a></li>
    
      <li><a href="/categories/business/">business</a></li>
    
      <li><a href="/categories/ciseco/">ciseco</a></li>
    
      <li><a href="/categories/community energy/">community energy</a></li>
    
      <li><a href="/categories/community smart grid/">community smart grid</a></li>
    
      <li><a href="/categories/control/">control</a></li>
    
      <li><a href="/categories/current sensor/">current sensor</a></li>
    
      <li><a href="/categories/current transformer/">current transformer</a></li>
    
      <li><a href="/categories/dashboard/">dashboard</a></li>
    
      <li><a href="/categories/display/">display</a></li>
    
      <li><a href="/categories/diy drones/">diy drones</a></li>
    
      <li><a href="/categories/documentation/">documentation</a></li>
    
      <li><a href="/categories/efergy/">efergy</a></li>
    
      <li><a href="/categories/electronics/">electronics</a></li>
    
      <li><a href="/categories/elektrocamp/">elektrocamp</a></li>
    
      <li><a href="/categories/email notifications/">email notifications</a></li>
    
      <li><a href="/categories/embodied energy/">embodied energy</a></li>
    
      <li><a href="/categories/emonbase/">emonBase</a></li>
    
      <li><a href="/categories/emonctrl/">emonCtrl</a></li>
    
      <li><a href="/categories/emonglcd/">emonGLCD</a></li>
    
      <li><a href="/categories/emonpi/">emonPi</a></li>
    
      <li><a href="/categories/emonsd/">emonSD</a></li>
    
      <li><a href="/categories/emonth/">emonTH</a></li>
    
      <li><a href="/categories/emontx/">emonTx</a></li>
    
      <li><a href="/categories/emontx v2/">emonTx V2</a></li>
    
      <li><a href="/categories/emontxsmt/">emonTxSMT</a></li>
    
      <li><a href="/categories/emontxshield/">emonTxShield</a></li>
    
      <li><a href="/categories/emoncms/">emoncms</a></li>
    
      <li><a href="/categories/emonpi/">emonpi</a></li>
    
      <li><a href="/categories/end-to-end/">end to end</a></li>
    
      <li><a href="/categories/energy monitor/">energy monitor</a></li>
    
      <li><a href="/categories/energy monitoring/">energy monitoring</a></li>
    
      <li><a href="/categories/feed storage/">feed storage</a></li>
    
      <li><a href="/categories/forum/">forum</a></li>
    
      <li><a href="/categories/github/">github</a></li>
    
      <li><a href="/categories/graphing/">graphing</a></li>
    
      <li><a href="/categories/hackathon/">hackathon</a></li>
    
      <li><a href="/categories/hall effect/">hall effect</a></li>
    
      <li><a href="/categories/hardware/">hardware</a></li>
    
      <li><a href="/categories/heating/">heating</a></li>
    
      <li><a href="/categories/home assistant/">home Assistant</a></li>
    
      <li><a href="/categories/home camp/">home camp</a></li>
    
      <li><a href="/categories/humidity/">humidity</a></li>
    
      <li><a href="/categories/integrations/">integrations</a></li>
    
      <li><a href="/categories/interface/">interface</a></li>
    
      <li><a href="/categories/interview/">interview</a></li>
    
      <li><a href="/categories/java/">java</a></li>
    
      <li><a href="/categories/job/">job</a></li>
    
      <li><a href="/categories/kickstarter/">kickstarter</a></li>
    
      <li><a href="/categories/lightwaverf/">lightwaverf</a></li>
    
      <li><a href="/categories/linux/">linux</a></li>
    
      <li><a href="/categories/logo/">logo</a></li>
    
      <li><a href="/categories/manufacturing/">manufacturing</a></li>
    
      <li><a href="/categories/measurement/">measurement</a></li>
    
      <li><a href="/categories/media/">media</a></li>
    
      <li><a href="/categories/mobile/">mobile</a></li>
    
      <li><a href="/categories/mobile app/">mobile app</a></li>
    
      <li><a href="/categories/modbus/">modbus</a></li>
    
      <li><a href="/categories/nanode/">nanode</a></li>
    
      <li><a href="/categories/ook/">ook</a></li>
    
      <li><a href="/categories/open source/">open source</a></li>
    
      <li><a href="/categories/openhab/">openHAB</a></li>
    
      <li><a href="/categories/openenergymonitor/">openenergymonitor</a></li>
    
      <li><a href="/categories/optical pulse/">optical pulse</a></li>
    
      <li><a href="/categories/pcb/">pcb</a></li>
    
      <li><a href="/categories/pebble/">pebble</a></li>
    
      <li><a href="/categories/pluse/">pluse</a></li>
    
      <li><a href="/categories/presentation/">presentation</a></li>
    
      <li><a href="/categories/raspberry pi/">raspberry pi</a></li>
    
      <li><a href="/categories/renewable/">renewable</a></li>
    
      <li><a href="/categories/serial/">serial</a></li>
    
      <li><a href="/categories/shop/">shop</a></li>
    
      <li><a href="/categories/showcase/">showcase</a></li>
    
      <li><a href="/categories/smartwatch/">smartwatch</a></li>
    
      <li><a href="/categories/social energy monitoring/">social energy monitoring</a></li>
    
      <li><a href="/categories/solarpv/">solarPV</a></li>
    
      <li><a href="/categories/sparkfun/">sparkfun</a></li>
    
      <li><a href="/categories/sustainability/">sustainability</a></li>
    
      <li><a href="/categories/temperature/">temperature</a></li>
    
      <li><a href="/categories/three phase/">three phase</a></li>
    
      <li><a href="/categories/tutorials/">tutorials</a></li>
    
      <li><a href="/categories/upgrade/">upgrade</a></li>
    
      <li><a href="/categories/user guide/">user guide</a></li>
    
      <li><a href="/categories/utility meters/">utility meters</a></li>
    
      <li><a href="/categories/voltage sensing/">voltage sensing</a></li>
    
      <li><a href="/categories/vrms/">vrms</a></li>
    
      <li><a href="/categories/website/">website</a></li>
    
      <li><a href="/categories/wind/">wind</a></li>
    
      <li><a href="/categories/wind turbine/">wind turbine</a></li>
    
      <li><a href="/categories/wireless/">wireless</a></li>
    
      <li><a href="/categories/workshop/">workshop</a></li>
    
  </ul>
</section>
  
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <style>


div.searchtool {
  position: relative;
  display: inline-block;
  top: -6px;
}

input[type=text] {
  border: 3px solid #0699fa;
}

fieldset {
  border: 0;
}

</style>
<div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i class="icon-github"></i></a>
  <a rel="me" href='https://blog.openenergymonitor.org/feed.xml'><i class="icon-rss"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>

<div class="searchtool">


<form action="https://encrypted.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.openenergymonitor.org" />
    <input class="search" id="search" type="text" name="q" results="0" placeholder="Search..." />
  </fieldset>
</form>


</div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>