<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="https://blog.openenergymonitor.org/posts/18/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="https://blog.openenergymonitor.org/posts/18/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />



    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
  <link href="https://fonts.googleapis.com/css?family=Ubuntu:light,bold&amp;subset=Latin" rel="stylesheet"> <!-- Ubuntu font -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  </head>

<style>

@font-face {
  font-family: "oemFont";
  src: url(/font/Ubuntu-OEM-Light.ttf)
}

html, body {
  margin: 0; height: 100vh;
}

html {
  min-height: 100vh;
}

html, body {
  word-wrap: break-word;
  font-family: "oemFont", sans-serif;
}

a:visited, .a:hover, a:focus, a {
  color: #44b3e2;
}

.meta.clearfix {
  overflow-x: hidden;
}

.communityWrapper {
  position: relative;
  box-sizing: border-box;
  margin: 0 auto;
  width: 100%;
  height: 42px;
}

@media (min-width: 1080px) {
  .communityWrapper {
  width: 1080px;
  }
}

@media screen and (max-width: 400px) {
  .oemWrap {
  display: none;
  }
}

.fa-navicon {
  display: none;
  cursor: pointer;
  font-size: 30px;
  line-height: 42px;
  position: absolute;
  left: 0;
  color: #ffffff;
  padding-left: 12px;
  z-index: 9997;
}

@media screen and (max-width: 1079px) {
  .fa-navicon {
  display: inline-block;
  }
}

.titleHolder {
  position: relative;
  top: 0;
  width: 100%;
  height: 42px;
  background-color: #44b3e2;
  overflow: hidden;
  -webkit-box-shadow: 0 -2px 4px 2px #000;
  -moz-box-shadow: 0 -2px 4px 2px #000;
  box-shadow: 0 -2px 4px 2px #000;
}

.titleIcon {
  position: absolute;
  height: 42px;
  padding: 0 0 0 7px;
  text-align: center;
  line-height: 42px;
  color: #ffffff;
  vertical-align: top;
}

  .titleIcon i {
    vertical-align: middle;
    font-size: 32px;
    line-height: 42px;
  }

.thisTitle {
  position: absolute;
  box-sizing: border-box;
  left: 42px;
  right: 0;
  height: 42px;
  padding: 5px 0 5px 0;
  text-align: left;
  color: #ffffff;
  line-height: normal;
  vertical-align: top;
}

  .thisTitle a {
    position: absolute;
    top: 0;
    color: #ffffff;
  }

@media screen and (max-width: 1079px) {
  .titleIcon {
    left: auto;
    right: 0;
    padding: 0 7px 0 0;
  }

  .thisTitle {
    right: 42px;
    left: 0;
    text-align: right;
  }

    .thisTitle a {
      padding-right: 0;
    }
}

.thisTitle-top {
  top: 0;
  height: 60%;
  font-size: 18px;
}

.thisTitle-bottom {
  bottom: 0;
  height: 40%;
  font-size: 12px;
}

.navigation {
  position: absolute;
  display: inline-block;
  top: 0;
  right: 0;
  margin-right: 6px;
  height: 42px;
  min-width: 774px;
  overflow: visible;
  padding-right: 7px;
  z-index: 20;
  box-sizing: content-box;
}

@media screen and (min-width: 1080px) {
  .navigation {
  position: relative;
  float: right;
  display: inline-block;
  margin: 0;
  }
}

.navigation ul {
  list-style-type: none;
  float: right;
  top: 0;
  margin: 0;
  padding: 0;
  height: 100%;
  display: block;
}

.navigation ul li {
  float: left;
  background-color: #44b3e2;
}

.navigation ul li a {
  display: block;
  line-height: 42px;
  font-family: "oemFont", sans-serif;
  font-size: 16px;
  text-align: center;
  padding-left: 10px;
  padding-right: 10px;
  color: #ffffff;
}

.menuFreeze {
  height: 100%;
  overflow: hidden;
}

/* Navigation on smaller screens... */

@media screen and (max-width: 1079px) {
.navigation {
  position: fixed;
  display: none;
  top: 0;
  left: 0;
  height: 100vh;
  margin: 0;
  width: 0;
  font-size: 20px;
  background-color: #44b3e2;
  color: #ffffff;
  box-sizing: border-box;
  overflow: auto;
  min-width: 0;
  padding-right: 0;
  z-index: 99999999;
}

  .navigation ul {
    list-style-type: none;
    margin: 0;
    padding-top: 0;
  }

  .navigation ul li a {
    box-sizing: border-box;
    font-family: "oemFont", sans-serif;
    font-size: 20px;
    display: block;
    color: #ffffff;
    padding: 0 20px 0 20px;
    height: 12.5vh;
    line-height: 12.5vh;
    min-width: 180px;
    text-align: left;
  }

  .navigation ul li .fa {
    min-width: 25px;
  }
}

@media (max-width: 1079px) and (min-height: 550px) {
  .navigation ul li a {
    height: 68.75px;
    line-height: 68.75px;
  }
}

@media (max-width: 1079px) and (max-height: 200px) {
  .navigation ul li a {
    height: 25px;
    line-height: 25px;
  }
}

@media screen and (min-width: 1080px) {
  .navigation ul li:nth-child(1) {
    width: 88px;
  }
  .navigation ul li:nth-child(2) {
    width: 86px;
  }
  .navigation ul li:nth-child(3) {
    width: 92px;
  }
  .navigation ul li:nth-child(4) {
    width: 123px;
  }
  .navigation ul li:nth-child(5) {
    width: 133px;
  }
  .navigation ul li:nth-child(6) {
    width: 76px;
  }
  .navigation ul li:nth-child(7) {
    width: 80px;
  }
  .navigation ul li:nth-child(8) {
    width: 96px;
  }
}

.blackOut {
  position: fixed;
  display: none;
  top: 0;
  right: 0;
  height: 100vh;
  width: 100%;
  background-color: rgba(0,0,0,0.5);
  overflow: hidden;
  cursor: pointer;
  z-index:9998;
}

.actoemLink {
  background-color: #368fb4 !important;
}

.actoemLink a {
  color: #ffffff !important;
}

.searchBox {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  background-color: rgba(0,0,0,0.8);
  color: #fff;
  display: none;
  cursor: pointer;
  z-index: 9999999999999;
}

.searchBox form {
  margin: auto;
}

.searchBox input[type=submit] {
  cursor: pointer;
  padding: 10px;
  font-size: 20px;
  font-weight: bold;
  background-color: #44b3e2;
  color: #fff;
  border: none;
  -webkit-transition: background-color 500ms linear;
  -ms-transition: background-color 500ms linear;
  transition: background-color 500ms linear;
}

.searchBox input[type=submit]:hover {
  background-color: #77c8ea;
}

.searchBox input[type=text] {
  padding: 10px;
  font-size: 20px;
  border: none;
}

.searchText {
  width: 0;
}

.searchIcon {
  cursor: pointer;
}

.fa {
  text-shadow: 2px 2px 2px rgba(150, 150, 150, 0.5);
}

</style>

<body >




<div class="titleHolder">
  <div class="communityWrapper">
    <i class="fa fa-navicon"></i>
    <a href="/">
      <div class="titleIcon">
				<i aria-hidden="true" class="fa fa-bullhorn"></i>
			</div>
			<div class="thisTitle">
			  <div class="thisTitle-top">
        		<b>Blog</b>
				</div>
				<div class="thisTitle-bottom">
          Open<b>EnergyMonitor</b>
				</div>
			</div>
		</a>
    <div id="siteLinks" class="navigation">
      <ul>
        <li title="the homepage of OpenEnergyMonitor">
          <a href="https://openenergymonitor.org">
            <i class="fa fa-home" aria-hidden="true"></i><span class="navname">&nbsp;Home</span>
          </a>
        </li>
        <li title="a user guide for the OpenEnergyMonitor system">
          <a href="https://guide.openenergymonitor.org">
            <i class="fa fa-book" aria-hidden="true"></i><span class="navname">&nbsp;Guide</span>
          </a>
        </li>
        <li title="general information about energy monitoring, diversion and sustainability">
          <a href="https://learn.openenergymonitor.org">
            <i class="fa fa-mortar-board" aria-hidden="true"></i><span class="navname">&nbsp;Learn</span>
          </a>
        </li>
        <li title="a definitive list of resources for OpenEnergyMonitor hardware">
          <a href="https://guide.openenergymonitor.org/technical/resources/">
            <i class="fa fa-list-alt" aria-hidden="true"></i><span class="navname">&nbsp;Resources</span>
          </a>
        </li>
        <li title="the openenergymonitor forum">
          <a href="https://community.openenergymonitor.org">
            <i class="fa fa-comments" aria-hidden="true"></i><span class="navname">&nbsp;Community</span>
          </a>
        </li>
        <li title="you are here: keep up with new developments at OpenEnergyMonitor" class="actoemLink">
          <a href="https://blog.openenergymonitor.org">
            <i class="fa fa-bullhorn" aria-hidden="true"></i><span class="navname">&nbsp;Blog</span>
          </a>
        </li>
        <li title="the official OpenEnergyMonitor online store">
          <a href="https://shop.openenergymonitor.com">
            <i class="fa fa-shopping-cart" aria-hidden="true"></i><span class="navname">&nbsp;Shop</span>
          </a>
        </li>
				<li title="search for something on OpenEnergyMonitor">
					<a class="searchIcon">
					    <i aria-hidden="true" class="fa fa-search"></i><span class="navname">&nbsp;Search</span>
				  </a>
				</li>
      </ul>
    </div>
  </div>
</div>
<div class="searchBox">
  <form target="_blank" id="searchform" action="https://www.google.com/cse">
    <div>
      <input type="hidden" name="cx" value="006198118389747886812:_nmxikw563w" />
      <input type="hidden" name="ie" value="UTF-8" />
      <input type="text" class="searchText" value="" name="q" id="q" autocomplete="off" />
      <input type="submit" id="searchsubmit" name="sa" value="Search" />
    </div>
  </form>
</div>
<div class="blackOut"></div>
<div style="position:relative;width:100%;top:0;height:20px"></div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script defer src="/javascripts/octopress.js"></script>

<script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

<script>

var closeStatus = false;

function openButton() {
  $("html, body").addClass("menuFreeze");
  $(".blackOut").show();
  $(".navigation").show();
  $(".navigation").animate({ width:'180' },"0.5s");
}

$(".fa-navicon").click(function() {
  openButton();
  closeStatus = true;
});

function closeButton() {
  $("html, body").removeClass("menuFreeze");
  $(".blackOut").hide();
  $(".navigation").animate({ width:'0' },"0.5s");
}

$(".blackOut").click(function() {
  closeButton();
  closeStatus = false;
});

$(document).ready(function(){
  $("table").wrap("<div style='max-width:100%;overflow-x:auto'></div>");
});

$(window).resize(function(){
  if ($(window).width() > 1079 && closeStatus == true) {
    if (!$("html").hasClass("mobile-device")) {
      closeButton();
      closeStatus = false;
    }
  }
});

$(".searchIcon").click(function() {
   $(".searchBox").css("display","flex");
   $(".searchText").animate({width: "200px"});
   $(".searchText").focus();
   $("html, body").addClass("menuFreeze");
});
$(".searchBox").click(function() {
   $(".searchBox").css("display","none");
   $(".searchText").blur();
   $(".searchText").css("width","0");
   closeButton();
});
$(".searchBox form").click( function(event) {
   event.stopPropagation();
});

$(document).ready(function(){ //alphabetically order list
  var ls, x, switchState, z, switchMe;
  ls = document.getElementById("ub202");
  switchState = true;
  while (switchState) {
    switchState = false;
    z = ls.getElementsByTagName("LI");
    for (x = 0; x < (z.length - 1); x++) {
      switchMe = false;
      if (z[x].innerHTML.toLowerCase() > z[x + 1].innerHTML.toLowerCase()) {
        switchMe= true;
        break;
      }
    }
    if (switchMe) {
      z[x].parentNode.insertBefore(z[x + 1], z[x]);
      switchState = true;
    }
  }
});

</script>

<div class="grid-wrapper">
  <div class="grid grid-center">
    
    <div class="grid__item two-thirds lap-one-whole palm-one-whole">
    

        
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/fridge-defrosting/">Fridge Defrosting</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-18T08:33:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-18 08:33:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/energy-monitoring/'>energy monitoring</a></li>
      
        <li><a class='category' href='/categories/sustainability/'>sustainability</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/fridge-defrosting/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <i>Update 27/06/13:</i><br /><br /><i>As kindly pointed out by Jörg Becker in the comments below I mad an error with the timebase. I had assumed If I zoomed in the same amount that the time base would be the same, I had not realised that this was not actually the case. Below is an updated screen grab with the correct time period. As we can see the power in the window is pretty much the same 0.28/0.29Kwh. <b>Defrosting the fridge does not seem to have had much of a reduction effect in the power consumption, just an increased duty cycle. </b>Apologies for my original misleading post below.&nbsp;</i><br /><i><br /></i><i>Thanks again to Jörg Becker for pointing this out.&nbsp;</i><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Vik0egttfrE/Ucyk1GcjMEI/AAAAAAAAe5M/raIhQn9IDt4/s878/Selection_001.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="290" src="http://1.bp.blogspot.com/-Vik0egttfrE/Ucyk1GcjMEI/AAAAAAAAe5M/raIhQn9IDt4/s640/Selection_001.png" width="640" /></a></div><br /><br />Yesterday I defrosted my fridge, I was amazed at the effect it had on it's energy consumption and pattern.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-4F_yH3w2vFc/UcAZE8BjQ5I/AAAAAAAAe2c/w0hauc9OyMk/s1600/fridge+defrost.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="222" src="http://1.bp.blogspot.com/-4F_yH3w2vFc/UcAZE8BjQ5I/AAAAAAAAe2c/w0hauc9OyMk/s640/fridge+defrost.jpg" width="640" /></a></div><br /><strike>Energy consumption due to fridge dropped from 2.29 Kwh/d to 1.09Kwh/d, about a 50% readuction. The pattern of energy consumption changed a fair bit, now defrosted the fridge switches on for a much shorter period of time, &nbsp;obviously getting up to&nbsp;down to temperature much quicker.</strike><br /><strike><br /></strike><strike>If I keep the fridge defrosted regularly all year it should save me around £60 a year.</strike><br /><br />I am aware that my fridge is quite an old model and a new model would use less energy overall and not require defrosting. Something to thing about for the future..
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/building-energy-modelling-part-2-first/">Building Energy Modelling part 2 - First attempts and research</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-17T20:26:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-17 20:26:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/building-energy-modelling-part-2-first/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br />It was not long after reading the<a href="http://openenergymonitor.blogspot.co.uk/2013/06/building-energy-modelling-part-1-whole.html"> Whole House Book</a> that Glyn and I went to a green hackathon in London (January 2012) and I spent my time creating a small web app that implemented a really basic model that produced estimates of 20 year savings of implementing various building fabric improvement measures, its still up here:<br /><div style="margin-bottom: 0cm;"><span style="color: black;"><span style="font-family: Times New Roman;"><span style="font-size: medium;"><br /></span></span></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-VzL7G6cycIg/Ub9kqV2oNKI/AAAAAAAACrk/aloGK36hQMQ/s1600/retrofit.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="337" src="http://4.bp.blogspot.com/-VzL7G6cycIg/Ub9kqV2oNKI/AAAAAAAACrk/aloGK36hQMQ/s400/retrofit.png" width="400" /></a></div><div style="margin-bottom: 0cm;"><span style="color: black;"><span style="font-family: Times New Roman;"><span style="font-size: medium;"><br /></span></span></span></div><div style="margin-bottom: 0cm;">Try it out: <a href="http://vis.openenergymonitor.org/retrofit">http://vis.openenergymonitor.org/retrofit</a>&nbsp;</div><br />Source code:<a href="https://github.com/openenergymonitor/retrofit.git"> https://github.com/openenergymonitor/retrofit.git</a> <br /><br />I had not quite realised the importance of solar and internal gains at that point or indeed utilisation factors and heating patterns so the green hackathon retrofit calculator will only be remotely close to actual heating demand in very leaky buildings, with few windows and consistently heated to an even set temperature all year. Paul Tanner pointed out the heating pattern flaw at the time in a tweet but it wasnt until more recently that I got how significant the difference is.<br /><br />After the green hackathon retrofit calculator I tried to develop the idea of a calculator that would output a list of proposed measures, their energy savings and financial payback but had low confidence in the accuracy of its output so decided to shelve it for a while.<br /><br />At around the same time I did a little work on dynamic simulation of heat conduction through a wall that can be found here: <a href="http://vis.openenergymonitor.org/dev/heatflow01/">http://vis.openenergymonitor.org/dev/heatflow01/</a> but was also unsure of its accuracy, needing to brush up on my calculus to check precisely by computing an exact solution via the fourier method.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-VYIqFFY31h8/Ub9qUS2ebfI/AAAAAAAACr0/gP1d5D8YRZg/s1600/heatflowsim.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-VYIqFFY31h8/Ub9qUS2ebfI/AAAAAAAACr0/gP1d5D8YRZg/s400/heatflowsim.png" width="381" /></a></div><div style="margin-bottom: 0cm;"><span style="font-size: medium;"><br /></span></div>I had by now read through the<a href="http://www.bre.co.uk/sap2012/page.jsp?id=2759"> SAP worksheet</a> (The UK's standard assessment procedure for assessing the energy performance of domestic buildings) many times but thought it a little too long to embark on implementing it, although basing an energy model on a standard approach supported widely seemed like the best approach.<br /><br />Searching for open source SAP implementations I found a useful open source version of the 2009 SAP worksheet implemented as a open office spreadsheet by Wookey here:&nbsp;<a href="http://wookware.org/files/SAPWorksheet9.80.ods">http://wookware.org/files/SAPWorksheet9.80.ods</a> which if you prefer spreadsheets to code is certainly worth looking at. There was also a thread on the greenbuildingforums calling for good open source building energy modelling software with a lively debate: <a href="http://www.greenbuildingforum.co.uk/newforum/comments.php?DiscussionID=6574&amp;page=1#Item_0">http://www.greenbuildingforum.co.uk/newforum/comments.php?DiscussionID=6574&amp;page=1#Item_0</a> <br /><br />In my searching I also came across a fully dynamic open source building energy model called esp-r developed by the University of Strathclyde <a href="http://www.esru.strath.ac.uk/Programs/ESP-r.htm">http://www.esru.strath.ac.uk/Programs/ESP-r.htm</a> and created a page on how to install it on ubuntu on the openenergymonitor site which I never linked in here: <a href="http://openenergymonitor.org/emon/node/1715">http://openenergymonitor.org/emon/node/1715</a>.<br /><div><br /></div><div>I'm also more recently aware that there is another open source dynamic building energy modelling project called OpenStudio which looks like it has a nice front end, OpenStudio is a National Renewable Energy Laboratories project&nbsp;<a href="https://openstudio.nrel.gov/">https://openstudio.nrel.gov/</a>&nbsp;and has sketchup integrations, looks nice!<br /><br /><b>Next blog post:</b> <a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-carbon-coop.html">Carbon Coop and the open source SAP 2012</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/building-energy-modelling-part-1-whole/">Building Energy Modelling part 1 - The Whole House Book</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-17T16:57:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-17 16:57:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/building-energy-modelling-part-1-whole/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    In the blog post&nbsp;<a href="http://openenergymonitor.blogspot.com/2013/06/what-kind-of-information-can-we-extract.html">what kind of information can we extract from power measurements</a>&nbsp;I concluded that I needed a simple model of my electricity use in addition to the monitored data in order to ultimately get to a list of actions that I need to do to optimise my electricity use.<br /><br />The other conclusion was that to significantly reduce electricity consumption further I would need to change the heating system and to take a whole house view: improve the building fabric performance by increasing insulation levels, reducing draughts and improving solar gain in order to reduce heating demand in the first place. <br /><br />For a while now I have had a growing interest in looking at heating energy consumption and how to reduce heating energy demand through building fabric improvements in addition to electricity consumption. <br /><br />In the <a href="http://openenergymonitor.blogspot.co.uk/2012/01/community-energy-plan-maker.html">energy study of local households that we did in 2011-2012</a> heating energy came out as the largest energy user, we recorded details about house construction, levels of insulation, perceived comfort, temperature, draught levels, amount of glazing etc but didn't have the tools or knowledge to be able to give any sort of tailored advice, relate general statements that we're all familiar with like insulation can reduce energy demand by x% to a particular households situation, it wasn't in the remit of the project but we could see that that was what was needed next.<br /><br />At home it was also clear that heating was the largest user of energy and the area with the most potential to achieve significant energy savings and carbon reduction especially as electricity use is already optimised as far as possible. <br /><br />I started to read up on low energy building design to get a better understanding of the subject. I had an Aha moment when I read chapter 7 of <a href="http://www.amazon.co.uk/The-Whole-House-Book-Ecological/dp/1902175220">The Whole House Book by Pat Borer &amp; Cindy Harris</a> which outlines a really simple building energy model:<br /><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-0aw8iDJ55p4/Ub8_SIi3jQI/AAAAAAAACrU/iasN12OknXA/s1600/wholehouse.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="363" src="http://4.bp.blogspot.com/-0aw8iDJ55p4/Ub8_SIi3jQI/AAAAAAAACrU/iasN12OknXA/s640/wholehouse.jpg" width="640" /></a></div><div><br />The model starts by calculating how many Watts are lost through the building fabric per degree Kelvin (same for Celsius) temperature difference between the inside and outside temperature. This is calculated by multiplying the area of the various building elements such as walls, windows, roof and floor by their U-values. The model also takes into account the amount of heat lost via draughts (infiltration). The model then uses the concept of degree-days to calculate the annual heating demand.<br /><br />Before reading this I had thought that to get any sort of useful estimated output on effect of adding insulation to a building a full dynamic simulation would be needed. But this simple model showed that you can get some surprisingly informative estimates from some quite straightforward calculations. <br /><br />For the rest of the book Pat Borer &amp; Cindy Harris use a more detailed calculation that also takes into account solar gains, internal (casual) gains and water heating requirements. If your looking for a good book on low energy building design, self-build and energy calculations Id really recommend this book.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/carbon-coop-and-houseahedron-meetup/">Carbon Coop and Houseahedron meetup</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-14T23:24:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-14 23:24:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/sustainability/'>sustainability</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/carbon-coop-and-houseahedron-meetup/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">Just got back from a couple of days visiting the <a href="http://openenergymonitor.blogspot.co.uk/2013/05/carbon-coop.html">Carbon Coop</a> team in Manchester and <a href="https://twitter.com/Housahedron">Houseahedron</a> in Liverpool.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">On tuesday/wednesday Matt and I spent some time working on the open source SAP calculator, improving the domestic hot water section, fixing a bug where if the solar hot water section was not complete the calculations would break and another bug that kept causing us to loose data after having completed one of the most tedious data entry parts: putting in all the heat loss elements. A check was added to the server side code to ensure that the json string containing the sap data was not corrupted by a broken transmission or whatever that was causing the string to get corrupted.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><b>github:</b>&nbsp;<a href="http://github.com/emoncms/emoncms">github.com/emoncms/emoncms</a></div><div style="margin-bottom: 0cm;"><b>try it out:</b>&nbsp;<a href="http://emoncms.org/sap">emoncms.org/sap</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">We spent time entering several SAP calculations that had already been done in a Mac Numbers spreadsheet implementation of SAP developed by Charlie Baker of URBED to check that results agree, the results don't quite agree yet as there are a couple sections in this new open source SAP implementation that are not fully complete but we're almost there.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The <a href="https://twitter.com/EcoHome_Lab">EcoHome_Lab</a> event was on the Wednesday evening and James Pul, Julian Todd and John Donovan of Houseahedron came over from Liverpool and gave a demo of their work.</div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-zKhr6gTvDIM/UbuhEb3rLbI/AAAAAAAACrE/OU4swOLU5GQ/s1600/2013-06-12+19.12.00.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="225" src="http://3.bp.blogspot.com/-zKhr6gTvDIM/UbuhEb3rLbI/AAAAAAAACrE/OU4swOLU5GQ/s400/2013-06-12+19.12.00.jpg" width="400" /></a></div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">What they are working on is really impressive and it ties in really well with recent openenergymonitor developments such as the open source SAP model and the idea that quite a few people have been talking about of integrating temperature and energy sensing into a building energy model in order to cross check and reduce the number of assumptions needed.</div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">What the houseahedron guys are working on would really take this idea to another level, going beyond the 1D steady state modelling that is the SAP model, implementing a fully 3D dynamic model of heat flow in a building and then visualising it with rich 3D webgl graphics.  </div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">They want it to be possible to walk through a house and explore wall temperatures on a tablet in realtime with data coming from multiple temperature sensors placed all over the house and then be able to explore what it would look like if you added say 100mm of insulation to the walls.</div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">One of the best bits is the way they are creating the 3d model of the house using a laser scanner! which generates a point cloud from which they generate the model. The point cloud is used as a sketch on which to draw the model manually at the moment as its too difficulty a problem to generate the 3d model completely automatically but its a pretty incredible way of getting all the dimensions you need to build a 3d model of a house and it only takes 6-7 minutes. Here's a screenshot of an example point cloud of an office building they scanned:</div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-sMLYpL5pnhU/Ubug7j6Vu5I/AAAAAAAACq8/f-JD2-p1Vaw/s1600/houseahedron.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="196" src="http://1.bp.blogspot.com/-sMLYpL5pnhU/Ubug7j6Vu5I/AAAAAAAACq8/f-JD2-p1Vaw/s320/houseahedron.png" width="320" /></a></div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">The best bit is that they are planning on releasing all the software for this as open source under GPL, its all written in python + flask, javascript and webGL and they are keen to use openenergymonitor hardware for the sensing.</div><div align="LEFT" style="margin-bottom: 0cm;"><br /></div><div align="LEFT" style="margin-bottom: 0cm;">Here's their twitter and website:</div><div align="LEFT" style="margin-bottom: 0cm;"><a href="https://twitter.com/Housahedron">https://twitter.com/Housahedron</a></div><div align="LEFT" style="margin-bottom: 0cm;"><a href="http://housahedron.co.uk/">http://housahedron.co.uk/</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/getting-air-quality-egg-to-work-with/">Getting the Air Quality Egg to work with the OpenEnergyMonitor system and emoncms </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-10T21:16:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-10 21:16:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/air-quality-egg/'>Air Quality Egg</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/getting-air-quality-egg-to-work-with/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">I spent a bit of time today putting a sketch together to get the <a href="http://openenergymonitor.blogspot.co.uk/2013/02/air-quality-egg-sensor-shield.html">AirQuality Egg Shield</a> and <a href="http://openenergymonitor.blogspot.co.uk/2013/02/air-quality-egg.html">Air Quality Egg Remote node</a> to work as a standard sensor node with the OpenEnergyMonitor system, so that I could log data into emoncms to visualise changes over time and use the existing raspberrypi + rfm12pi base station setup thats already receiving data from an emontx and low power temperature nodes.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><span style="font-size: small;">I placed the shield on top of a NanodeRF as it has the RFM12 RF module but Im not actually using the Ethernet part, Im just using the nanode as an arduino with an RFM12 module to form a remote sensor node. This is the same setup as is found inside the&nbsp;</span>Air Quality Egg Remote node.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-hFLyp7hugOI/UbY_UoDQ9rI/AAAAAAAACqk/8k--rKEg83U/s1600/shield.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="357" src="http://1.bp.blogspot.com/-hFLyp7hugOI/UbY_UoDQ9rI/AAAAAAAACqk/8k--rKEg83U/s400/shield.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The sketch is adapted from the PollEggBus_EPA sketch developed by <a href="http://wickeddevice.com/">Wicked Device</a> who develop and make the Air Quality Egg and just puts the NO2, CO, temperature and humidity data in the standard data structure of a series of integer values that the emontx and other nodes use.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Download the sketch here to try it out:</div><div style="margin-bottom: 0cm;"><a href="https://github.com/openenergymonitor/Air-Quality-Egg/blob/master/libraries/EggBus/examples/PollEggBus_openenergymonitor/PollEggBus_openenergymonitor.ino">https://github.com/openenergymonitor/Air-Quality-Egg/blob/master/libraries/EggBus/examples/PollEggBus_openenergymonitor/PollEggBus_openenergymonitor.ino</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I've now been logging for about 3 hours and there's already some interesting data to look at, I got back from being out on my bike and had a shower at 20:50 you can see the RH shoot up, there also seems to be a spike in NO2 and a dip in CO not sure what that means, any ideas?</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-y5QCTJd00pI/UbY_dqJ-P8I/AAAAAAAACqs/uUOOpyo0e6U/s1600/aqe.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="330" src="http://4.bp.blogspot.com/-y5QCTJd00pI/UbY_dqJ-P8I/AAAAAAAACqs/uUOOpyo0e6U/s640/aqe.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">Check out the live dashboard here:</div><div style="margin-bottom: 0cm;"><a href="http://emoncms.org/trystan/aqe">http://emoncms.org/trystan/aqe</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Air quality is not something I know much about but after discussing it with the <a href="http://openenergymonitor.blogspot.co.uk/2013/05/carbon-coop.html">Carbon Coop</a> guys recently it sounds like a fascinating and important area to understand, Matt from Carbon Coop explained that high levels of CO2 (not monitored on the AQE shield above but something that would be great to add - but more expensive) in buildings create problems around drowsiness and ability to concentrate and so monitoring these things could be important when designing and making sure a building after having undergone retrofit work has healthy air. It would also be interesting to understand in greater detail the longer term health implications of air quality and the aspects of this that we can measure. There certainly seems to be a lot of resources on this on the Air Quality Egg wiki here which should make interesting reading: <a href="http://airqualityegg.wikispaces.com/AirQualityEgg">http://airqualityegg.wikispaces.com/AirQualityEgg</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/what-kind-of-information-can-we-extract/">What kind of information can we extract from power measurements?</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-10T11:05:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-10 11:05:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> seven minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/what-kind-of-information-can-we-extract/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">The most direct representation of power data is power over time which is what we get if we simply log the power values transmitted from a monitor.  With this we can see what our power consumption or power generation looks like throughout a day, you can see the relative magnitude of different loads, identify visually different appliances from kettle's to LED&nbsp;light bulbs.</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-pVwxv1iYDHc/UbWl2mW8CtI/AAAAAAAACp0/BowLPfaHiaI/s1600/realtimepowerdata.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="275" src="http://4.bp.blogspot.com/-pVwxv1iYDHc/UbWl2mW8CtI/AAAAAAAACp0/BowLPfaHiaI/s640/realtimepowerdata.png" width="640" /></a></td></tr><tr><td class="tr-caption">The power vs time visualisation can be found under the Vis tab in emoncms by selecting the rawdata visualisation.</td></tr></tbody></table><div style="margin-bottom: 0cm;">Its a useful visual tool and with a little extra stats overlayed on the graph such as how many kwh are  contained in the window being viewed and the average power you can start to do things like calculate roughly how much energy individual appliances use such as a fridge or a particular evenings immersion heater use.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Beyond the basic power vs time graph we can gain more information by processing the incoming power data into kwh per day data. kwh per day data can be calculated as either the average power in watts for a day x 0.024 or the sum of the time spent at different powers divided by the energy in 1 kwh. A graph of kwh per day vs time makes it easy to compare one day against another and see trends over months or years.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-dJHKrtPOmqs/UbWmDU3HFoI/AAAAAAAACp8/dNmlIyznDVE/s1600/kwhddata.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="276" src="http://3.bp.blogspot.com/-dJHKrtPOmqs/UbWmDU3HFoI/AAAAAAAACp8/dNmlIyznDVE/s640/kwhddata.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The daily visualisation can be found under the Vis tab in emoncms by selecting the bargraph visualisation.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">That's pretty good but we can extract more information from the power data if we process the power data to record the energy used at different power levels in a particular day, how much energy is used at 100W, 200W or 3000W. This is what the histogram input processor does in emoncms. The following graph shows the result of recording energy used at different power levels with a 25W resolution over 7 months from my own house. The spike at 2.5kW is an electric heater which we used a lot throughout the winter, the 3.5kW spike is the immersion heater and 0-500W is lights, laptops, hifi etc.</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-XTKqi4OoA04/UbWmPv8ozAI/AAAAAAAACqE/odjmArEnBvs/s1600/detailedhistogram.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="276" src="http://2.bp.blogspot.com/-XTKqi4OoA04/UbWmPv8ozAI/AAAAAAAACqE/odjmArEnBvs/s640/detailedhistogram.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: left;"><b>Note: </b>The histogram visualisation can be found under the Vis tab by selecting histgraph. The default histogram has smaller resolution bars at higher power levels, i need to add an option for higher detailed histogram data calculation in the input process model to make this easier to achieve. To produce the graph above I&nbsp;actual&nbsp;converted the power data feed to histogram data using a conversion module that can be found <a href="https://github.com/emoncms/feedconvert">here</a>. The code that produces the histogram as data is coming in can be found on lines 543 to 608 in the <a href="http://process_model.php/">process_model.php</a>.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">The histogram data can also be visualised within the kwh per day type graph so that we can see how a particular days energy consumption breaks down into energy used at less than say 1kw, energy used between 1 and 3 kW and 3kW up but then also easily compare one day to the next:</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-W9ab4J6RzzE/UbWmaCVzmPI/AAAAAAAACqM/Qd9blj7h1FM/s1600/colhistogram.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="248" src="http://4.bp.blogspot.com/-W9ab4J6RzzE/UbWmaCVzmPI/AAAAAAAACqM/Qd9blj7h1FM/s400/colhistogram.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">From the emoncms report module.</td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">For me, what I want to get out of monitoring my electricity consumption is to first understand how I use electricity and then work out what definite actions I can take to reduce any my electricity consumption and then be able to confirm that those actions did indeed produce the expected result. After all optimisations are done, Id like the monitor and reporting tools to help keep me informed that I am maintaining an optimum electricity use level overtime, that it does not creep up again.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To answer these questions  directly I found I needed one other thing that goes hand in hand with the monitoring and visualisations above, I needed a rough model of my electricity consumption that breaks electricity consumption down on a per appliance basis. Any actions that we take are on an per appliance basis and so we really need a per appliance level of&nbsp;specificity.&nbsp; In the absence of per appliance monitoring or working <a href="http://openenergymonitor.org/emon/buildingblocks/appliance-inference">applianceinference </a>which would be the ultimate solution, this can be done with a simple model where a list of all the appliances in a house is entered manually including how many watts they use (which the energy monitor can be used to find out) and roughly how many hours per day they are used. This produces an estimate for how much electricity is used in a day, what the baseload should be and how much energy is consumed at different powers which can then be cross checked with the actual monitored data, the model can then be adjusted until the values align.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The<a href="https://github.com/emoncms/report"> reporting module</a> in emoncms bring all this together on one page, the screen below shows the monitored data and model for the openenergymonitor lab and the small cottage next door:</div><div style="margin-bottom: 0cm;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-yHfVXBfcvWg/UbWmtMkigWI/AAAAAAAACqU/4r5H2W8V_4Y/s1600/report.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="http://2.bp.blogspot.com/-yHfVXBfcvWg/UbWmtMkigWI/AAAAAAAACqU/4r5H2W8V_4Y/s640/report.png" width="403" /></a></td></tr><tr><td class="tr-caption">You can find the reporting module in emoncms.org by clicking on Extras and then report. For local installations install the report module from github <a href="https://github.com/emoncms/report">here</a></td></tr></tbody></table><div style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">To align the model to the monitored data its a matter of aligning the model pie chart to the monitored data pie chart. In our case electricity consumption is highly variable day to day, month to month so the model can only apply to either the average of the days in the selected view or a single particular day, its informative to adjust the model for different times of the year.&nbsp;Once the model aligns well, its then possible to experiment with changing the appliances in the model and how many hours they are used for to see what effect that might have on total daily consumption.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The conclusion of our electricity consumption investigation is that we could save 5-10% by changing all CFL's to LED's and turning standby items off at the plug (especially the hifi and soldering iron station), continuing to optimise kettle use and immersion heater is also super important as leaving a 2800W kettle on for an extra minute uses as much as a 6W LED left on for 7-8 hours and so can easily remove any savings achieved by turning lights off.&nbsp;</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To significantly reduce electricity consumption further we would need to change the heating system and to take a whole house view: improve the building fabric performance by increasing insulation levels, reducing draughts and improving solar gain in order to reduce heating demand in the first place which is where recent work on temperature sensing, building energy modelling, the SAP calculator comes in but I will come back to that in further blog posts.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It would be nice to add additional tabs to the report module so that current and projected consumption levels can be easily compared, Id also like to add a feature to send a regular report email that keeps me updated on my week to week electricity consumption so that I can get at a glance information that minimises the effort I need to go to to see how I'm doing.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/emontx-shield-smt-with-new-layout-in/">Emontx Shield SMT with new layout in development</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-06T08:58:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-06 08:58:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emontxshield/'>emonTxShield</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/emontx-shield-smt-with-new-layout-in/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">Several weeks ago we got an email with a series of pictures showing the problem that the emontx shield does not stack well with many of the base boards and other shields it may be used in conjunction with.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It got me thinking about different ways the shield could be arranged that would make it stack better with a variety of different boards. The main idea I had was to move the AC-AC Adapter and CT inputs over to the other side of the PCB away from the side the Ethernet and USB sockets are usually located on most of the Arduino boards and the NanodeRF. The second idea was to mount these sockets on the underside of the PCB which allows for a really thin profile NanodeRF + EmonTx shield stack which I think is pretty neat if a little unconventional. Here's the concept drawing:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ebSgZTNiTfQ/UbBM01WOocI/AAAAAAAACpM/o9PdnM3zn_M/s1600/emontxhield_concept.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="135" src="http://1.bp.blogspot.com/-ebSgZTNiTfQ/UbBM01WOocI/AAAAAAAACpM/o9PdnM3zn_M/s400/emontxhield_concept.jpg" width="400" /></a></div><div align="CENTER" style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">As you may be aware I have not really ventured into PCB design much before (I usually work on software) but its been something I wanted to do for a while so I thought Id have a go at the emontx shield redesign as its one of the simplest layouts. With Glyn's helpful guidance I started by loading the existing&nbsp;schematic&nbsp;and board files for the through hole emontx shield in eagle, I then ripped up all the existing PCB tracks, rearranged the components in different layouts and&nbsp;switched&nbsp;the resistors and capacitors over to SMT packages. Here's a screenshot of the resultant board design:</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-XGmRf3-FXA8/UbBNCmP3KqI/AAAAAAAACpU/zM5G-Bgo7ow/s1600/board.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="305" src="http://3.bp.blogspot.com/-XGmRf3-FXA8/UbBNCmP3KqI/AAAAAAAACpU/zM5G-Bgo7ow/s400/board.png" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div style="margin-bottom: 0cm;">I spend most of my dev time writing lines of code which becomes a visual output in a second step, PCB design is a different experience as its all&nbsp;immediately&nbsp;visual, dragging and dropping pcb tracks, trying to see if this track that way or another in its place looks neater, its a nice change. If your intrigued to have a go I'd recommend installing eagle, loading up one of the board designs that are all up on solderpad and experiment with routing tracks, maybe adding/removing a temperature sensor.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The PCB's arrived on Tuesday, I built it up and have started to test it, so far everything seems to be working, energy monitoring part, RFM12, Led, DS18B20 temperature sensor, Arduino Uno, Arduino Duemilanove. Next I will test the NanodeRF and Id also like to test an Arduino official Ethernet shield.  </div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-w5udfxyOmRo/UbBNfsmIzUI/AAAAAAAACpc/Clmgc4ezTSU/s1600/emontxshieldsmt_01.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="210" src="http://1.bp.blogspot.com/-w5udfxyOmRo/UbBNfsmIzUI/AAAAAAAACpc/Clmgc4ezTSU/s400/emontxshieldsmt_01.jpg" width="400" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-4-C2YEWW5YQ/UbBNiYu1VSI/AAAAAAAACpk/bRTI26DWHhM/s1600/emontxshieldsmt_02.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="275" src="http://3.bp.blogspot.com/-4-C2YEWW5YQ/UbBNiYu1VSI/AAAAAAAACpk/bRTI26DWHhM/s400/emontxshieldsmt_02.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div align="CENTER" style="margin-bottom: 0cm;"></div><div align="CENTER" style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><b>Things to improve</b></div><div style="margin-bottom: 0cm;">There is a very slight misalignment on the ISP header that needs fixing although it still stacks together fine and Glyn pointed out that the option to choose different SS (SEL) and IRQ pins for the RFM12 could be achieved using a manual jumper rather than solderable pads. Id also like to add a terminal for the DS18B20 on the edge of the board for neater connection of temperature sensor strings.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Once these are fixed we will get a run of boards made, it will probably be another month or two at least until its in the shop as these things take time.  </div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><b>Open Hardware Schematics and Board files</b></div><div style="margin-bottom: 0cm;">All available on solderpad here:</div><div style="margin-bottom: 0cm;"><a href="http://solderpad.com/trystanlea/emontx-shield-smt/">http://solderpad.com/trystanlea/emontx-shield-smt/</a></div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/removing-redundant-datapoints-algorithm/">Removing redundant datapoints – algorithm 1</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-05T11:22:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-05 11:22:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/removing-redundant-datapoints-algorithm/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">You could probably say that the aim of an algorithm that removes redundant datapoints is to create a line plot who's standard deviation compared to the raw data line is as small as possible while minimising the number of datapoints. This is probably a good rough criteria for evaluating a prospective algorithm.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Here's one idea for an algorithm, I think it can certainly be improved upon but its a start.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">If we start with our monitor that's posting once every 10 seconds. If we note down the first datapoint received and then as subsequent datapoints come in draw a line between the first and the last datapoint.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-POXZpyzURpw/Ua8dhYHXDZI/AAAAAAAACos/u0n-xrGlb7Q/s1600/algorithm1_01.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="182" src="http://2.bp.blogspot.com/-POXZpyzURpw/Ua8dhYHXDZI/AAAAAAAACos/u0n-xrGlb7Q/s400/algorithm1_01.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;">Then lets say there is a step change, a light goes on, suddenly the line is much higher than the actual data for most datapoints:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-0uEjg3xFhN0/Ua8dpNt6r5I/AAAAAAAACo0/THdnRwLHAKE/s1600/algorithm1_02.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="185" src="http://1.bp.blogspot.com/-0uEjg3xFhN0/Ua8dpNt6r5I/AAAAAAAACo0/THdnRwLHAKE/s400/algorithm1_02.jpg" width="400" /></a></div><div style="margin-bottom: 0cm;">If we measure the standard deviation of the raw datapoints vs the line to begin with it will be small, once that step change happens it will become much larger.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">At this point we note a significant change has happened (stdev is larger than a threshold) and create a datapoint one back from the last datapoint (the bottom of the step).</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">We can then move our 'start' datapoint forward to this created datapoint and repeat the process. This should do a pretty good job of tracking the raw data.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">To test it I have created a visualisation that applies this algorithm using javascript in the browser here is the result:</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-2S_rUF2Qns8/Ua8dyeX9RtI/AAAAAAAACo8/TXvcY5KBAC4/s1600/algorithm01_3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="173" src="http://1.bp.blogspot.com/-2S_rUF2Qns8/Ua8dyeX9RtI/AAAAAAAACo8/TXvcY5KBAC4/s400/algorithm01_3.png" width="400" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It works pretty well reducing 1064 datapoints to 52, but it does look messy in places.</div><div style="margin-bottom: 0cm;">To try out the code for the above, make a backup of the script:</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><i>emoncms/Modules/vis/visualisations/rawdata.php</i> in your local emoncms installation.&nbsp;</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">and replace with this:</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><a href="https://github.com/emoncms/usefulscripts/blob/master/ideas/rawdata.php">https://github.com/emoncms/usefulscripts/blob/master/ideas/rawdata.php</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">If you can think of a good algorithm to do this, It would be great to hear about it.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/removing-redundant-datapoints-part-1/">Removing redundant datapoints - part 1</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-04T09:38:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-04 09:38:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/removing-redundant-datapoints-part-1/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <br /><div style="margin-bottom: 0cm;">As I mentioned before another idea for reducing disk use is compression by removing redundant datapoints. Describing our plot with the least possible number of datapoints. Before energy monitoring I first learnt programming writing some basic 3d games and physics simulations using OpenGL, I was always&nbsp;fascinated&nbsp;by trying to create 3d landscapes, one of the techniques used to generated large landscapes is called level-of-detail terrains where you increase the polygon count where there is lots of detail I.e a mountain ridge or reduce the polygon count where there isnt ie a flat plain. I've been wondering for a while whether a similar approach could be taken to describe timeseries data so we increase the datapoint rate where there is a big change (ie when the kettle, light, fridge goes on) so that we get that event exactly at the right point in time and reduce the rate when not much is happening.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I tried to do something along these lines a few years back where the hardware would only post to the server on a step change in the power signal, the code is still up here as part of the appliance inference work I was experimenting with: <a href="http://openenergymonitor.org/emon/buildingblocks/appliance-inference">http://openenergymonitor.org/emon/buildingblocks/appliance-inference</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The problem was that it was failing when events happened too frequently, ie a thermostat controlled cooker&nbsp;cycling&nbsp;on and off. The event detection algorithm relied upon two 5 datapoint segments next to each other, when the difference between the average of the segments where larger than a threshold an event would be registered. A 10 datapoint segment spanning ~ 100s at 10s per datapoint or 50 seconds at 5s is too large and will miss events that happen to frequently. The other problem with this approach is that it wont work for temperature data which is more a change of gradient than power data steps.  </div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Anyway with the problem of large emoncms disk space demand I have been thinking about this idea again. Could it be used to reduce disk space use significantly without loosing vital timing on events that would happen by just reducing the post interval rate. I had a good conversation with the guys at houseahedron <a href="https://twitter.com/Housahedron">https://twitter.com/Housahedron</a>who came to visit last week about this, they had been thinking along similar lines and saw parallels with an approach used in path plotting, they took a couple of example datasets back with them to see if they can find a way to parse it.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">The screenshot below shows the solar hot water pump coming on for 40 mins at the beginning of a bright sunny day. The raw data would use 720 datapoints at a 10s post interval to describe the plot. Overlayed on the raw data plot I have drawn a second line that only has datapoints where needed to keep the  standard deviation between the lines roughly within an acceptable limit, in this case 10 datapoints seems to be enough to do this. If this kind of datapoint reduction rate is typical then a 60Mb mysql table with the current emoncms implementation might only take up 0.83Mb of space per year.</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-9484HO0ijiA/Ua20PKS7ivI/AAAAAAAACoU/bEP6NlDbjnE/s1600/01.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="http://3.bp.blogspot.com/-9484HO0ijiA/Ua20PKS7ivI/AAAAAAAACoU/bEP6NlDbjnE/s640/01.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">Zooming in a bit, rather than 270 datapoints, this could be described with 8. (at this datapoint reduction rate 60Mb would compress to ~1.8Mb)</div><div style="margin-bottom: 0cm;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ezmsjqyzuzw/Ua20VzX0VGI/AAAAAAAACoc/u_HXX1dlLYU/s1600/02.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="278" src="http://2.bp.blogspot.com/-ezmsjqyzuzw/Ua20VzX0VGI/AAAAAAAACoc/u_HXX1dlLYU/s640/02.png" width="640" /></a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">In addition to reducing disk space, it may be possible to use this technique to increase the resolution of our measurement as we are oversampling in regions where there are no large changes</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">This atmel appnote describes how to use oversampling and decimation to achieve greater measurement resolution:</div><div style="margin-bottom: 0cm;"><a href="http://www.atmel.com/Images/doc8003.pdf">http://www.atmel.com/Images/doc8003.pdf</a></div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">I think there are two main development questions facing this idea:</div><ol><li><div style="margin-bottom: 0cm;">Can a good enough algorithm be  developed to compress the data while retaining the detail we want.</div></li><li><div style="margin-bottom: 0cm;">What are the implications for data  query speeds?</div></li></ol><div style="margin-bottom: 0cm;">The above said, I think <a href="http://openenergymonitor.blogspot.com/2013/06/timestore-timeseries-database.html">timestore looks like the leading solution at the moment</a> for data storage and fast query speeds. With timestore we can achieve an 80% reduction in disk space demand from <a href="http://openenergymonitor.blogspot.com/2013/05/the-current-emoncms-feed-storage.html">60Mb per 10s feed per year</a> to 12.3 Mb, this would reduce the disk space use on emoncms.org from 47GB to 9.6GB, disk space use would increase at 20GB per year (costing £96 per 20GB stored inc backup <a href="http://openenergymonitor.blogspot.com/2013/05/emoncmsorg-load-stats.html">instead of £480/year</a>) and most of its already there in terms of implementation.</div><div style="margin-bottom: 0cm;"><br /></div><div style="margin-bottom: 0cm;">It might just be interesting to explore the datapoint reduction idea in parallel to see if further disk space&nbsp;reductions&nbsp;can be achieved but without sacrificing on query speeds which is the open question. If feeds could be compressed to 1.8Mb from 60Mb emoncms.org disk use would shrink from 47GB to 1.2GB and disk space would increase at a rate of 2.6 GB a year which would make server disk space costs pretty&nbsp;negligible.</div>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/timestore-timeseries-database/">Timestore timeseries database</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-03T14:03:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-03 14:03:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/timestore-timeseries-database/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    The first and most developed solution to both the query speed problem and disk space problem is timestore.<br /><br /><a href="http://www.mike-stirling.com/redmine/projects/timestore" style="color: #3465a4;">http://www.mike-stirling.com/redmine/projects/timestore</a><br /><br />Timestore is a lightweight time-series database developed by Mike Stirling. It uses a NoSQL approach to store an arbitrary number of time points without an index.<br /><br /><b>Query speeds</b><br />Timestore is fast, here's the figures given by Mike Stirling on the documentation page:<br /><br />From the resulting data set containing 1M points spanning about 1 year on 30 second intervals:<br /><br />Retrieve 100 points from the first hour: 2.6 ms<br />Retrieve 1000 points from the first hour (duplicates inserted automatically): 6.2 ms<br />Retrieve 100 points over the entire dataset (about a year worth): 2.5 ms<br />Retrieve 1000 points over the entire dataset: 7.0 ms<br /><br /><b>Disk use</b><br /><br />Timestore uses a double as a default data type which is 8 bytes. The current emoncms mysql database stores data values as floats which take up 4 bytes, its easy to change the data type in timestore so for a fair comparison we can change the default datatype to a 4-byte float:<br /><br />Layer 1: 10s layer = 3153600 datapoints x 4 bytes = 12614400 bytes<br />Layer 2: 60 layer1 datapoints averaged = 52560 datapoints x 4 bytes = 210240 Bytes<br />Layer 3: 10 layer2 datapoints averaged = 5256 datapoints x 4 bytes = 21024 bytes<br />Layer 4: 6 layer3 datapoints averaged = 876 datapoints x 4 bytes = 7008 bytes<br />Layer 5: 6 layer4 datapoints averaged = 146 datapoints x 4 bytes = 1168 bytes<br />Layer 6: 4 layer5 datapoints averaged = 36 datapoints x 4 bytes = 288 bytes<br />Layer 7: 7 layer6 datapoints averaged = 5 datapoints x 4 bytes = 40 bytes<br /><br /><b>total size = 12854168 Bytes or 12.26Mb</b><br /><br />The current emoncms data storage implementation uses 60Mb to hold the same data as it saves both the timestamp and an associated index. Timestore therefore has the potential to reduce diskuse by 80% for realtime data feeds.<br /><br />Interestingly all the downsampled layers created by timestore only come too <b>0.23 Mb</b>. Before doing the calculation above I used to think that adding all the downsampled layers would add to the problem of disk space significantly but evidently it a very small contribution compared with the full resolution data layer.<br /><br /><b>Emoncms timestore development branch</b><br /><br />I made a start on integrating timestore in emoncms, there's still a lot to do to make it fully functional but it works as a demo for now, here's how to get it setup:<br /><br /><b>1) Download, make and start timestore</b><br /><br />$ git clone <a href="http://mikestirling.co.uk/git/timestore.git" style="color: #3465a4;">http://mikestirling.co.uk/git/timestore.git</a><br />$ cd timestore<br />$ make<br />$ cd src<br />$ sudo ./timestore -d<br /><br />Fetch the admin key<br /><br />$ cd <a href="http://www.blogger.com/var/lib/timestore" style="color: #3465a4;">/var/lib/timestore</a><br />$ nano adminkey.txt<br /><br />copy the admin key which looks something like this: POpP)@H=1[#MJYX&lt;(i{YZ.0/Ni.5,g~&lt;<br />the admin key is generated anew every time timestore is restarted.<br /><br /><b>2) Download and setup the emoncms timestore branch</b><br /><br />Download copy of the timestore development branch<br /><br />$ git clone -b timestore <a href="https://github.com/emoncms/emoncms.git" style="color: #3465a4;">https://github.com/emoncms/emoncms.git</a> timestore<br /><br />Create a mysql database for emoncms and enter database settings into settings.php.<br /><br />Add a line to settings.php with the timestore adminkey:<br />$timestore_adminkey = "POpP)@H=1[#MJYX&lt;(i{YZ.0/Ni.5,g~&lt;";<br /><br />Create a user and login<br /><br />The development branch currently only implements timestore for realtime data and the feed/data api is restricted to timestore data only which means that daily data does not work. The use of timestore for daily data needs to be implemented.<br /><br />The feed model methods implemented to use timestore so far are create, insert_data and get_data.<br /><br /><b>Try it out</b><br /><br />Navigate to the feeds tab, click on feed API helper, create a new feed by typing:<br /><a href="http://localhost/timestore/feed/create.json?name=power&amp;type=1" style="color: #3465a4;">http://localhost/timestore/feed/create.json?name=power&amp;type=1</a><br /><br />It should return {"success":true,"feedid":1}<br /><br />Navigate back to feeds, you should now see your power feed in the list.<br />Navigate again to the api helper to fetch the insert data api url<br /><br />Call the insert data api a few times over say a minute (so that we have at least 6 datapoints - one every 10 seconds).&nbsp;Vary the value to make it more interesting:<br /><a href="http://localhost/timestore/feed/insert.json?id=1&amp;value=100.0" style="color: #3465a4;">http://localhost/timestore/feed/insert.json?id=1&amp;value=100.0</a><br /><br />Select the rawdata visualisation from the vis menu<br /><a href="http://localhost/timestore/vis/rawdata&amp;feedid=1" style="color: #3465a4;">http://localhost/timestore/vis/rawdata&amp;feedid=1</a><br /><br />zoom to the last couple of minutes to see the data.<br /><br /><br />I met Mike Stirling a little over a month ago in Chester for a beer and a chat after Mike originally got in contact to let me know about timestore. We discussed data storage, secure authentication, low cost temperature sensing and <a href="http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html">openTRV</a> the project Mike is working on. I think there could be great benefit to work on making what we're developing here with openenergymonitor interoperable with what Mike and others are developing with openTRV, especially as we develop more building heating and building fabric performance monitoring tools. This could all develop into a super nice open source whole building energy (both electric and heat) monitoring and control ecosystem of hardware and software tools.<br /><br />Check out Mike's blog here:<br /><br /><a href="http://www.mike-stirling.com/">http://www.mike-stirling.com/</a><br />and&nbsp;<a href="http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html">http://www.earth.org.uk/open-source-programmable-thermostatic-radiator-valve.html</a>
    
  </div>
  </article>
  <hr>
  

  <div class="pagination">
    
      <a class="btn pull-left" href="/posts/19">&larr; Older</a>
    

    
    <a class="btn pull-right" href="/posts/17">Newer &rarr;</a>
    
  </div>


    </div>

    
    <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
      <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2018/11/demand-side-response/">OpenEnergyMonitor Demand Side Response Development</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/01/emoncms-theme/">Emoncms Blue Theme</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2018/01/emonpi-remote-access/">emonPi Remote Access with Dataplicity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/10/iotawatt/">Introducing IoTaWatt</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/08/cydynni-energylocal/">CydYnni – Energy Local, community hydro smart grid</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/08/advances-article/">Advances Wales Magazine Article</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/06/emoncms-android-app-v2/">Emoncms Android App V2</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/06/emonpi-network-setup-wizard/">emonPi Network Setup Wizard</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/05/raspberrypi-blog/">Raspberry Pi blog</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2017/05/emonpi-mqtt-googlehome/">emonPi as a Home Automation Hub</a>
        </li>
      
    
  </ul>
</section>
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided" id="ub202">
    
    
      <li>
        <a href="/categories/air-quality-egg/">air quality egg
        </a>
      </li>
    
      <li>
        <a href="/categories/antenna/">antenna
        </a>
      </li>
    
      <li>
        <a href="/categories/building-energy-modelling/">building energy modelling
        </a>
      </li>
    
      <li>
        <a href="/categories/china/">china
        </a>
      </li>
    
      <li>
        <a href="/categories/christmas/">christmas
        </a>
      </li>
    
      <li>
        <a href="/categories/dc/">dc
        </a>
      </li>
    
      <li>
        <a href="/categories/dc-current-sensing/">dc current sensing
        </a>
      </li>
    
      <li>
        <a href="/categories/esp8266/">esp8266
        </a>
      </li>
    
      <li>
        <a href="/categories/htu21d/">htu21d
        </a>
      </li>
    
      <li>
        <a href="/categories/heat-pump/">heat pump
        </a>
      </li>
    
      <li>
        <a href="/categories/kaizen/">kaizen
        </a>
      </li>
    
      <li>
        <a href="/categories/kicad/">kicad
        </a>
      </li>
    
      <li>
        <a href="/categories/mqtt/">mqtt
        </a>
      </li>
    
      <li>
        <a href="/categories/nanoderf/">nanoderf
        </a>
      </li>
    
      <li>
        <a href="/categories/nodered/">nodered
        </a>
      </li>
    
      <li>
        <a href="/categories/oem-labs/">oem labs
        </a>
      </li>
    
      <li>
        <a href="/categories/okg/">okg
        </a>
      </li>
    
      <li>
        <a href="/categories/oscilloscope/">oscilloscope
        </a>
      </li>
    
      <li>
        <a href="/categories/rfm12/">rfm12
        </a>
      </li>
    
      <li>
        <a href="/categories/rfm69/">rfm69
        </a>
      </li>
    
      <li>
        <a href="/categories/rs485/">rs485
        </a>
      </li>
    
      <li>
        <a href="/categories/sap-2012/">sap 2012
        </a>
      </li>
    
      <li>
        <a href="/categories/shw/">shw
        </a>
      </li>
    
      <li>
        <a href="/categories/srf/">srf
        </a>
      </li>
    
      <li>
        <a href="/categories/tasker/">tasker
        </a>
      </li>
    
      <li>
        <a href="/categories/android/">android
        </a>
      </li>
    
      <li>
        <a href="/categories/app/">app
        </a>
      </li>
    
      <li>
        <a href="/categories/application/">application
        </a>
      </li>
    
      <li>
        <a href="/categories/arduino/">arduino
        </a>
      </li>
    
      <li>
        <a href="/categories/award/">award
        </a>
      </li>
    
      <li>
        <a href="/categories/backup/">backup
        </a>
      </li>
    
      <li>
        <a href="/categories/batteries/">batteries
        </a>
      </li>
    
      <li>
        <a href="/categories/benchmarking/">benchmarking
        </a>
      </li>
    
      <li>
        <a href="/categories/build-sesh/">build sesh
        </a>
      </li>
    
      <li>
        <a href="/categories/business/">business
        </a>
      </li>
    
      <li>
        <a href="/categories/ciseco/">ciseco
        </a>
      </li>
    
      <li>
        <a href="/categories/community-energy/">community energy
        </a>
      </li>
    
      <li>
        <a href="/categories/community-smart-grid/">community smart grid
        </a>
      </li>
    
      <li>
        <a href="/categories/continuous-testing/">continuous testing
        </a>
      </li>
    
      <li>
        <a href="/categories/control/">control
        </a>
      </li>
    
      <li>
        <a href="/categories/current-sensor/">current sensor
        </a>
      </li>
    
      <li>
        <a href="/categories/current-transformer/">current transformer
        </a>
      </li>
    
      <li>
        <a href="/categories/dashboard/">dashboard
        </a>
      </li>
    
      <li>
        <a href="/categories/display/">display
        </a>
      </li>
    
      <li>
        <a href="/categories/diy-drones/">diy drones
        </a>
      </li>
    
      <li>
        <a href="/categories/docker/">docker
        </a>
      </li>
    
      <li>
        <a href="/categories/documentation/">documentation
        </a>
      </li>
    
      <li>
        <a href="/categories/ecohomelab/">ecohomelab
        </a>
      </li>
    
      <li>
        <a href="/categories/efergy/">efergy
        </a>
      </li>
    
      <li>
        <a href="/categories/electronics/">electronics
        </a>
      </li>
    
      <li>
        <a href="/categories/elektrocamp/">elektrocamp
        </a>
      </li>
    
      <li>
        <a href="/categories/email-notifications/">email notifications
        </a>
      </li>
    
      <li>
        <a href="/categories/embodied-energy/">embodied energy
        </a>
      </li>
    
      <li>
        <a href="/categories/emonbase/">emonbase
        </a>
      </li>
    
      <li>
        <a href="/categories/emonctrl/">emonctrl
        </a>
      </li>
    
      <li>
        <a href="/categories/emonglcd/">emonglcd
        </a>
      </li>
    
      <li>
        <a href="/categories/emonsd/">emonsd
        </a>
      </li>
    
      <li>
        <a href="/categories/emonth/">emonth
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx/">emontx
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx-v2/">emontx v2
        </a>
      </li>
    
      <li>
        <a href="/categories/emontxsmt/">emontxsmt
        </a>
      </li>
    
      <li>
        <a href="/categories/emontxshield/">emontxshield
        </a>
      </li>
    
      <li>
        <a href="/categories/emoncms/">emoncms
        </a>
      </li>
    
      <li>
        <a href="/categories/emonesp/">emonesp
        </a>
      </li>
    
      <li>
        <a href="/categories/emonpi/">emonpi
        </a>
      </li>
    
      <li>
        <a href="/categories/emontx/">emontx
        </a>
      </li>
    
      <li>
        <a href="/categories/end-to-end/">end to end
        </a>
      </li>
    
      <li>
        <a href="/categories/energy-monitor/">energy monitor
        </a>
      </li>
    
      <li>
        <a href="/categories/energy-monitoring/">energy monitoring
        </a>
      </li>
    
      <li>
        <a href="/categories/esp8266/">esp8266
        </a>
      </li>
    
      <li>
        <a href="/categories/ev/">ev
        </a>
      </li>
    
      <li>
        <a href="/categories/feed-storage/">feed storage
        </a>
      </li>
    
      <li>
        <a href="/categories/firmware/">firmware
        </a>
      </li>
    
      <li>
        <a href="/categories/forum/">forum
        </a>
      </li>
    
      <li>
        <a href="/categories/github/">github
        </a>
      </li>
    
      <li>
        <a href="/categories/graphing/">graphing
        </a>
      </li>
    
      <li>
        <a href="/categories/hackathon/">hackathon
        </a>
      </li>
    
      <li>
        <a href="/categories/hall-effect/">hall effect
        </a>
      </li>
    
      <li>
        <a href="/categories/hardware/">hardware
        </a>
      </li>
    
      <li>
        <a href="/categories/heating/">heating
        </a>
      </li>
    
      <li>
        <a href="/categories/heatpumpmonitor/">heatpumpmonitor
        </a>
      </li>
    
      <li>
        <a href="/categories/home-assistant/">home assistant
        </a>
      </li>
    
      <li>
        <a href="/categories/home-camp/">home camp
        </a>
      </li>
    
      <li>
        <a href="/categories/humidity/">humidity
        </a>
      </li>
    
      <li>
        <a href="/categories/integrations/">integrations
        </a>
      </li>
    
      <li>
        <a href="/categories/interface/">interface
        </a>
      </li>
    
      <li>
        <a href="/categories/interview/">interview
        </a>
      </li>
    
      <li>
        <a href="/categories/iotawatt/">iotawatt
        </a>
      </li>
    
      <li>
        <a href="/categories/java/">java
        </a>
      </li>
    
      <li>
        <a href="/categories/job/">job
        </a>
      </li>
    
      <li>
        <a href="/categories/kickstarter/">kickstarter
        </a>
      </li>
    
      <li>
        <a href="/categories/lightwaverf/">lightwaverf
        </a>
      </li>
    
      <li>
        <a href="/categories/linux/">linux
        </a>
      </li>
    
      <li>
        <a href="/categories/logo/">logo
        </a>
      </li>
    
      <li>
        <a href="/categories/manufacturing/">manufacturing
        </a>
      </li>
    
      <li>
        <a href="/categories/measurement/">measurement
        </a>
      </li>
    
      <li>
        <a href="/categories/media/">media
        </a>
      </li>
    
      <li>
        <a href="/categories/mobile/">mobile
        </a>
      </li>
    
      <li>
        <a href="/categories/mobile-app/">mobile app
        </a>
      </li>
    
      <li>
        <a href="/categories/modbus/">modbus
        </a>
      </li>
    
      <li>
        <a href="/categories/nanode/">nanode
        </a>
      </li>
    
      <li>
        <a href="/categories/ook/">ook
        </a>
      </li>
    
      <li>
        <a href="/categories/open-source/">open source
        </a>
      </li>
    
      <li>
        <a href="/categories/openhab/">openhab
        </a>
      </li>
    
      <li>
        <a href="/categories/openenergymonitor/">openenergymonitor
        </a>
      </li>
    
      <li>
        <a href="/categories/openevse/">openevse
        </a>
      </li>
    
      <li>
        <a href="/categories/optical-pulse/">optical pulse
        </a>
      </li>
    
      <li>
        <a href="/categories/pcb/">pcb
        </a>
      </li>
    
      <li>
        <a href="/categories/pebble/">pebble
        </a>
      </li>
    
      <li>
        <a href="/categories/placement/">placement
        </a>
      </li>
    
      <li>
        <a href="/categories/platformio/">platformio
        </a>
      </li>
    
      <li>
        <a href="/categories/pluse/">pluse
        </a>
      </li>
    
      <li>
        <a href="/categories/presentation/">presentation
        </a>
      </li>
    
      <li>
        <a href="/categories/raspberry-pi/">raspberry pi
        </a>
      </li>
    
      <li>
        <a href="/categories/raspberry-pi/">raspberry pi
        </a>
      </li>
    
      <li>
        <a href="/categories/renewable/">renewable
        </a>
      </li>
    
      <li>
        <a href="/categories/serial/">serial
        </a>
      </li>
    
      <li>
        <a href="/categories/shop/">shop
        </a>
      </li>
    
      <li>
        <a href="/categories/showcase/">showcase
        </a>
      </li>
    
      <li>
        <a href="/categories/smartwatch/">smartwatch
        </a>
      </li>
    
      <li>
        <a href="/categories/social-energy-monitoring/">social energy monitoring
        </a>
      </li>
    
      <li>
        <a href="/categories/solarpv/">solarpv
        </a>
      </li>
    
      <li>
        <a href="/categories/sparkfun/">sparkfun
        </a>
      </li>
    
      <li>
        <a href="/categories/sustainability/">sustainability
        </a>
      </li>
    
      <li>
        <a href="/categories/temperature/">temperature
        </a>
      </li>
    
      <li>
        <a href="/categories/three-phase/">three phase
        </a>
      </li>
    
      <li>
        <a href="/categories/travisci/">travisci
        </a>
      </li>
    
      <li>
        <a href="/categories/tutorials/">tutorials
        </a>
      </li>
    
      <li>
        <a href="/categories/upgrade/">upgrade
        </a>
      </li>
    
      <li>
        <a href="/categories/user-guide/">user guide
        </a>
      </li>
    
      <li>
        <a href="/categories/utility-meters/">utility meters
        </a>
      </li>
    
      <li>
        <a href="/categories/voltage-sensing/">voltage sensing
        </a>
      </li>
    
      <li>
        <a href="/categories/vrms/">vrms
        </a>
      </li>
    
      <li>
        <a href="/categories/website/">website
        </a>
      </li>
    
      <li>
        <a href="/categories/wifipixel/">wifipixel
        </a>
      </li>
    
      <li>
        <a href="/categories/wind/">wind
        </a>
      </li>
    
      <li>
        <a href="/categories/wind-turbine/">wind turbine
        </a>
      </li>
    
      <li>
        <a href="/categories/wireless/">wireless
        </a>
      </li>
    
      <li>
        <a href="/categories/workshop/">workshop
        </a>
      </li>
    
      <li>
        <a href="/categories/zerocarbonbritain/">zerocarbonbritain
        </a>
      </li>
    
  </ul>
</section>
  
</div>
    </aside>
    
  </div>
</div>

<footer>
  <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright">

  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor/guide'><i class="icon-github"></i></a>
  <a rel="me" href='https://blog.openenergymonitor.org/feed.xml'><i class="icon-rss"></i></a>

  <div class="credit" style="text-align:center;">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and <a href='https://github.com/coogie/oscailte'>Oscalite</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>
<!--
<div class="searchtool">


<form action="https://encrypted.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.openenergymonitor.org" />
    <input class="search" id="search" type="text" name="q" results="0" placeholder="Search..." />
  </fieldset>
</form>


</div> -->
</div>
    </div>
  </div>
</div>
</footer>

<!--[if lt IE 7]>
  <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
<![endif]-->

</body>
</html>
