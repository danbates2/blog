<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://blog.openenergymonitor.org/posts/34/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="http://blog.openenergymonitor.org/posts/34/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
    
    
    
    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
	
  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    <span>OpenEnergyMonitor</span>
  </a>
</div>

<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="http://openenergymonitor.org">Home</a></li>
  <li><a href="http://shop.openenergymonitor.com">Online-Store</a></li>
  <li><a href="http://guide.openenergymonitor.org">User Guide</a></li>
  <li><a href="http://emoncms.org">Emoncms</a></li>
  <li><a href="http://community.openenergymonitor.org">Forum</a></li>
</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

            
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/08/measuring-dc-electrical-energy/">Measuring DC electrical energy production from micro-renewables</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-08-14T22:45:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-08-14 22:45:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    
    
      <a class='comments'
         href="/2009/08/measuring-dc-electrical-energy/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    Just finished writing up a page about <a href="http://openenergymonitor.org/emon/node/31">measuring DC electrical energy production from micro-renewables.</a> I built is for measuring the output of the wind turbine. Seems to work quite well although I need to do a bit more work on calibration.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SoXpMmE6IvI/AAAAAAAAAZA/0MCHBzJjcjY/s1600-h/12V01.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 400px; height: 165px;" src="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SoXpMmE6IvI/AAAAAAAAAZA/0MCHBzJjcjY/s400/12V01.JPG" alt="" id="BLOGGER_PHOTO_ID_5369954533298021106" border="0" /></a><br />Here's a video of it all working, sorry about the rushed and blurry video taking...<br /><p><object height="300" width="400"><br /><param value="always" name="allowscriptaccess"><br /><param value="http://vimeo.com/moogaloop.swf?clip_id=6105016&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=1&amp;show_portrait=0&amp;color=00ADEF&amp;fullscreen=1" name="movie"><embed allowscriptaccess="always" allowfullscreen="true" type="application/x-shockwave-flash" src="http://vimeo.com/moogaloop.swf?clip_id=6105016&amp;server=vimeo.com&amp;show_title=1&amp;show_byline=1&amp;show_portrait=0&amp;color=00ADEF&amp;fullscreen=1" height="300" width="400"></embed></object></p><br /><p><a href="http://vimeo.com/6105016">Monitoring the output of the wind turbine.</a> from <a href="http://vimeo.com/user853442">Trystan Lea</a> on <a href="http://vimeo.com/">Vimeo</a>.</p>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/08/measuring-ac-mains-energy-use-non/">Measuring AC mains energy use the non-invasive current transformer method - part 2</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-08-05T13:18:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-08-05 13:18:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/arduino/'>arduino</a></li>
      
        <li><a class='category' href='/categories/current-transformer/'>current transformer</a></li>
      
        <li><a class='category' href='/categories/efergy/'>efergy</a></li>
      
    
    </ul>
  </span>
    
      <a class='comments'
         href="/2009/08/measuring-ac-mains-energy-use-non/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    Over the last few weeks I have been working on measuring AC mains energy use using the non-invasive current transformer method. I've updated the website with a page about what I've done and how it works <a href="http://openenergymonitor.org/emon/node/28">here</a> (there's still some work to be done on the page, but most of the info is there now).<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_Yqa3j9ZhET8/SnmHOcRSRAI/AAAAAAAAAY4/c_G8bq4cDtg/s1600-h/noninv01s2.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 400px; height: 194px;" src="http://3.bp.blogspot.com/_Yqa3j9ZhET8/SnmHOcRSRAI/AAAAAAAAAY4/c_G8bq4cDtg/s400/noninv01s2.JPG" alt="" id="BLOGGER_PHOTO_ID_5366469113165267970" border="0" /></a><span style="font-style: italic;">Measuring energy use in a power strip above- but is just as easy to measure whole house electrical energy use by cliping the sensor to the mains input to the house. </span>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/08/printable-one-page-project-description/">Printable one page project description</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-08-04T15:50:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-08-04 15:50:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/energy-monitor/'>energy monitor</a></li>
      
        <li><a class='category' href='/categories/open-source/'>open source</a></li>
      
    
    </ul>
  </span>
    
      <a class='comments'
         href="/2009/08/printable-one-page-project-description/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    I've put together a printable one page project description. Useful for when I need to describe to people what <span class="blsp-spelling-error" id="SPELLING_ERROR_0"><span class="blsp-spelling-error" id="SPELLING_ERROR_0">Im</span></span> working on. It can be downloaded in <span class="blsp-spelling-error" id="SPELLING_ERROR_1"><span class="blsp-spelling-error" id="SPELLING_ERROR_1">pdf</span></span> form below.<br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SnhhVWf8EGI/AAAAAAAAAYo/q80FcBk1X-8/s1600-h/oemproject.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 400px; height: 283px;" src="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SnhhVWf8EGI/AAAAAAAAAYo/q80FcBk1X-8/s400/oemproject.png" alt="" id="BLOGGER_PHOTO_ID_5366145975456632930" border="0" /></a><a href="http://openenergymonitor.org/emon/sites/default/files/OpenEnergyMonitorProject.pdf"><br /><span class="blsp-spelling-error" id="SPELLING_ERROR_2"><span class="blsp-spelling-error" id="SPELLING_ERROR_2">OpenEnergyMonitorProject</span></span>.<span class="blsp-spelling-error" id="SPELLING_ERROR_3"><span class="blsp-spelling-error" id="SPELLING_ERROR_3">pdf</span></span></a>
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/07/update-on-progress-and-revised-aim/">Update on progress and a revised aim</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-07-26T17:22:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-07-26 17:22:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/energy-monitoring/'>energy monitoring</a></li>
      
        <li><a class='category' href='/categories/open-source/'>open source</a></li>
      
        <li><a class='category' href='/categories/renewable/'>renewable</a></li>
      
        <li><a class='category' href='/categories/wind/'>wind</a></li>
      
        <li><a class='category' href='/categories/wind-turbine/'>wind turbine</a></li>
      
    
    </ul>
  </span>
    
      <a class='comments'
         href="/2009/07/update-on-progress-and-revised-aim/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    First an update on what I've been working on and where I hope to go next.<br /><br />Over the last few weeks I have been working on monitoring mains AC electricity energy use with the non invasive current transformer method rather than the invasive current sensing resistor method. In my previous post on the current transformer (CT) method I made two errors first the circuit I used was over complicated and secondly the efergy energy monitor seems to be able to estimate real power. Even though the CT method only measures current, I tried to see if it was possible to infer the voltage waveform from the current waveform producing a close estimate of the real power, It seems to have worked quite well. I will upload the details of what I have done soon.<br /><br />I have also been working on DC energy monitoring for the wind turbine. I built the circuit that I talked about in the previous post. I however managed to blow one of the amps on the LT1495 chip and there seems to be an offset on the other amp which may be due to having blown one side. Id like to find a cheaper amp to replace the LT1495, maybe sacrificing a little on accuracy.<br /><br />For the next two weeks the wind turbine is going up at two local festivals here in North Wales (Celtic camp and the National Eisteddfod). If your in the area feel free to drop by.<br /><br />After the festivals I hope to have a look at monitoring the energy captured by the hot water solar panel we have here on our house, at the moment were not sure if it is working properly, it doesn't seem to be heating much water. However its hard to tell; the controller gives the current temperatures of the tank and panel, it would be useful to have graphs of the temperatures over several days and if a flow meter is installed it is possible to measure kWh of heat captured. Hopefully with better information it would be easier to see how well the system is working. It would be great to have a bit of software that analysed the data from the system, compared it to ideal site data and then be able to tell you something like “your system is working at 80% of potential”<br /><br />All the above applications can all share the same software and similar electronics based on the Arduino. Once one is built, your have a lot of what you need for the others.<br /><br />Further along the line it could be interesting to investigate possibilities for predicting how much energy it is possible to capture from a wind turbine or a hydro turbine before it is installed at a site using an arduino connected to an anemometer for wind or a river flow meter for hydro. I have also been doing some work with Suneil on trying to characterise how well the generator we built for the wind turbine works. With some detailed data and analysis it might be possible to identify possible improvements. Both the energy prediction and generator development could again share much of the same electronics, software and knowledge required for the energy use and energy capture parts of the project. And finally I would like to look at Internet connectivity, it would be really great to be able to check up on how say the wind turbine is doing from anyware in the world.<br /><br />And so for the project to encompass all of the above:<br /><br /><span style="font-style: italic;">"This is a project to develop and build open source energy monitoring and analysis tools for energy efficiency and distributed renewable micro generation."</span><br /><br />The project is then divided into 6 areas:<br /><br /><span style="font-weight: bold;">Energy Use</span><br />Mains AC electricity and DC.<br /><br /><span style="font-weight: bold;">Energy Capture</span><br />Wind turbine, hot water solar, hydro etc.<br /><br /><span style="font-weight: bold;">Energy Prediction</span><br />Wind speeds, stream flow...<br /><br /><span style="font-weight: bold;">Energy Technology Development</span><br />Tools for the development and building stage rather than the use stage.<br /><br /><span style="font-weight: bold;">Data graphing and analysis and storage.</span><br />Using free and open source software<br /><br /><span style="font-weight: bold;">Sharing data with the world</span><br />Internet connectivity.<br /><br />Hopefully this better reflects the direction of the work and will hopefully be a more useful collection of tools for anyone interested.<br /><br />I will be updating the website soon with the recent work and to reflect the revised aim.<br /><br />Any comments on the above would be great. Thanks for reading!
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/06/software-improvement-and-examples/">Software improvement and examples</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-06-25T22:02:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-06-25 22:02:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/arduino/'>arduino</a></li>
      
        <li><a class='category' href='/categories/java/'>java</a></li>
      
        <li><a class='category' href='/categories/serial/'>serial</a></li>
      
    
    </ul>
  </span>
    
      <a class='comments'
         href="/2009/06/software-improvement-and-examples/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    I have made a start on rewriting parts of the software to make the code a bit more object orientated and easier to use. I was finding that every time I needed to adapt the software for a different use it was a bit messy.<br /><br />In the process of doing a the re-write I will be adding examples of each significant part of the whole program working independently.<br /><br />Have a look on the <a href="http://openenergymonitor.org/emon/node/3">software page</a> for part 01 - Reading data from the Arduino and conversion of the data to a useful form.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/06/start-on-dc-current-sensing/">A start on DC current sensing</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-06-22T15:08:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-06-22 15:08:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> two minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/dc/'>DC</a></li>
      
        <li><a class='category' href='/categories/dc-current-sensing/'>DC current sensing</a></li>
      
        <li><a class='category' href='/categories/energy-monitor/'>energy monitor</a></li>
      
        <li><a class='category' href='/categories/wind-turbine/'>wind turbine</a></li>
      
    
    </ul>
  </span>
    
      <a class='comments'
         href="/2009/06/start-on-dc-current-sensing/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    Now that both the <a href="http://www.wyfsd.org/cms/index.php?page=wind_turbine_workshop_2008&amp;lan=en">North Wales</a> and <a href="http://cardiffwind.blogspot.com/">Cardiff <span class="blsp-spelling-error" id="SPELLING_ERROR_0">EWB</span> wind turbines</a> have been built, it would be good to have some sort of laptop based graphical output of the power produced from the wind turbine when its taken up to a site for testing and so I have been looking at how to modify the <span class="blsp-spelling-error" id="SPELLING_ERROR_1">OpenEnergyMonitor</span> design to do that.<br /><br />The wind turbine creates 12V DC electricity. It can produce up to around 500W of power, about 40Amps.<br /><br />I have decided to go along the invasive current sensing route with a sense resistor (also known as a shunt). When dealing with such high currents the sense resistor needs to be quite beefy! Here's a picture of my test setup using a computer power supply to simulate the wind turbine and a 50W halogen as a load. The large block in the middle is the <a href="http://uk.farnell.com/jsp/search/productdetail.jsp?sku=1339340&amp;_requestid=124438">sense resistor</a>.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_Yqa3j9ZhET8/Sj-hhYQQF_I/AAAAAAAAAUw/4V1fki-YNMw/s1600-h/shunt.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 240px;" src="http://3.bp.blogspot.com/_Yqa3j9ZhET8/Sj-hhYQQF_I/AAAAAAAAAUw/4V1fki-YNMw/s320/shunt.JPG" alt="" id="BLOGGER_PHOTO_ID_5350172477157808114" border="0" /></a>I'm now on the stage of getting parts for a circuit that will allow the <span class="blsp-spelling-error" id="SPELLING_ERROR_2">Arduino</span> to read the voltage across the sense resistor.<br /><br />I came across quite a lot of good circuit examples and advice on the linear technologies website <a href="http://www.linear.com/ad/current_sense.jsp">here</a>. <span class="blsp-spelling-error" id="SPELLING_ERROR_3">Im</span> thinking of following the battery current monitor circuit which can be found in their <a href="http://www.linear.com/ad/08-dc.pdf">DC <span class="blsp-spelling-error" id="SPELLING_ERROR_4">pdf</span></a>. Here's the schematic<span style="text-decoration: underline;">:</span><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_Yqa3j9ZhET8/Sj-kUKRgE3I/AAAAAAAAAU4/xvJ4LYcy_LI/s1600-h/circuit.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 214px;" src="http://2.bp.blogspot.com/_Yqa3j9ZhET8/Sj-kUKRgE3I/AAAAAAAAAU4/xvJ4LYcy_LI/s320/circuit.png" alt="" id="BLOGGER_PHOTO_ID_5350175548601537394" border="0" /></a>It can measure both current flowing in to the battery when the wind turbine is generating and current flowing out of the battery when there are loads connected.<br /><br />I will post up the results once its built, I also need to make a load that can vary between 0 and 500W so it can be tested properly, the current plan is to make that load from a mini 12V kettle and a mixture of 50W 20W and 10W halogen bulbs all of which can be turned on and off from the <span class="blsp-spelling-error" id="SPELLING_ERROR_5">Arduino</span>. Should be fun!<br /><br />If anyone has any experience with <span class="blsp-spelling-error" id="SPELLING_ERROR_6">renewables</span> and DC current measuring circuits I would be glad of any suggestions on any of the above.
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/06/non-invasive-current-sensing-method/">Non invasive current sensing method</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-06-06T13:26:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-06-06 13:26:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> four minutes reading time</span> <br>
    
    
      <a class='comments'
         href="/2009/06/non-invasive-current-sensing-method/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    Last year I went out and bought an<a href="http://www.efergy.com/home.html"> efergy energy monitor</a> that measures whole house electricity use. It and many other such devices use a sensor called a current transformer to measure the current flowing through the live wire. You just clip it on to the live wire as it enters your house. No meddling with mains wiring required. The picture below shows the efergy sensor that I have clipped in to in this case the neutral wire (live or neutral makes no difference) entering the power strip.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_Yqa3j9ZhET8/SipxOYkLCoI/AAAAAAAAATI/yWPxxbWvGG8/s1600-h/clip.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 240px;" src="http://1.bp.blogspot.com/_Yqa3j9ZhET8/SipxOYkLCoI/AAAAAAAAATI/yWPxxbWvGG8/s320/clip.JPG" alt="" id="BLOGGER_PHOTO_ID_5344208399754791554" border="0" /></a><br />A current transformer works in a similar way to a normal transformer. The primary coil in this case is the mains wire. Opening the sensor up you can see the secondary coil wrapped around the other side of the transformer core.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SipxkOr7R5I/AAAAAAAAATQ/-QHtIUQhLgs/s1600-h/inner.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 240px;" src="http://4.bp.blogspot.com/_Yqa3j9ZhET8/SipxkOr7R5I/AAAAAAAAATQ/-QHtIUQhLgs/s320/inner.JPG" alt="" id="BLOGGER_PHOTO_ID_5344208775060080530" border="0" /></a><br />I found<a href="http://www.google.co.uk/url?sa=t&amp;source=web&amp;ct=res&amp;cd=1&amp;url=http%3A%2F%2Fwww.allegromicro.com%2Fen%2FProducts%2FDesign%2Fcurrent_sensing%2Fbsp_v1_52.pdf&amp;ei=u9EoSoPYOIfSjAeQ9IX0Cg&amp;usg=AFQjCNHmMNxg7xTviGPMqC_gITqrKytozw&amp;sig2=6WimvsLOzjxMBKurBF70lQ"> this paper</a> which is about hall sensors but there is an overview of current transformers there too. Their description of how a current transformer works:<br /><br /><span style="font-style: italic;">“The primary current (AC) will generate a magnetic field that is coupled into a secondary coil by Faraday’s Law. The magnitude of the secondary current is proportional to the number of turns in the coil, which is typically as high as >1000. The secondary current is then sensed through a sense resistor to convert the output into a voltage. ”</span><br /><br />The next step is to convert this voltage in to a form usable by the Arduino. The analog inputs on the arduino require a voltage in the range of 0 to 5V and so the voltage needs to be biased by 2.5V and should not have an amplitude of greater than +-2.5V.<br /><br />There's probably an easier and cheaper way to do this but the HCPL -7520 chip used in the <a href="http://openenergymonitor.org/emon/node/2">invasive   current sensor</a> does the job simply and is what I had on hand. The isolation provided by the chip isn't required in this case and so Vcc1 and Vcc2 can be supplied by the same source. Here's a picture of the circuit and the schematic.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_Yqa3j9ZhET8/Sipye5fYY6I/AAAAAAAAATY/31woQInKQas/s1600-h/circuit.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 240px;" src="http://4.bp.blogspot.com/_Yqa3j9ZhET8/Sipye5fYY6I/AAAAAAAAATY/31woQInKQas/s320/circuit.JPG" alt="" id="BLOGGER_PHOTO_ID_5344209782982599586" border="0" /></a><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_Yqa3j9ZhET8/SipyezON7SI/AAAAAAAAATg/BO0cqwPPW8Q/s1600-h/Non-Invasive-s.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 191px;" src="http://1.bp.blogspot.com/_Yqa3j9ZhET8/SipyezON7SI/AAAAAAAAATg/BO0cqwPPW8Q/s320/Non-Invasive-s.png" alt="" id="BLOGGER_PHOTO_ID_5344209781299997986" border="0" /></a>To find a suitable value for the sense resistor I connected up the above circuit to Arduino analog input 0 and the invasive current sensor to input 1 allowing comparison of both waveforms using a slightly modified <a href="http://openenergymonitor.org/emon/node/3">power sampler program</a>. I know that the current waveform from the invasive current sensing method is correct and so it is possible to calibrate the non invasive method by matching the both waveforms. The voltage across the sense resistor is proportional its resistance multiplied by the current flowing through it and so by trying different values for the sense resistor it is possible to match both waveforms. The closest fixed value resistor I could find that gave matching waveforms was 22Ohms. The current waveforms from both methods match quite nicely:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://4.bp.blogspot.com/_Yqa3j9ZhET8/Sipy5R9OjFI/AAAAAAAAATo/2nbnGdiHxwQ/s1600-h/match1s.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 179px;" src="http://4.bp.blogspot.com/_Yqa3j9ZhET8/Sipy5R9OjFI/AAAAAAAAATo/2nbnGdiHxwQ/s320/match1s.png" alt="" id="BLOGGER_PHOTO_ID_5344210236226833490" border="0" /></a><br />The graph show the current waveform with a laptop connected. The invasive current measurement is 0.5A rms and the non-invasive method gives 0.445A rms which is quite close, with a potentiometer with a range of about 50 Ohms the sense resistor value could be tuned and the result improved.<br /><br />So that's current done but to get a value for power we also need a voltage measurement. Unless its possible to infer the voltage waveform from the current waveform, devices like the efergy energy monitor can only be measuring current. So how do we get a power measurement? Apparent power is calculated as the rms voltage x rms current, to read more about power measurment have a look <a href="http://openenergymonitor.org/emon/theory">here</a>. The rms voltage is nearly always in the uk 230V however the rms current varies as the load is changed. The current transformer method can measure rms current and so we can calculate a value for apparent power with this method.<br /><br />My efergy energy monitor however has stopped working (maybe after I tried to work out how it worked by taking it apart) and so I cant compare the results. If I get it to work again, I will post up the results. However the results do agree with the invasive current sensing method and so should be good :)
    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2009/06/welcome/">Welcome!</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2009-06-01T21:43:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2009-06-01 21:43:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> Less than one minute reading time</span> <br>
    
    
      <a class='comments'
         href="/2009/06/welcome/#disqus_thread"
         >Comments</a>
  </div>
  
</header>


  <div class="entry-content clearfix">
    Hello and welcome to the <span class="blsp-spelling-error" id="SPELLING_ERROR_0">OpenEnergyMonitor</span> project blog. The <span class="blsp-spelling-error" id="SPELLING_ERROR_1">OpenEnergyMonitor</span> project is a project to develop and build a <a href="http://www.fsf.org/">free</a> and open source energy monitor. Have a look at the main project site <a href="http://openenergymonitor.org">here.</a><br /><br />This blog will be used to document progress, share and discuss ideas.
    
  </div>
  </article>
  <hr>
  
 
  <div class="pagination">
    

    
    <a class="btn pull-right" href="/posts/33">Newer &rarr;</a>
    
  </div>


        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

  
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided">
    
    
      <li><a href="/categories/3phases/">3phases</a></li>
    
      <li><a href="/categories/air quality egg/">Air Quality Egg</a></li>
    
      <li><a href="/categories/android/">Android</a></li>
    
      <li><a href="/categories/antenna/">Antenna</a></li>
    
      <li><a href="/categories/building energy modelling/">Building Energy Modelling</a></li>
    
      <li><a href="/categories/china/">China</a></li>
    
      <li><a href="/categories/christmas/">Christmas</a></li>
    
      <li><a href="/categories/course/workshop/">Course/Workshop</a></li>
    
      <li><a href="/categories/dc/">DC</a></li>
    
      <li><a href="/categories/dc current sensing/">DC current sensing</a></li>
    
      <li><a href="/categories/esp8266/">ESP8266</a></li>
    
      <li><a href="/categories/heat pump/">Heat Pump</a></li>
    
      <li><a href="/categories/kaizen/">Kaizen</a></li>
    
      <li><a href="/categories/kicad/">KiCad</a></li>
    
      <li><a href="/categories/mqtt/">MQTT</a></li>
    
      <li><a href="/categories/nanoderf/">NanodeRF</a></li>
    
      <li><a href="/categories/nodered/">NodeRed</a></li>
    
      <li><a href="/categories/oem labs/">OEM Labs</a></li>
    
      <li><a href="/categories/okg/">OKG</a></li>
    
      <li><a href="/categories/oscilloscope/">Oscilloscope</a></li>
    
      <li><a href="/categories/rfm12/">RFM12</a></li>
    
      <li><a href="/categories/rfm69/">RFM69</a></li>
    
      <li><a href="/categories/rs485/">RS485</a></li>
    
      <li><a href="/categories/sap 2012/">SAP 2012</a></li>
    
      <li><a href="/categories/shw/">SHW</a></li>
    
      <li><a href="/categories/srf/">SRF</a></li>
    
      <li><a href="/categories/tasker/">Tasker</a></li>
    
      <li><a href="/categories/test/">Test</a></li>
    
      <li><a href="/categories/ad/">ad</a></li>
    
      <li><a href="/categories/app/">app</a></li>
    
      <li><a href="/categories/arduino/">arduino</a></li>
    
      <li><a href="/categories/award/">award</a></li>
    
      <li><a href="/categories/backup/">backup</a></li>
    
      <li><a href="/categories/batteries/">batteries</a></li>
    
      <li><a href="/categories/benchmarking/">benchmarking</a></li>
    
      <li><a href="/categories/build sesh/">build sesh</a></li>
    
      <li><a href="/categories/business/">business</a></li>
    
      <li><a href="/categories/ciseco/">ciseco</a></li>
    
      <li><a href="/categories/community energy/">community energy</a></li>
    
      <li><a href="/categories/control/">control</a></li>
    
      <li><a href="/categories/current sensor/">current sensor</a></li>
    
      <li><a href="/categories/current transformer/">current transformer</a></li>
    
      <li><a href="/categories/dashboard/">dashboard</a></li>
    
      <li><a href="/categories/display/">display</a></li>
    
      <li><a href="/categories/diy drones/">diy drones</a></li>
    
      <li><a href="/categories/documentation/">documentation</a></li>
    
      <li><a href="/categories/efergy/">efergy</a></li>
    
      <li><a href="/categories/electronics/">electronics</a></li>
    
      <li><a href="/categories/elektrocamp/">elektrocamp</a></li>
    
      <li><a href="/categories/email notifications/">email notifications</a></li>
    
      <li><a href="/categories/embodied energy/">embodied energy</a></li>
    
      <li><a href="/categories/emocms/">emocms</a></li>
    
      <li><a href="/categories/emonbase/">emonBase</a></li>
    
      <li><a href="/categories/emonctrl/">emonCtrl</a></li>
    
      <li><a href="/categories/emonglcd/">emonGLCD</a></li>
    
      <li><a href="/categories/emonpi/">emonPi</a></li>
    
      <li><a href="/categories/emonth/">emonTH</a></li>
    
      <li><a href="/categories/emontx/">emonTx</a></li>
    
      <li><a href="/categories/emontx v2/">emonTx V2</a></li>
    
      <li><a href="/categories/emontxsmt/">emonTxSMT</a></li>
    
      <li><a href="/categories/emontxshield/">emonTxShield</a></li>
    
      <li><a href="/categories/emoncms/">emoncms</a></li>
    
      <li><a href="/categories/end-to-end/">end to end</a></li>
    
      <li><a href="/categories/energy monitor/">energy monitor</a></li>
    
      <li><a href="/categories/energy monitoring/">energy monitoring</a></li>
    
      <li><a href="/categories/feed storage/">feed storage</a></li>
    
      <li><a href="/categories/film/">film</a></li>
    
      <li><a href="/categories/graphing/">graphing</a></li>
    
      <li><a href="/categories/hackathon/">hackathon</a></li>
    
      <li><a href="/categories/hall effect/">hall effect</a></li>
    
      <li><a href="/categories/hardware/">hardware</a></li>
    
      <li><a href="/categories/heating/">heating</a></li>
    
      <li><a href="/categories/home camp/">home camp</a></li>
    
      <li><a href="/categories/humidity/">humidity</a></li>
    
      <li><a href="/categories/interface/">interface</a></li>
    
      <li><a href="/categories/interview/">interview</a></li>
    
      <li><a href="/categories/java/">java</a></li>
    
      <li><a href="/categories/job/">job</a></li>
    
      <li><a href="/categories/kickstarter/">kickstarter</a></li>
    
      <li><a href="/categories/linux/">linux</a></li>
    
      <li><a href="/categories/logo/">logo</a></li>
    
      <li><a href="/categories/manufacturing/">manufacturing</a></li>
    
      <li><a href="/categories/measurement/">measurement</a></li>
    
      <li><a href="/categories/media/">media</a></li>
    
      <li><a href="/categories/mobile/">mobile</a></li>
    
      <li><a href="/categories/modbus/">modbus</a></li>
    
      <li><a href="/categories/n/">n</a></li>
    
      <li><a href="/categories/nanode/">nanode</a></li>
    
      <li><a href="/categories/open source/">open source</a></li>
    
      <li><a href="/categories/openhab/">openHAB</a></li>
    
      <li><a href="/categories/openenergymonitor/">openenergymonitor</a></li>
    
      <li><a href="/categories/optical pulse/">optical pulse</a></li>
    
      <li><a href="/categories/pcb/">pcb</a></li>
    
      <li><a href="/categories/pebble/">pebble</a></li>
    
      <li><a href="/categories/pluse/">pluse</a></li>
    
      <li><a href="/categories/presentation/">presentation</a></li>
    
      <li><a href="/categories/raspberry pi/">raspberry pi</a></li>
    
      <li><a href="/categories/renewable/">renewable</a></li>
    
      <li><a href="/categories/serial/">serial</a></li>
    
      <li><a href="/categories/shop/">shop</a></li>
    
      <li><a href="/categories/showcase/">showcase</a></li>
    
      <li><a href="/categories/smartwatch/">smartwatch</a></li>
    
      <li><a href="/categories/social energy monitoring/">social energy monitoring</a></li>
    
      <li><a href="/categories/solarpv/">solarPV</a></li>
    
      <li><a href="/categories/sparkfun/">sparkfun</a></li>
    
      <li><a href="/categories/sustainability/">sustainability</a></li>
    
      <li><a href="/categories/temperature/">temperature</a></li>
    
      <li><a href="/categories/three phase/">three phase</a></li>
    
      <li><a href="/categories/tutorials/">tutorials</a></li>
    
      <li><a href="/categories/upgrade/">upgrade</a></li>
    
      <li><a href="/categories/utility meters/">utility meters</a></li>
    
      <li><a href="/categories/voltage sensing/">voltage sensing</a></li>
    
      <li><a href="/categories/wind/">wind</a></li>
    
      <li><a href="/categories/wind turbine/">wind turbine</a></li>
    
      <li><a href="/categories/wireless/">wireless</a></li>
    
      <li><a href="/categories/workshop/">workshop</a></li>
    
  </ul>
</section>
  
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright">
  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor'><i class="icon-github"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and the <a href='https://github.com/coogie/oscailte'>Oscalite theme</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>