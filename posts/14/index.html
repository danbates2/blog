<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://blog.openenergymonitor.org/posts/14/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="Blog | OpenEnergyMonitor">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="http://blog.openenergymonitor.org/posts/14/">
    <meta property="og:type" content="website">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="Blog | OpenEnergyMonitor">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
    
    
    
    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
	
  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    
    <span style="color:#555;font-weight:bold;font-family:Arial;font-size:20"'>
Open</span><span style="color:#0699fa;font-weight:bold;font-family:Arial;font-size:20"'>EnergyMonitor</span>

  </a>
</div>

<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="http://openenergymonitor.org">Home</a></li>
  <li><a href="http://shop.openenergymonitor.com">Online-Store</a></li>
  <li><a href="http://guide.openenergymonitor.org">User Guide</a></li>
  <li><a href="http://emoncms.org">Emoncms</a></li>
  <li><a href="http://community.openenergymonitor.org">Forum</a></li>
</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

            
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/07/more-direct-file-storage-research/">More direct file storage research</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-07-04T12:04:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-07-04 12:04:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
        <li><a class='category' href='/categories/feed-storage/'>feed storage</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/07/more-direct-file-storage-research/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>I was surprised to find how easy it was to use flat file storage for feed data using PHP file access commands and how fast this approach could be.<br /><br />While reading up on indexes I realised that the timestamp column in a feed data table is its own index as it is naturally sorted in ascending order and each row (datapoint) should be unique. A data-point can then be searched for efficiently using binary search which I remember covering in A-level computing. The feed data in mysql had a binary tree index which If I understand correctly is similar but it is implemented using a separate index layer which uses quite a bit of extra disk space. <br /><br />I had a go at implementing the get_feed_data function used in emoncms to select a given number of datapoint’s over a timewindow used for drawing graphs. An example of the standalone function can be found here: <br /><br /><a href="https://github.com/emoncms/experimental/blob/master/storage/directfiles/get_feed_data.php">https://github.com/emoncms/experimental/blob/master/storage/directfiles/get_feed_data.php</a> <br /><br />A development branch of emoncms that uses this flat file approach and includes this function can be found here (inserting data, input processing such as power to kwhd and visualisation all work, but its still quite conceptual) <br /><br /><a href="https://github.com/emoncms/emoncms/tree/flatfilestore">https://github.com/emoncms/emoncms/tree/flatfilestore</a> <br /><br />The get_feed_data function as implemented above takes roughly 120-230ms on a RaspberryPI to select 1000 datapoints over 1 to 300 days with a feed table with over 9 million rows. <br /><br />Thats much better than the 900-2700ms achieved at similar ranges with the <a href="http://openenergymonitor.blogspot.co.uk/2013/06/rethinking-data-input-and-storage-core.html">current mysql implementation</a>. <br /><br />The feed table in mysql used 178Mb of disk space. The same feed with no loss of data stored without an index and accessed as above takes up 67Mb so that’s a considerable saving. Interestingly a 67Mb feed can be compressed to 18.5Mb with tar.gz compression. <br /><br />One of the issues with the above get_feed_data query is that it needs to know the data interval to do the get a datapoint every x number of datapoints approach. We could use binary search to find every datapoint but this would be slower although maybe worth trying to get a benchmark so that it can be compared. <br /><br />The other issue is that the datapoints selected may not be representative of the window they represent as they are just one random datapoint at a particular point in time. Which is the problem that the averaging approach used by <a href="http://mikestirling.co.uk/redmine/projects/timestore">Mike Stirling in Timestore </a>and by <a href="https://github.com/dovadi/emonWeb">Frank Oakner in EmonWeb</a> solves. <br /><br />Timestore is also a fair bit faster than the above get_feed_data function returning 1000 datapoints in 45ms. <br /><br />The advantage of the above approach is that it can fit into emoncms without having to change the current implementation too much, the feed data retains its timestamps, input processing is used in the same way. <br /><br />Not storing timestamps as timestore does could also be an advantage as it helps keep data quality high: fixed interval datapoints should be easier to use for comparison’s, mathematical operations between feeds, it gives you higher certainty when querying the data, fetching data is faster and disk use is potentially half the size of the above approach if the values are stored as <a href="http://openenergymonitor.blogspot.com/2013/06/timestore-timeseries-database.html">4 byte floats as above rather than the default 8 byte double</a>. This coupled with averaged layers provides data that is representative at all time scales and datapoint number requests. <br /><br />My next step will therefore be to explore timestore further, first creating a script to export data from emoncms into timestore. The script needs to analyse the emoncms feed to work out the most common data interval. It needs to check for missing data, If a monitor went offline for an extended length of time it needs to give you the option to take this into account. It then needs to export and import into timestore as efficiently as possible.</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/07/in-memory-storage-php-shared-memory-vs/">In memory storage: PHP shared memory vs Redis vs MYSQL</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-07-04T09:25:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-07-04 09:25:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
        <li><a class='category' href='/categories/feed-storage/'>feed storage</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/07/in-memory-storage-php-shared-memory-vs/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Continuing on the theme of rethinking the data core of emoncms, as <a href="http://openenergymonitor.blogspot.co.uk/2013/06/rethinking-data-input-and-storage-core.html">previously mentioned</a> for short term storage, storage to disk may not be necessary, instead we can store data in memory using an in-memory database. Here are some tests and benchmarks for in memory storage:<br />&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;To start with I created baseline test using MYSQL updating a feed’s last time and value in the feeds table row for that feed. This took around: 4800 – 5100 ms to update a row 10000 times.&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/inmemory/baselinemysql.php">https://github.com/emoncms/experimental/blob/master/storage/inmemory/baselinemysql.php</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;We would imagine Redis doing a lot better as its in-memory, it isn’t writing to disk each time which is much slower than memory access. Redis did indeed perform faster completing the same number of updates to a key-value pair in 1900 – 2350ms. I’m a little surprised thought that it was only 2.3x as fast and not much faster, but then there is a lot going on Redis has its own server which needs to be accessed from the PHP client this is going to slow things down a bit, I tested both the phpredis client and Predis. Phpredis was between 500-1000 ms faster than the Predis client and is written in c.&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/inmemory/redis.php">https://github.com/emoncms/experimental/blob/master/storage/inmemory/redis.php</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;How fast can in-memory storage be? A general program variable is also a form of in-memory storage, a quick test suggests that it takes 21ms to write to a program variable 10000 times, much better than 2.3x faster that’s 230x faster! The problem with in program variables is that if they are written to in one script say an instance of input/post they cannot be accessed by another instance serving feed/list, we need some form of storage that can be accessed across different instances of scripts.&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/inmemory/programvariable.php">https://github.com/emoncms/experimental/blob/master/storage/inmemory/programvariable.php</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;The difference between 21ms and 1900-2350ms for redis is intriguingly large and so I thought I would search for other ways of storing data in-memory that would allow access between different application scripts and instances.&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;I came across the PHP shared memory functions which are similar to the flat file access but for memory, the results of a simple test are encouraging showing a write time of 48ms for 10000 updates. So from a performance perspective using php shared memory looks like a better way of doing things.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/inmemory/sharedmemory.php">https://github.com/emoncms/experimental/blob/master/storage/inmemory/sharedmemory.php</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;The issue though is implementation, mysql made it really easy to search for the feed rows that you wanted (either by selecting by feed id or by feeds that belong to a user or feeds that are public), I’m a little unsure about how best to implement the similar functionality in redis but it looks like it may be possible by just storing each feed meta data roughly like this: feed_1: {“time”:1300,”value”:20}.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;Shared memory though looks like it could be quite a bit more complicated to implement, but then it does appear to be much faster. Maybe the 2.3x speed improvement over mysql offered by redis is fast enough? and its probably much faster in high-concurrency situations. I think more testing and attempts at writing full implementations using each approach is needed before a definitive answer can be reached.&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/load-stats-for-myisam-vs-innodb-for/">Load stat's for MYISAM vs INNODB for feed storage on the RaspberryPI</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-28T08:26:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-28 08:26:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 1 minute reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
        <li><a class='category' href='/categories/feed-storage/'>feed storage</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/load-stats-for-myisam-vs-innodb-for/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Here are some historic load stats for a raspberrypi running here, with 36 feeds being written to.<br />&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;First using the INNODB storage engine:<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<span style="text-align: left;"><br /></span>&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://3.bp.blogspot.com/-TDFZZ7cyfbE/Uc1E7dSLCeI/AAAAAAAACtI/vbG7etiFS2g/s925/innodb_raspi_load.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="280" src="http://3.bp.blogspot.com/-TDFZZ7cyfbE/Uc1E7dSLCeI/AAAAAAAACtI/vbG7etiFS2g/s640/innodb_raspi_load.png" width="640" /></a>&lt;/div&gt;A load of 3.5 causes an issue where the time that is recorded for data packets coming in gets messed up creating bunched up datapoints:<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-Jhg1mpnwIMQ/Uc1HL91zhjI/AAAAAAAACtg/h-vzID3xHro/s948/timingissue.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="270" src="http://4.bp.blogspot.com/-Jhg1mpnwIMQ/Uc1HL91zhjI/AAAAAAAACtg/h-vzID3xHro/s640/timingissue.png" width="640" /></a>&lt;/div&gt;<br />Switching the storage engine over the MYISAM, reduced the load to around 0.2 and the timing issue is no longer present:<br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-vPe12-x2Gtc/Uc1FAYirGeI/AAAAAAAACtQ/Q5bp_VsvwmQ/s944/piloadmyisam.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="274" src="http://4.bp.blogspot.com/-vPe12-x2Gtc/Uc1FAYirGeI/AAAAAAAACtQ/Q5bp_VsvwmQ/s640/piloadmyisam.png" width="640" /></a>&lt;/div&gt;<br />To convert your raspberry pi emoncms Innodb tables to MYISAM you can run the following script on your raspberrypi which will go through each table converting them in turn:<br /><br /><br /><br />  $mysqli = new mysqli(“localhost”,”root”,”raspberry”,”emoncms”);<br /><br />  $result = $mysqli-&gt;query(“SHOW tables”);<br />  while ($row = $result-&gt;fetch_array())<br />  {<br />    echo “ALTER TABLE <code class="highlighter-rouge">".$row[0]."</code> ENGINE=MYISAM\n”;<br />    $mysqli-&gt;query(“ALTER TABLE <code class="highlighter-rouge">".$row[0]."</code> ENGINE=MYISAM”);<br />  }<br /><br />&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/rethinking-data-input-and-storage-core/">Rethinking the data input and storage core of emoncms: benchmarks</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-27T21:55:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-27 21:55:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> six minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/benchmarking/'>benchmarking</a></li>
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/rethinking-data-input-and-storage-core/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <table>
  <tbody>
    <tr>
      <td>Over the last few days I’ve been looking again at the core data input, storage and access part of emoncms. There is definitely a lot of opportunity to improve performance and there are a lot of options so I thought I would start to do some more systematic benchmarking.<br /><br />So here are some initial benchmarks of feed data storage in different storage engines: mysql (myisam vs innodb), timestore and direct file access. I also thought Id have a go at writing the current implementation of input processing in both python and nodejs in addition to php to learn a bit more about these languages as they are being used and favoured by others in the community such as Jerome (python), Houseahedron (python) and Jean Claude Wippler of Jeelabs (nodejs). Id like to see if there is any measurable difference in performance between these different languages for the kind of application that we are developing and if there are any other benefits: easier to do certain things etc.<br /><br /><a href="http://jeelabs.org/tag/housemon/">Housemon</a> by Jean Claude Wippler is a good example of how a timeseries data storage and visualisation application can be implemented in a different way by using a mixture of direct file storage and a redis in-memory database with the server side part of the application written in nodejs.<br /><br />Intrigued by the idea of using direct file storage as Jean Claude Wippler does in Housemon and following the approach used by Mike Stirling in timestore of using a fixed time interval to simplify and speed up searching I had a go at writing a basic implementation using php file access and the results are good.<br /><br />&lt;div&gt;<span style="font-size: x-large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#storage-engine-test"></a>Storage engine test</span><br /><br />All tested on a raspberrypi, running off the standard SanDisk SDHC 4Gb SD Card. &lt;/div&gt;&lt;div&gt;<br /><span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#mysql"></a>MYSQL</span><br /><br /><a href="https://github.com/emoncms/experimental/blob/master/storage/MYSQL/mysql.php">https://github.com/emoncms/experimental/blob/master/storage/MYSQL/mysql.php</a><br />&lt;ul&gt;&lt;li&gt;InnoDB INSERT 1000 points 21s,25s,20s (Normalised to 100,000 ~ 2200s)&lt;/li&gt;&lt;li&gt;InnoDB INSERT 10000 points 167s,183s (Normalised to 100,000 ~ 1750s)&lt;/li&gt;&lt;li&gt;MYISAM INSERT 10000 points 15-17s (Normalised to 100,000 ~ 160s)&lt;/li&gt;&lt;li&gt;MYISAM INSERT 100000 points 165s&lt;/li&gt;&lt;/ul&gt;<b>MYISAM</b></td>
      <td>INNODB READ&lt;/b&gt;<br /><br />Benchmark of current emoncms mysql read function that selects given number of datapoints over a time window.<br /><br />MYISAM results on the left</td>
      <td>INNODB results on the right<br /><br /><a href="https://github.com/emoncms/experimental/blob/master/storage/MYSQL/mysql_read.php">https://github.com/emoncms/experimental/blob/master/storage/MYSQL/mysql_read.php</a><br /><br />10000 datapoint table:<br />&lt;ul&gt;&lt;li&gt;1000dp over 5 hours (average method) 232ms</td>
      <td>391ms&lt;/li&gt;&lt;li&gt;1000dp over 24 hours (average method) 424ms</td>
      <td>675ms&lt;/li&gt;&lt;/ul&gt;1000000 datapoint table: (115 days @ 10s)<br />&lt;ul&gt;&lt;li&gt;all 0.2 hours (all method) 40ms</td>
      <td>38ms&lt;/li&gt;&lt;li&gt;all 0.5 hours (all method) 58ms</td>
      <td>55ms&lt;/li&gt;&lt;li&gt;all over 1 hours (all method) 90ms</td>
      <td>82ms&lt;/li&gt;&lt;li&gt;all over 1.3 hours (all method) 108ms</td>
      <td>100ms&lt;/li&gt;&lt;li&gt;1000dp over 3 hours (average method) 237ms</td>
      <td>272ms&lt;/li&gt;&lt;li&gt;1000dp over 5 hours (average method) 280ms</td>
      <td>327ms&lt;/li&gt;&lt;li&gt;1000dp over 24 hours (average method) 726 ms</td>
      <td>949ms&lt;/li&gt;&lt;li&gt;1000dp over 48 hours (average method) 1303 ms</td>
      <td>1767ms&lt;/li&gt;&lt;li&gt;1000dp over 52 hours (php loop method) 2875 ms</td>
      <td>2650ms&lt;/li&gt;&lt;li&gt;1000dp over 100 hours (php loop method) 3124 ms</td>
      <td>2882ms&lt;/li&gt;&lt;li&gt;1000dp over 200 hours (php loop method) 2934 ms</td>
      <td>2689ms&lt;/li&gt;&lt;li&gt;1000dp over 400 hours (php loop method) 2973 ms</td>
      <td>2749ms&lt;/li&gt;&lt;li&gt;1000dp over 2000 hours (php loop method) 2956 ms</td>
      <td>2762ms&lt;/li&gt;&lt;li&gt;1000dp over 2600 hours (php loop method) 2969 ms</td>
      <td>2767ms&lt;/li&gt;&lt;/ul&gt;PHP loop method timing may be quite a bit longer if the server is under heavy load as it involves making many separate mysql queries, each query needs to wait for other queries in the mysql process list to complete.<br />&lt;ul&gt;&lt;li&gt;Initial benchmarking results on netbook: <a href="http://emoncms.org/site/docs/developdatastorage">http://emoncms.org/site/docs/developdatastorage</a>&lt;/li&gt;&lt;li&gt;Recent blog post on current emoncms implementation: <a href="http://openenergymonitor.blogspot.co.uk/2013/05/the-current-emoncms-feed-storage.html">The current feed storage implementation</a>&lt;/li&gt;&lt;/ul&gt;<span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#timestore"></a>Timestore</span><br /><br />Timestore is a promising solution, developed specifically for timeseries data, written by Mike Stirling.<br />Blog post on timestore: <a href="http://openenergymonitor.blogspot.com/2013/06/timestore-timeseries-database.html">Timestore timeseries database</a><br /><br /><a href="https://github.com/emoncms/experimental/blob/master/storage/timestore/timestore.php">https://github.com/emoncms/experimental/blob/master/storage/timestore/timestore.php</a><br />&lt;ul&gt;&lt;li&gt;10000 inserts 52s&lt;/li&gt;&lt;li&gt;100,000 inserts 524s&lt;/li&gt;&lt;/ul&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/timestore/timestore_read.php">https://github.com/emoncms/experimental/blob/master/storage/timestore/timestore_read.php</a><br />&lt;ul&gt;&lt;li&gt;Read 1000 datapoints over 5 hours: 45ms&lt;/li&gt;&lt;li&gt;Read 10 datapoints over 5 hours 20ms&lt;/li&gt;&lt;/ul&gt;Includes layer averaging and multiple layers so there is quite a bit more going on (that would still need to be added to other implementations like direct file and mysql above), so benchmarks are not directly comparable.<br /><br /><span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#direct-file"></a>Direct file</span><br />For some reason I did not think this method would work as well as the benchmarks show but its great that it does because from an implementation point of view its really simple and very flexible as its easy to modify the code to do what you want, see the examples linked:<br />&lt;ul&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/directfiles/write.php">Direct file write 100,000</a>: 6-7s&lt;/li&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/directfiles/write_openclose.php">Direct file write 100,000</a> open and close each time: 27,24,26s&lt;/li&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/blob/master/storage/directfiles/read.php">Direct file read 1000</a> datapoints over 5 hours of 10 second data in 85-88ms&lt;/li&gt;&lt;li&gt;Reads 1000 datapoints over 200 hours of 10 second data in 93ms&lt;/li&gt;&lt;li&gt;Reads 1000 datapoints over 2000 hours of 10 second data in 130ms&lt;/li&gt;&lt;li&gt;Reads 1000 datapoints over 2600 hours of 10 second data in 124ms&lt;/li&gt;&lt;/ul&gt;<span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#redis"></a>Redis</span><br />For a short term storage, storage to disk may not be necessary, instead we can store data in memory using an in-memory database like redis. Benchmarks to add.<br /><br />Blog post: <a href="http://openenergymonitor.blogspot.com/2013/06/idea-for-using-redis-in-memory-database.html">Redis idea</a><br /><br /><span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#other-ideas-for-storage-format"></a>Other ideas for storage format</span><br />&lt;ul&gt;&lt;li&gt;<a href="http://openenergymonitor.blogspot.com/2013/06/removing-redundant-datapoints-part-1.html">Removing redundant datapoints - part 1</a>&lt;/li&gt;&lt;li&gt;<a href="http://openenergymonitor.blogspot.com/2013/06/removing-redundant-datapoints-algorithm.html">Removing redundant datapoints – algorithm 1</a>&lt;/li&gt;&lt;/ul&gt;<span style="font-size: large;">Languages</span><br />What about the programming language? No benchmarks yet but interesting to look at the difference in how the code looks. I found each language pretty straightforward to use and online resources to get me passed the bits I didn’t know where readily available. The language links below show the core parts of the input processing stage of emoncms written in php, nodejs and python. I’ve also linked to emonweb a port of emoncms (or more a build in its own right be now) by Frank Oxener in ruby on rails.<br />&lt;ul&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/tree/master/php">PHP</a>&lt;/li&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/tree/master/nodejs">nodejs</a>&lt;/li&gt;&lt;li&gt;<a href="https://github.com/emoncms/experimental/tree/master/python">python</a>&lt;/li&gt;&lt;li&gt;ruby <a href="https://github.com/dovadi/emonWeb">https://github.com/dovadi/emonWeb</a> (Frank Oxener)&lt;/li&gt;&lt;li&gt;go &lt;/li&gt;&lt;/ul&gt;<span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#servers"></a>Servers</span><br />&lt;ul&gt;&lt;li&gt;Apache&lt;/li&gt;&lt;li&gt;nginx <a href="http://www.ismsolar.com/sistema-de-monitorizacion-de-alto-rendimiento">http://www.ismsolar.com/sistema-de-monitorizacion-de-alto-rendimiento</a>&lt;/li&gt;&lt;/ul&gt;<span style="font-size: large;"><a href="https://github.com/emoncms/experimental/blob/master/readme.md#emoncmsorg-stats"></a>Emoncms.org stats</span><br />&lt;ul&gt;&lt;li&gt;<a href="http://openenergymonitor.blogspot.com/2013/05/emoncmsorg-load-stats.html">Emoncms.org load stats</a>&lt;/li&gt;&lt;/ul&gt;<span style="font-size: x-large;">HouseMon</span><br /><br />HouseMon by Jean Claude Wippler stores data in 3 forms: &lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Raw log of the serial data received to file (compressed daily) &lt;/li&gt;&lt;li&gt;Redis in-memory storage for last 48 hours which makes for quick access of most recent data. &lt;/li&gt;&lt;li&gt;Archival storage via direct file access for data older than 48 hours, the archive is hourly aggregated data (hourly - unless a use case demands finer resolution at which point the archive can be rebuilt from the raw logs). &lt;/li&gt;&lt;/ul&gt;<a href="http://jeelabs.org/2013/02/17/data-data-data/">http://jeelabs.org/2013/02/17/data-data-data/ </a><br /><a href="http://jeelabs.org/2013/02/18/who-needs-a-database/">http://jeelabs.org/2013/02/18/who-needs-a-database/ </a><br /><br />Its quite clear from some of the above tests that the housemon implementation is going to be fast in terms of data access speeds (with redis storing everything in memory for the last 48 hours) and efficient in terms of data storage (binary files – hourly data), the big difference is that full resolution data is not available after 48 hours but Jean Claude Wippler argues that it would be better to wait for a use case rather than implement higher resolution for higher resolution sake and that logs can be used to rebuild archives at higher resolution if needed anyway.&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;<span style="font-size: large;">Next steps</span><br /><br />If you have a standard emoncms raspberrypi install, changing the mysql storage engine to myisam should bring immediate performance improvements, especially if you have a lot of feeds being recorded, I will try and put together a script to make this easier and also update the ready to go image.<br /><br />The next development step I think is to integrate redis into emoncms by rebuilding the input processing implementation to use redis rather than go to disk to get the last feed and input values. Then it would be good to test both timestore and the integrated direct file storage in action on several parallel raspberrypi’s, keep benchmarking the differences and then see where that gets us.</td>
    </tr>
  </tbody>
</table>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/idea-for-using-redis-in-memory-database/">Idea for using redis in-memory database to improve emoncms performance</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-25T07:35:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-25 07:35:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emoncms/'>emoncms</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/idea-for-using-redis-in-memory-database/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Most of the time taken to handle posting data to emoncms, (input processing and feed updating) is taken up by requests to the mysql database. The php part of the code is usually pretty fast especially with Opcode cashing enabled such as APC.<br /><br />Reducing the number of MYSQL queries required is usually a sure way to improve the performance of the application. Back in March of this year I re-factored the input processing implementation removing a lot of un-needed repeated queries as described at the bottom of this page: <a href="http://emoncms.org/site/docs/developinputproc">http://emoncms.org/site/docs/developinputproc</a><br />The results where really good, see the pic of <a href="https://twitter.com/Openenergymon/status/313238459965915136/photo/1">time spent serving queries here</a><br />&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;I’ve been thinking about how to improve this further, mysql queries are used a lot for getting the last value of a feed or input, its used for all the +,-,x,/ input processes, the Power to kWh/d, histogram processes, in-fact most of the processes. When a new datapoint is added to a feed data table emoncms also updates the last time and value into the feeds table every time. This is then used by the input processors and also to provide the  live view on the feeds page.&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;None of these input or feed last updated time/value reads and write queries need to be persistent beyond the very short term that an in-memory database would be fine for. Using an in-memory database like redis should be much faster than going to the hard disk or SD card and so hopefully implementing this will lead to a good performance improvement. It also has benefits for longevity of the raspberrypi SD card as it reduces SD card writes. That’s the idea anyway, here’s a bit of basic testing of using redis, the next step is to try to implement this in emoncms.&lt;/div&gt;&lt;div&gt;<br /><b>Install redis and redis php client ubuntu</b><br /><b><br /></b><span style="font-family: Courier New, Courier, monospace;">sudo apt-get install redis-server</span><br /><br />Install PHP redis client https://github.com/nrk/predis. To install using PEAR which we’ve already been using for installation of the serial dio library used by the raspberrypi module, call the following: &lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">sudo apt-get install php-pear php5-dev (if you dont already have pear installed) </span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;"><br /></span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">pear channel-discover pear.nrk.io</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">pear install nrk/Predis  </span><br /><br /><b>Trying redis out:</b> &lt;/div&gt;&lt;div&gt;<br />&lt; ?php<br /><br />&lt;/div&gt;&lt;div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">require ‘Predis/Autoloader.php’;</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">Predis\Autoloader::register();</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;"><br /></span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">$redis = new Predis\Client();</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;"><br /></span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">// 1) Set redis in-memory key-value pair to hold feed meta and last value data</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">// ONCE SET COMMENT OUT THIS LINE TO SEE THAT feed_1 DATA IS PERSISTENT </span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">// BETWEEN CALLS TO THIS SCRIPT - AS LONG AS MEMORY IS NOT RESET.</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">$redis-&gt;set(‘feed_1’,json_encode(array(‘name’=&gt;“Solar Power”,’time’=&gt;time(),’value’=&gt;1800)));</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;"><br /></span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">// 2) Fetch the feed_1 entry from in-memory db</span>&lt;/div&gt;&lt;div&gt;<span style="font-family: Courier New, Courier, monospace;">echo $redis-&gt;get(‘feed_1’);</span>&lt;/div&gt;&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;Redis is also used by Jean Claude Wippler in HouseMon which is cool:<br /><a href="https://github.com/jcw/housemon">https://github.com/jcw/housemon</a><br /><a href="http://jeelabs.org/tag/housemon/">http://jeelabs.org/tag/housemon/</a><br />I’d like to learn more about how HouseMon works, take a little time to get a HouseMon install up and running and familiarise myself with the code and architecture as it looks really nice!&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/building-energy-modelling-simple/">Building Energy Modelling: A simple javascript model</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-24T10:25:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-24 10:25:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> 11 minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/building-energy-modelling-simple/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Putting what we covered in the last two posts together we can create a basic building energy model that covers building <a href="http://openenergymonitor.blogspot.com/2013/06/how-much-energy-does-it-take-to-heat.html">fabric heat loss</a> and <a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-ventilation.html">infiltration heat loss</a>.<br /><br />To start with the model extends the very basic example given in the first blog of the cube house by allowing for different building elements with different U-values: Walls, Roof, Floor, Windows. This is implemented in the same way as can be found in the full SAP model.<br />&lt;div&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-RHJBecKT4f0/UcgVPShFXqI/AAAAAAAACs0/7pKcyO-VwI0/s1600/house02graphic.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="303" src="http://4.bp.blogspot.com/-RHJBecKT4f0/UcgVPShFXqI/AAAAAAAACs0/7pKcyO-VwI0/s400/house02graphic.png" width="400" /></a>&lt;/div&gt;<br />When calculating the heat loss from a building with multiple elements its useful to break the equation for building fabric element heat loss (Building fabric element heat loss = Area x U-Value x temperature difference)  down into three parts.&lt;/div&gt;&lt;div&gt;&lt;ol&gt;&lt;li&gt;Calculate the Area x U-Value for each element giving the heat loss in Watts per Kelvin (W/K) for that building element.&lt;/li&gt;&lt;li&gt;Calculate the sum of the heat loss in W/K for all elements.&lt;/li&gt;&lt;li&gt;Calculate the the total heat loss in Watts for a given temperature difference.&lt;/li&gt;&lt;/ol&gt;Here’s an example house with a fairly simple range of elements, also added is an average infiltration rate for a modern house as covered in the <a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-ventilation.html">last blog post</a>.<br />&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;table cellpadding="4" cellspacing="0" style="width: 100%px;"&gt; &lt;colgroup&gt;&lt;col width="124*"&gt;&lt;/col&gt; &lt;col width="32*"&gt;&lt;/col&gt; &lt;col width="12*"&gt;&lt;/col&gt; &lt;col width="32*"&gt;&lt;/col&gt; &lt;col width="13*"&gt;&lt;/col&gt; &lt;col width="44*"&gt;&lt;/col&gt; &lt;/colgroup&gt;&lt;tbody&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="48%"&gt;<br /><br />&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="12%"&gt;&lt;div align="CENTER"&gt;<b>Area</b>&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="5%"&gt;&lt;div align="CENTER"&gt;<br />&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="12%"&gt;&lt;div align="CENTER"&gt;<b>U-Value</b>&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="5%"&gt;&lt;div align="CENTER"&gt;<br />&lt;/div&gt;&lt;/td&gt;  &lt;td style="border: 1px solid #000000; padding: 0.1cm;" width="17%"&gt;&lt;div align="CENTER"&gt;<b>W/K</b>&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;Solid floor uninsulated&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;49 m2&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;x&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;0.7&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;=&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;34.3 W/K&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;Timber frame walls with 50mm of insulation&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;156 m2&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;x&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;0.45&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;=&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;70.2 W/K&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;Roof with 100mm of loft insulation&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;49 m2&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;x&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;0.25&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;=&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;12.3 W/K&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;Double glazed windows&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;12 m2&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;x&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="12%"&gt;&lt;div align="CENTER"&gt;2.0&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="5%"&gt;&lt;div align="CENTER"&gt;=&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;24.0 W/K&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;Infiltration: average modern house 1.5 air changes per hour.&lt;/td&gt;  &lt;td colspan="4" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="35%"&gt;&lt;div align="RIGHT"&gt;1.5 x 0.33 x 294m<sup>3    </sup>=&lt;/div&gt;&lt;div align="RIGHT"&gt;<br />&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;145.5 W/K&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;<br /><br />&lt;/td&gt;  &lt;td colspan="4" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="35%"&gt;&lt;div align="RIGHT"&gt;<b>TOTAL   </b>&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;<b>286.3 W/K</b>&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;<br /><br />&lt;/td&gt;  &lt;td colspan="4" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="35%"&gt;&lt;div align="RIGHT"&gt;<b>Temperature difference</b>&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;<b>9.0 C</b>&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="48%"&gt;<br /><br />&lt;/td&gt;  &lt;td colspan="4" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="35%"&gt;&lt;div align="RIGHT"&gt;<b>Heat loss (286W/K x 9C =)</b>&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;<b>2577 W</b>&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td colspan="5" style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="83%"&gt;&lt;div align="RIGHT"&gt;<b>Annual total heating demand </b>(including    internal and solar gains)&lt;/div&gt;&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="17%"&gt;&lt;div align="CENTER"&gt;<b>22570 kWh</b>&lt;/div&gt;&lt;/td&gt; &lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;<b>Note: </b>We still need to take into account: solar and internal gains and seasonal temperature variation as a minimum before we get the actual demand on the heating system. <br /><br />So that’s all quite straightforward, the open source SAP implementation is written primarily in javascript with all the calculations happening on the ‘client’ (in the internet browser). The model combined with an interface updated in real-time makes for a dynamic experience with everything being calculated and visualised on the fly. <br /><br />Here’s a javascript implementation of the above with just a simple console output for now: <br />&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<b>Javascript code example</b><br />&lt;pre&gt;var elements = [ <br />  {itemname: “Floor”, grossarea: 49.0, openings: 0, uvalue: 0.7}, <br />  {itemname: “Walls”, grossarea: 168.0, openings: 12.0, uvalue: 0.45}, <br />  {itemname: “Loft”, grossarea: 49.0, openings: 0, uvalue: 0.25}, <br />  {itemname: “Windows”, grossarea: 12.0, openings: 0, uvalue: 2.0} <br />]; <br /><br />var  fabric_heat_loss_WK = 0; <br /><br />for (z in elements) { <br />  elements[z].netarea = elements[z].grossarea - elements[z].openings; <br />  elements[z].axu = elements[z].netarea * elements[z].uvalue; <br />  fabric_heat_loss_WK += elements[z].axu; <br />} <br /><br />var volume = 294;<br />var infiltration = 1.5; // Air change per hour<br />var infiltration_WK = 0.33 * infiltration * volume;<br /><br />var internal_temperature = 21; <br />var external_temperature = 12; <br /><br />var total_heat_loss_WK = fabric_heat_loss_WK + infiltration_WK;<br /><br />var  heatloss =  total_heat_loss_WK * ( internal_temperature -  external_temperature );<br /><br />console.log(“Total heating requirement: “+heatloss.toFixed(0)+” W”); <br />console.log(“Annual heating demand: “+(heatloss<em>0.024</em>365).toFixed(0)+” kWh”); <br /><br />&lt;/pre&gt;You can run this code directly on your computer via linux terminal without using an internet browser using nodejs http://nodejs.org/. To install nodejs on Ubuntu type:<br />&lt;pre&gt;sudo apt-get install nodejs&lt;/pre&gt;<br />create a file called  bem01.js and copy the javascript above into it and save.<br />Locate the file with terminal and then run using: <br />&lt;pre&gt;nodejs bem01.js&lt;/pre&gt;<br />it should output:<br />&lt;pre&gt;Total heating requirement: 2577 W <br />Annual heating demand: 22570 kWh&lt;/pre&gt;<b><br /></b><b>Seasonal temperature variation</b><br />So far to keep things simple we have assumed constant external temperature and internal temperature. There are different ways to take into account temperature variation, one common method is degree days <a href="http://www.degreedays.net/introduction">http://www.degreedays.net/introduction</a>. <br /><br />If I understand it correctly the SAP model uses average indoor temperature minus average external temperature on a monthly basis to calculate total heat demand and then it has a factor that reduces the % of a month the heating is on for if gains from solar and internal sources are significant.<br /><br /><b>Different sources of heat gain</b><br />What we have covered so far covers the heat loss side of the equation but the heating energy requirement is not yet what our heating system needs to provide instead it is the total heat energy going into the system that is our house including heat from other sources in addition to the main heating system, the other heat gains typically taken into account are: Solar gains and Internal Gains which usually consist of Cooking, Lighting  Appliances and metabolic gains (These are the sources covered in the SAP model)<br /><br />The full energy balance equation for a steady state building energy model looks like this:<br /><br />&lt;pre&gt;solar_gains + cooking + lighting + hotwater + appliances + metabolic + heating_system =<br />( fabric_heat_loss_WK + infiltration_WK) x (internal_temperature – external_temperature)&lt;/pre&gt;<br />This is really the fundamental equation that describes a simple steady state building energy model, a large part of the SAP model is concerned with calculating estimates for all the variables that go into this equation.<br /><br /><b>Integrating Monitoring into a building energy model.</b><br />The above equation shows several variables that could be provided or inferred to some degree by monitoring.<br /><br />Internal temperature could be provided by an array of temperature sensors throughout a building. External temperature could be provided by an external temperature sensor or pulled in from a local weather station.<br /><br />Depending on energy source: cooking, lighting, hot water, appliances and heating system input could be provided from either electricity monitoring or electric and gas, the degree of utilisation would need to be taken into account.<br /><br />Solar gains could be calculated from a irradiance sensor or how about normalised solar PV data?<br /><br /><b>Summary of building energy modelling blog posts and code</b><br /> For the open source implementation of the SAP 2012 model see github here:<br /><a href="http://github.com/emoncms/sap">github.com/emoncms/sap</a><br /><br /><a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-part-1-whole.html">Building Energy Modelling part 1 - The Whole House Book</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-part-2-first.html">Building Energy Modelling part 2 - First attempts and research</a><br /><a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-carbon-coop.html">Building Energy Modelling part 3 - Carbon Coop and Open Source SAP 2012</a><br /><br /><a href="http://openenergymonitor.blogspot.com/2013/06/how-much-energy-does-it-take-to-heat.html">How much energy does it take to heat a simple cube house?</a><br /><a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-ventilation.html">Building Energy Modelling: Ventilation and infiltration</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-simple.html">Building Energy Modelling: A simple javascript model</a>&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br /><a href="http://openenergymonitor.blogspot.com/2013/05/carbon-coop.html">Carbon Coop</a><br /><a href="http://openenergymonitor.blogspot.com/2013/06/carbon-coop-and-houseahedron-meetup.html">Carbon Coop and Houseahedron meetup</a>&lt;/div&gt;&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/emonth-prototype/">emonTH Prototype </a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-24T08:57:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-24 08:57:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
        <li><a class='category' href='/categories/emonth/'>emonTH</a></li>
      
        <li><a class='category' href='/categories/humidity/'>humidity</a></li>
      
        <li><a class='category' href='/categories/temperature/'>temperature</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/emonth-prototype/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>I’m currently working on a little unit called the emonTH, a remote temperature and humidity monitoring node. We wanted a tidy looking, easy to deploy little unit for monitoring the environmental conditions in various rooms of our houses. The temperature and humidity data gathered can be fed into emoncms and used for <a href="http://openenergymonitor.blogspot.co.uk/search/label/Building%20Energy%20Modelling">building energy modelling</a>, heating system optimisation etc.<br /><br />The design so far has got options for DS18B20 temperature sensor or DHT22 sensor for humidity &amp; temperature. External sensors can be connected via terminal block (not soldered in on prototype). The enclosure can be wall mountable. The unit will be battery powered with option for mini-usb power. We have estimated around 6-9 months battery. I hope we might be able to get a year or so battery life with optimization and slowing down the readings to once every few min.<br />&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;I’m currently testing prototype #1. &lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;To keep power consumption down the ATmega328 microcontroller is put to sleep in-between reading and the sensors are powered from digital outputs and are turned off altogether in between readings, this should stop any self heating effects (see <a href="http://openenergymonitor.org/emon/node/2484#comment-13108">forum thread</a>), I’m planning to do some accuracy testing on prototype soon.&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://3.bp.blogspot.com/-bbtjnWvcv4o/UcNKNyQh0-I/AAAAAAAAe2w/aWQ1Pm4-xTU/s1600/2013-06-12+09.08.36.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/-bbtjnWvcv4o/UcNKNyQh0-I/AAAAAAAAe2w/aWQ1Pm4-xTU/s320/2013-06-12+09.08.36.jpg" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;emonTH first prototype with DTH22 and DS18B20&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br />&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-G-IkJdFn8uU/UcNKOb7yI7I/AAAAAAAAe20/GcGRXoEM5Hc/s1600/2013-06-12+09.07.50.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/-G-IkJdFn8uU/UcNKOb7yI7I/AAAAAAAAe20/GcGRXoEM5Hc/s320/2013-06-12+09.07.50.jpg" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;emonTH enclosure&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: left;"&gt;As with other the other OpenEnergyMonitor hardware the emonTH has got an ATmega328 with the Arduino bootloader so it’s nice and easy to modify and upload new the code (sketches). For the wireless there is an RFM12B module to be compatible with our other hardware (RFM12Pi base station etc). Again, as with all our other hardware units the schematic and CAD filed will be open-sourced. &lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: left;"&gt;<br />&lt;/div&gt;&lt;div class="" style="clear: both; text-align: left;"&gt;The emonTH uses a little module from <a href="http://shop.ciseco.co.uk/about-us/">Ciseco</a> called <a href="http://shop.ciseco.co.uk/rf-328-bare-arduino-atmega-328-compatible-micro-board-rfu-328/">RFu328</a>. This unit is an ATmega328 plus a radio RFM12B or <a href="http://shop.ciseco.co.uk/rf-328-arduino-atmega-328-compatible-radio-transceiver-rfu-328/">SRF</a> in the same small form factor as an Xbee. We decided to use the RFu328 partly because it’s nice and small and makes manufacture easier for us and party since it allows to to easily swap between using the RFM12B radio or the SRF while keeping the flexibly and ease of use of the ATmega328 with Arduino Uno serial bootloader. &lt;/div&gt;&lt;div class="" style="clear: both; text-align: left;"&gt;<br />&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://openmicros.org/images/RFu-328/RF%C2%B5-328-RFM12-Resistors.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="150" src="http://openmicros.org/images/RFu-328/RF%C2%B5-328-RFM12-Resistors.JPG" width="200" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;RFu328 with RFM12B&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<br />&lt;div&gt;The little red circle on the image above indicates the only hardware charge required when using an RFM12B radio on the RFu328. The SMT resistor is rotated routed 90 degrees swapping over Dig 1 SRF UART (Tx ) to Dig3 (INT 1) to be used as the RFM12B SPI interrupt. The RFu328 with the RFM12B requires a modified JeeLib Arduino library called <a href="https://github.com/openenergymonitor/RFu_jeelib">RFu_JeeLib</a>.<br />&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://cdn2.bigcommerce.com/server3700/8d73a/products/221/images/457/IMG_5389__35236.1352109163.1280.1280.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="298" src="http://cdn2.bigcommerce.com/server3700/8d73a/products/221/images/457/IMG_5389__35236.1352109163.1280.1280.JPG" width="400" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;RFu328 with SRF &amp; Chip Antenna&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/building-energy-modelling-ventilation/">Building Energy Modelling: Ventilation and infiltration</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-23T19:01:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-23 19:01:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> five minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/building-energy-modelling-ventilation/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p><br />Following from the <a href="http://openenergymonitor.blogspot.com/2013/06/how-much-energy-does-it-take-to-heat.html">previous blog that described a simple example of heat loss via heat conduction through the building fabric</a>, the second primary cause of heat loss is ventilation and infiltration. The movement of heated air from inside the house into its surroundings.<br />&lt;div&gt;<br />I wrote the following as a start for the <a href="http://github.com/emoncms/sap">Emoncms SAP module</a> documentation and can be found under <a href="http://emoncms.org/sap/airchange">emoncms.org/sap/airchange</a><br /><br />The rate of air movement is typically measured in air-changes per hour. An air-change is when the full volume of air inside a house is replaced with a new volume of air. This happens surprisingly frequently.<br /><br />The heat lost is equal to the energy stored in the warm air relative to the external temperature, which can be found with another fundamental physics equation, the equation for specific heat:<br />&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); margin-bottom: 10px; padding: 9.5px; word-break: break-all; word-wrap: break-word;"&gt;<span style="color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; white-space: pre-wrap;">H<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">LOSS</sub> = c x m x (T<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">INTERNAL</sub> - T<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">EXTERNAL</sub>)<br /><br />Where:<br /><br />c = Specific heat of air (1006 J/kg.K)<br />m = Mass of air that has moved out of the building per second</span><br />&lt;/pre&gt;(HyperPhysics: <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/hframe.html">Specific heat</a>)<br /><br /><b>Example:</b><br /><br />A house that measures 7 meters wide, 7 meters long and 6 meters high encloses a volume of: 294 m3. The house has an average air tightness for a modern house of around 1.5 air changes an hour and the internal temperature is 20C while the external temperature is 12C.<br /><br />The first step is to work out the m: the mass of air that has moved out of the building per second. We know the volume of air that has moved and the rate at which the volume moved and so we can calculate the mass from this.&lt;/div&gt;&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;mass of one air change = volume x air density&lt;/pre&gt;&lt;div&gt;There are 1.5 air changes per hour or 1.5 / 3600 air changes per second. The mass of air that has moved per second is therefore:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;m = (air-change / 3600) x volume x air density&lt;/pre&gt;The division by density of air and 3600 and also the multiplication by the specific heat of air is in many models bundled together into one constant to reduce on the calculation steps:&lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div&gt;&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;m x c = air-change x volume x (density x c / 3600)&lt;/pre&gt;Where:&lt;/div&gt;&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;density x c / 3600 = 1.205 x 1005 / 3600 = <b>0.336</b>&lt;/pre&gt;The heat loss from ventilation and infiltration becomes:&lt;/div&gt;&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;H<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">LOSS</sub> = 0.33 x air-change x volume x (T<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">INTERNAL</sub> - T<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">EXTERNAL</sub>)&lt;/pre&gt;<br /><br />This is the form of the equation used in the SAP model in section 4 (<a href="http://emoncms.org/sap/4">emoncms.org/sap/4</a>). 0.336 has been rounded down to 0.33 in accordance with the SAP value. The density and specific heat figures above come from: <a href="http://www.engineeringtoolbox.com/air-properties-d_156.html">http://www.engineeringtoolbox.com/air-properties-d_156.html</a><br /><br />Entering our example values in the simplified equation, we get:&lt;/div&gt;&lt;div&gt;<br />&lt;pre style="background-color: whitesmoke; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border-top-left-radius: 4px; border-top-right-radius: 4px; border: 1px solid rgba(0, 0, 0, 0.14902); color: #333333; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; font-size: 13px; line-height: 20px; margin-bottom: 10px; padding: 9.5px; white-space: pre-wrap; word-break: break-all; word-wrap: break-word;"&gt;H<sub style="bottom: -0.25em; font-size: 10px; line-height: 0; position: relative; vertical-align: baseline;">LOSS</sub> = 0.33 x 1.5 x 294 x (20 - 13) = <b>1018.71 Watts</b>&lt;/pre&gt;<b></b><br />&lt;div&gt;<b><b><br /></b></b>&lt;/div&gt;<b>Working out air-changes per hour</b><br /><br />The hard part in the equation above to work out is of course the air changes per hour of a building. The most accurate way to find it out is to perform an air tightness test of the building. This involves de-pressurising the building with specialist fans attached to the front door.<br /><br />The SAP model provides a method to estimate the air-change rate in the absence of a measured value. This method is detailed in full in section 2 (<a href="http://emoncms.org/sap/2">emoncms.org/sap/2</a>) and takes into account factors from number of chimneys and flues to wind speed and the degree the building is sheltered from the wind.<br /><br /><b>Typical air-change per hour values</b><br /><br />As a guide Pat Borer and Cindy Harris give the following values in <a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-part-1-whole.html">the Whole House Book</a>.<br /><br />Old undraught stripped house: 4 air changes per hour<br /><br />Average modern house: 1 to 2 air changes per hour<br /><br />Very tight, super-insulated house: 0.6 air changes per hour&lt;/div&gt;&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/how-much-energy-does-it-take-to-heat/">How much energy does it take to heat a simple cube house?</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-20T14:45:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-20 14:45:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/how-much-energy-does-it-take-to-heat/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Imagine a house that is a hollow cube of uniform material, no windows, no openings, no draughts, just a simple hollow cube.<br /><br />Lets say this cube house is made of nothing but mineral insulation 100mm thick, with internal dimensions: 7m wide, 7m long and 7m high.<br /><br />Our cube house is situated in a climate with no wind or solar gain just a stable 12C outside air temperature year round.<br /><br />How much energy would it take to keep this hypothetical house at a stable 21C?<br />&lt;div style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-RWXJVAkb1ts/UcLM7FaclsI/AAAAAAAACsg/bUMkai1JvKw/s1600/bem01.jpg"><img border="0" height="249" src="http://4.bp.blogspot.com/-RWXJVAkb1ts/UcLM7FaclsI/AAAAAAAACsg/bUMkai1JvKw/s640/bem01.jpg" width="640" /></a>&lt;/div&gt;<br />As we heat the house, heat will flow from the hotter internal air through the walls to the colder external air via conduction and so the equation that we need is the fundamental physics equation for heat conduction.<br /><br />H = (kA / l) x (T<sub>internal</sub> – T<sub>external</sub>)<br /><br />See the great hyperphysics site for more on the <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/hframe.html">heat conduction equation</a> and everything else physics.<br /><br />The <a href="http://en.wikipedia.org/wiki/List_of_thermal_conductivities">Wikipedia table on material thermal conductivity</a> tells us that mineral insulation has a thermal conductivity of 0.04 W/mK. We can take the area of the material to be the internal area of our cube house (imagine folding the cube house out so that we just have this one dimensional wall of area A and thickness l), there is of course a difference between the internal area and the external area of our cube house but lets come back to that one later and take the internal area for now which is:<br /><br />7m x 7m x 6 surfaces = 294 m2<br /><br />Putting the numbers into the heat conductivity equation we get:<br /><br />H = (0.04 x 294 / 0.1) x (21 – 12) = <b>1529 Watts</b><br /><br />And so we find we would need a fairly standard 1.5kW heater to keep our cube house at 21C.<br />1529W continuously would work out to being 37 kWh per day and 13392 kWh/year.<br /><br />Heat loss through building elements is one of the main cornerstones of a building energy model. But in models such as SAP its not usually referred to as the heat conductivity equation nor is the thermal conductivity of a material the usual starting point. Instead models like SAP start with a building elements U-value and an equation that looks like this:<br /><br />Heat loss = U-value x Area x Temperature Difference<br /><br />For an element made of a single uniform material the U-value is simply the materials thermal conductivity k divided by its thickness. But building elements are only sometimes single uniform materials, a building element can also be an assembly of different materials such as a timber stud wall with insulation, membranes and air inside. The physical process of heat transfer through the element may also be a mixture of conductive, convective and radiative heat transfer.<br /><br />Coming from a physics background I found it useful to start with what I was familiar with and I think its useful to understand that in the case where a material is uniform the heat loss through a building element equation is the same as the basic equation for heat conductivity and the U-value is just the k/l part lumped together into one constant.<br /><br />The U-value of our 100mm mineral insulation wall would therefore be: U-value = k / l = 0.04 / 0.1 = 0.4  W/m2.K.<br /><br />If you have a composite of materials, say a layer of wood and then a layer of insulation its possible to calculate the overall U-value in the same way as we calculate the equivalent resistance of parallel resistors in electronics.<br /><br />In the next post I will go through an example of a slightly more complicated but still very simple house model made up a series of different elements with different U-values.<br /><br />For further reading on U-values see <a href="http://www.architecture.com/SustainabilityHub/Designstrategies/Earth/1-1-1-10-Uvalues(INCOMPLETE).aspx">U-values definition and calculation</a> by the RIBA.</p>

    
  </div>
  </article>
  <hr>
  
  <article class="listing">
    <header>
  
  <h1 class="beta">
    <a href="/2013/06/building-energy-modelling-carbon-coop/">Building Energy Modelling part 3 - Carbon Coop and Open Source SAP 2012</a>
  </h1>
  

  
  <div class="meta clearfix">
    <time datetime="2013-06-18T15:04:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2013-06-18 15:04:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Trystan Lea</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/building-energy-modelling/'>Building Energy Modelling</a></li>
      
        <li><a class='category' href='/categories/sap-2012/'>SAP 2012</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2013/06/building-energy-modelling-carbon-coop/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <div class="entry-content clearfix">
    <p>Continuing from the <a href="http://openenergymonitor.blogspot.com/2013/06/building-energy-modelling-part-2-first.html">last post</a> on building energy modelling. Fast forward to late 2012 when I met Matt Fawcett of Carbon Coop and heard at length about all the exciting work they are doing around retrofit, see the blog here: <a href="http://openenergymonitor.blogspot.co.uk/2013/05/carbon-coop.html">http://openenergymonitor.blogspot.co.uk/2013/05/carbon-coop.html</a><br /><br />As I mentioned in the post Carbon coop and their technical partners URBED have put a lot of work into an assessment method for assessing a households suitability for retrofit work, working out a list of measures including full details and costings, how a household can achieve 60-80% carbon reduction. Their assessment method is based on SAP 2012 and was implemented by <a href="http://www.urbed.coop/team/charlie-baker">Charlie Baker</a> of URBED in a Mac Numbers spreadsheet.<br />&lt;div&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-7UroBv-w9fI/UcBz1Sz58BI/AAAAAAAACsI/MB8IWLoUygc/s1600/householdenergyreport.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-7UroBv-w9fI/UcBz1Sz58BI/AAAAAAAACsI/MB8IWLoUygc/s320/householdenergyreport.png" width="229" /></a>&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://carbon.coop/assessments/CC_EXAMPLE_ASSESSMENT2.pdf" style="-webkit-transition: color 0.3s; background-color: #fafafa; color: #009eb8; display: inline; font-family: 'Helvetica Neue Light', HelveticaNeue-Light, 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 19px; outline: none; text-align: justify; text-decoration: initial;">http://carbon.coop/assessments/CC_EXAMPLE_ASSESSMENT2.pdf</a>&lt;/div&gt;&lt;div&gt;<br />Matt explained that to take things further they wanted to integrate the monitoring with the assessments in order to be able to reduce assumptions used and that they thought that longer term an open source online version of the retrofit assessment method would be key to make retrofit more accessible and open for a greater number of people.<br /><br />At home I also wanted to move forward with this idea of being able to use monitoring combined with a building energy model to understand the current building fabric performance at home and the lab and get a better understanding of what the effect would be of adding insulation and draught proofing.<br /><br />And so Matt and I started the process of converting the <a href="http://www.bre.co.uk/filelibrary/SAP/2012/Draft_SAP_2012_December_2011.pdf">SAP 2012 pdf worksheet</a> specification into a open source javascript web application which as a first draft is now about 90% complete, its implemented as an emoncms module so that as it develops we could easily pull in monitored data sets such as the actual average monthly internal temperature in the building, actual electricity consumption for internal gains and so on. &lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-1Whrj9OmwX4/UcB0gKVdx6I/AAAAAAAACsQ/1FVjeZoMI28/s1600/rating.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="251" src="http://4.bp.blogspot.com/-1Whrj9OmwX4/UcB0gKVdx6I/AAAAAAAACsQ/1FVjeZoMI28/s400/rating.png" width="400" /></a>&lt;/div&gt;&lt;div&gt;<br />&lt;div&gt;<br />The module source code can be found on github here: <a href="http://github.com/emoncms/sap">github.com/emoncms/sap</a><br /><br />Try it out on emoncms.org here:<a href="http://emoncms.org/sap"> http://emoncms.org/sap</a> (no need to login)<br /><br />Most of the calculations can be found in the javascript file <a href="https://github.com/emoncms/sap/blob/master/equations.js">equations.js </a>and associated functions in solar.js, windowgains.js and utilisationfactor.js. The interface pages can be found in the folder named compiled (which isn’t a particularly good name any more, a remnant from earlier development). The file sap_view.php is what ties it all together loading the equations.js and the relevant page interface. <br /><br />Having got this far with the implementation and understanding better the requirements, what calculations are needed etc, its becoming clearer that the current implementation really needs a round of re-factoring to make it easier to develop with going forward. <br /><br />The SAP model lends it self well to be broken down into a series of sub-modules, so rather than have all calculations in one file, the various parts of the calculation and related interfaces are broken out into separate modules with clear inputs and outputs and the possibility of being able to interchange these sub-modules, you could decide to use the SAP internal temperature estimation sheet/model or bring that in from monitored data for example. <br /><br />So that’s pretty much the state of development on this at the moment. The<a href="http://openenergymonitor.blogspot.com/2013/06/carbon-coop-and-houseahedron-meetup.html"> recent meetup with Houseahedron</a> couldn’t really have come with better timing as Matt and I had just been chatting about where this could lead in the future and what would be really cool to have, we where saying how nice it would be if the building thermal data could be visualised in 3D but thought that would be something a long way down the line, it was literally a couple of week later that the Houseahedron team got in contact saying they where going to be developing just this and all open source. With a larger team of us, with different skill-sets working on this, I think this could turn out to be a really useful tool that integrates well with monitoring to allows us to better quantify the performance of buildings and the effect of implementing various measures, exciting stuff!&lt;/div&gt;&lt;/div&gt;</p>

    
  </div>
  </article>
  <hr>
  
 
  <div class="pagination">
    
      <a class="btn pull-left" href="/posts/15">&larr; Older</a>
    

    
    <a class="btn pull-right" href="/posts/13">Newer &rarr;</a>
    
  </div>


        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2016/04/Understand-CO2-intensity-grid-electricity/">Attempting to measure and understand the CO2 intensity of grid electricity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Git-Sub-Modules/">GitHub Submodules</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Home-Assistant/">Home Assistant and emonPi</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/03/raspberry-pi-3/">Raspberry Pi 3 </a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/02/outdoor-temperature-data-from-weather/">Outdoor Temperature Data from Weather Underground to Emoncms & MQTT</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/02/heat-pump-testing-initial-results/">Heat pump Testing: Initial results</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/01/french-low-carbon-energy-film-featuring/">Low carbon energy film featuring OpenEnergyMonitor</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2015/12/heatpumps-in-zerocarbonbritain-model-by/">Heatpumps in the ZeroCarbonBritain model by the Centre for Alternative Technology.</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2015/12/heat-pump-monitoring/">Heat pump Monitoring</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2015/12/emoncms-android-app/">Emoncms Android App</a>
        </li>
      
    
  </ul>
</section>
  
  
     <section class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Categories</h1>
  <ul class="divided">
    
    
      <li><a href="/categories/air quality egg/">Air Quality Egg</a></li>
    
      <li><a href="/categories/android/">Android</a></li>
    
      <li><a href="/categories/antenna/">Antenna</a></li>
    
      <li><a href="/categories/building energy modelling/">Building Energy Modelling</a></li>
    
      <li><a href="/categories/china/">China</a></li>
    
      <li><a href="/categories/christmas/">Christmas</a></li>
    
      <li><a href="/categories/course/workshop/">Course/Workshop</a></li>
    
      <li><a href="/categories/dc/">DC</a></li>
    
      <li><a href="/categories/dc current sensing/">DC current sensing</a></li>
    
      <li><a href="/categories/esp8266/">ESP8266</a></li>
    
      <li><a href="/categories/heat pump/">Heat Pump</a></li>
    
      <li><a href="/categories/kaizen/">Kaizen</a></li>
    
      <li><a href="/categories/kicad/">KiCad</a></li>
    
      <li><a href="/categories/mqtt/">MQTT</a></li>
    
      <li><a href="/categories/nanoderf/">NanodeRF</a></li>
    
      <li><a href="/categories/nodered/">NodeRed</a></li>
    
      <li><a href="/categories/oem labs/">OEM Labs</a></li>
    
      <li><a href="/categories/okg/">OKG</a></li>
    
      <li><a href="/categories/oscilloscope/">Oscilloscope</a></li>
    
      <li><a href="/categories/rfm12/">RFM12</a></li>
    
      <li><a href="/categories/rfm69/">RFM69</a></li>
    
      <li><a href="/categories/rs485/">RS485</a></li>
    
      <li><a href="/categories/sap 2012/">SAP 2012</a></li>
    
      <li><a href="/categories/shw/">SHW</a></li>
    
      <li><a href="/categories/srf/">SRF</a></li>
    
      <li><a href="/categories/tasker/">Tasker</a></li>
    
      <li><a href="/categories/app/">app</a></li>
    
      <li><a href="/categories/arduino/">arduino</a></li>
    
      <li><a href="/categories/award/">award</a></li>
    
      <li><a href="/categories/backup/">backup</a></li>
    
      <li><a href="/categories/batteries/">batteries</a></li>
    
      <li><a href="/categories/benchmarking/">benchmarking</a></li>
    
      <li><a href="/categories/build sesh/">build sesh</a></li>
    
      <li><a href="/categories/business/">business</a></li>
    
      <li><a href="/categories/ciseco/">ciseco</a></li>
    
      <li><a href="/categories/community energy/">community energy</a></li>
    
      <li><a href="/categories/control/">control</a></li>
    
      <li><a href="/categories/current sensor/">current sensor</a></li>
    
      <li><a href="/categories/current transformer/">current transformer</a></li>
    
      <li><a href="/categories/dashboard/">dashboard</a></li>
    
      <li><a href="/categories/display/">display</a></li>
    
      <li><a href="/categories/diy drones/">diy drones</a></li>
    
      <li><a href="/categories/documentation/">documentation</a></li>
    
      <li><a href="/categories/efergy/">efergy</a></li>
    
      <li><a href="/categories/electronics/">electronics</a></li>
    
      <li><a href="/categories/elektrocamp/">elektrocamp</a></li>
    
      <li><a href="/categories/email notifications/">email notifications</a></li>
    
      <li><a href="/categories/embodied energy/">embodied energy</a></li>
    
      <li><a href="/categories/emonbase/">emonBase</a></li>
    
      <li><a href="/categories/emonctrl/">emonCtrl</a></li>
    
      <li><a href="/categories/emonglcd/">emonGLCD</a></li>
    
      <li><a href="/categories/emonpi/">emonPi</a></li>
    
      <li><a href="/categories/emonth/">emonTH</a></li>
    
      <li><a href="/categories/emontx/">emonTx</a></li>
    
      <li><a href="/categories/emontx v2/">emonTx V2</a></li>
    
      <li><a href="/categories/emontxsmt/">emonTxSMT</a></li>
    
      <li><a href="/categories/emontxshield/">emonTxShield</a></li>
    
      <li><a href="/categories/emoncms/">emoncms</a></li>
    
      <li><a href="/categories/end-to-end/">end to end</a></li>
    
      <li><a href="/categories/energy monitor/">energy monitor</a></li>
    
      <li><a href="/categories/energy monitoring/">energy monitoring</a></li>
    
      <li><a href="/categories/feed storage/">feed storage</a></li>
    
      <li><a href="/categories/github/">github</a></li>
    
      <li><a href="/categories/graphing/">graphing</a></li>
    
      <li><a href="/categories/hackathon/">hackathon</a></li>
    
      <li><a href="/categories/hall effect/">hall effect</a></li>
    
      <li><a href="/categories/hardware/">hardware</a></li>
    
      <li><a href="/categories/heating/">heating</a></li>
    
      <li><a href="/categories/home assistant/">home Assistant</a></li>
    
      <li><a href="/categories/home camp/">home camp</a></li>
    
      <li><a href="/categories/humidity/">humidity</a></li>
    
      <li><a href="/categories/integrations/">integrations</a></li>
    
      <li><a href="/categories/interface/">interface</a></li>
    
      <li><a href="/categories/interview/">interview</a></li>
    
      <li><a href="/categories/java/">java</a></li>
    
      <li><a href="/categories/job/">job</a></li>
    
      <li><a href="/categories/kickstarter/">kickstarter</a></li>
    
      <li><a href="/categories/linux/">linux</a></li>
    
      <li><a href="/categories/logo/">logo</a></li>
    
      <li><a href="/categories/manufacturing/">manufacturing</a></li>
    
      <li><a href="/categories/measurement/">measurement</a></li>
    
      <li><a href="/categories/media/">media</a></li>
    
      <li><a href="/categories/mobile/">mobile</a></li>
    
      <li><a href="/categories/modbus/">modbus</a></li>
    
      <li><a href="/categories/nanode/">nanode</a></li>
    
      <li><a href="/categories/open source/">open source</a></li>
    
      <li><a href="/categories/openhab/">openHAB</a></li>
    
      <li><a href="/categories/openenergymonitor/">openenergymonitor</a></li>
    
      <li><a href="/categories/optical pulse/">optical pulse</a></li>
    
      <li><a href="/categories/pcb/">pcb</a></li>
    
      <li><a href="/categories/pebble/">pebble</a></li>
    
      <li><a href="/categories/pluse/">pluse</a></li>
    
      <li><a href="/categories/presentation/">presentation</a></li>
    
      <li><a href="/categories/raspberry pi/">raspberry pi</a></li>
    
      <li><a href="/categories/renewable/">renewable</a></li>
    
      <li><a href="/categories/serial/">serial</a></li>
    
      <li><a href="/categories/shop/">shop</a></li>
    
      <li><a href="/categories/showcase/">showcase</a></li>
    
      <li><a href="/categories/smartwatch/">smartwatch</a></li>
    
      <li><a href="/categories/social energy monitoring/">social energy monitoring</a></li>
    
      <li><a href="/categories/solarpv/">solarPV</a></li>
    
      <li><a href="/categories/sparkfun/">sparkfun</a></li>
    
      <li><a href="/categories/sustainability/">sustainability</a></li>
    
      <li><a href="/categories/temperature/">temperature</a></li>
    
      <li><a href="/categories/three phase/">three phase</a></li>
    
      <li><a href="/categories/tutorials/">tutorials</a></li>
    
      <li><a href="/categories/upgrade/">upgrade</a></li>
    
      <li><a href="/categories/utility meters/">utility meters</a></li>
    
      <li><a href="/categories/voltage sensing/">voltage sensing</a></li>
    
      <li><a href="/categories/wind/">wind</a></li>
    
      <li><a href="/categories/wind turbine/">wind turbine</a></li>
    
      <li><a href="/categories/wireless/">wireless</a></li>
    
      <li><a href="/categories/workshop/">workshop</a></li>
    
  </ul>
</section>
  
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright">
  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor'><i class="icon-github"></i></a>
  <a rel="me" href='http://blog.openenergymonitor.org/atom.xml'><i class="icon-rss"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and the <a href='https://github.com/coogie/oscailte'>Oscalite theme</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>