<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: emonPi | Blog | OpenEnergyMonitor]]></title>
  <link href="http://blog.openenergymonitor.org/categories/emonpi/atom.xml" rel="self"/>
  <link href="http://blog.openenergymonitor.org/"/>
  <updated>2016-05-03T19:12:14+00:00</updated>
  <id>http://blog.openenergymonitor.org/</id>
  <author>
    <name><![CDATA[Glyn Hudson]]></name>
    <email><![CDATA[support@openenergymonitor.zendesk.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[OpenEnergyMonitor, emonPi and openHAB ]]></title>
    <link href="http://blog.openenergymonitor.org/2015/12/openenergymonitor-emonpi-and-openhab/"/>
    <updated>2015-12-13T18:00:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2015/12/openenergymonitor-emonpi-and-openhab</id>
    <content type="html"><![CDATA[<div class="separator" style="clear: both; text-align: left;"><br /></div>
<div class="" style="clear: both; text-align: left;">Using the emonPi in it's current default configuration works great to post data to Emoncms for logging and visualisation. However there may be times when you want some more flexibility and or ability to interface with other hardware or services&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;"><br /></div>
<div class="separator" style="clear: both; text-align: left;">In my last few blog posts I have been taking a look at making the <a href="http://shop.openenergymonitor.com/emonpi-1/">emonPi</a> the heart of a smart energy optimised home and how live energy monitoring data from the emonPi can easily be used to inform other services: &nbsp;&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;"><br /></div>
<div class="" style="clear: both; text-align: left;">1.
<!--more-->

&nbsp;<a href="http://openenergymonitor.blogspot.co.uk/2015/10/emonpi-nodered-and-mqtt.html">Integrating&nbsp;Node-RED and MQTT&nbsp;on the emonPi</a></div>
<div class="separator" style="clear: both; text-align: left;">2. <a href="http://openenergymonitor.blogspot.co.uk/2015/11/node-red-emoncms-node.html">Node-RED and Emoncms</a></div>
<div class="" style="clear: both; text-align: left;">3. <a href="http://openenergymonitor.blogspot.co.uk/2015/11/remote-control-of-lightwave-rf-plugs.html">Controlling LightWaveRF devices on the emonPi</a>&nbsp;(OOK RF Tx)&nbsp;</div>
<div class="" style="clear: both; text-align: left;"><br /></div>
<div class="" style="clear: both; text-align: left;">Following on from my last post on controlling LightWaveRF devices from the emonPi using MQTT we now need a front end interface to handle the control. I have recently been taking a look at how openHAB can be configured to provide a front end interface to OpenEnergyMonitor hardware and control.&nbsp;</div>
<div class="" style="clear: both; text-align: left;"><br /><a href="http://2.bp.blogspot.com/-Mn4SF-hLCuQ/Vm2cvhlvFCI/AAAAAAABkr4/cq8GoyQEYkc/s1600/openhab.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="179" src="http://2.bp.blogspot.com/-Mn4SF-hLCuQ/Vm2cvhlvFCI/AAAAAAABkr4/cq8GoyQEYkc/s320/openhab.jpg" width="320" /></a><br /><br /></div>
<div class="" style="clear: both; text-align: left;">We are working on releasing an updated pre-built SD card stack for the emonPi which will include Emoncms V9, MQTT, Node-RED and openHAB all pre-configured. I hope to post a beta image download to the forums in the next few days.&nbsp;</div>
<div class="" style="clear: both; text-align: left;"><br /></div>
<div class="" style="clear: both; text-align: left;"><a href="http://www.openhab.org/">Open Home Automation Bus (openHAB)</a> is "a vendor and technology agnostic open source automation software for your home". OpenHAB can run on an emonPi (Raspberry Pi) and is very flexible and can be configured for just about any home automation task. This high level of configurability can also make it seem quite hard to understand to start with. I've have put together a <a href="https://github.com/openenergymonitor/oem_openHab">skeleton config to setup openHAB with to OpenEnergyMonitor</a> pulling data from the MQTT server running on an emonPi.&nbsp;</div>
<div class="separator" style="clear: both; text-align: left;"><br /></div>
<div class="" style="clear: both; text-align: left;">Once setup you simply browse to&nbsp;<a href="http://emonpi:8080/openhab.app?sitemap=oem">http://emonpi:8080/openhab.app?sitemap=oem</a>&nbsp;to view the openHAB user interface. openHAB also has a nice Android or IOS app which can be pointed at the same URL. &nbsp; <br /><br /></div>
<table align="left" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: left;"><tbody><tr><td style="text-align: left;"><a href="http://1.bp.blogspot.com/-lAn2SNSzyLQ/VmVkYfsFDxI/AAAAAAABkic/Wqhp7g4R4uA/s1600/OpenEnergyMonitor_openHAB.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-lAn2SNSzyLQ/VmVkYfsFDxI/AAAAAAABkic/Wqhp7g4R4uA/s400/OpenEnergyMonitor_openHAB.png" width="385" /></a></td></tr><tr><td class="tr-caption" style="text-align: left;">openHAB OpenEnergyMonitor skeleton setup</td></tr></tbody></table>
<div class="separator" style="clear: both; text-align: left;"><br /></div>
<table align="left" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: left;"><a href="http://2.bp.blogspot.com/--fxB-426-Hs/VmXNqpc1KJI/AAAAAAABkk4/lzBoHKFz5g8/s1600/Screenshot_2015-12-07-10-23-42.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/--fxB-426-Hs/VmXNqpc1KJI/AAAAAAABkk4/lzBoHKFz5g8/s400/Screenshot_2015-12-07-10-23-42.png" width="225" /></a></td></tr><tr><td class="tr-caption" style="text-align: left;">openHAB Android app</td></tr></tbody></table>
<table align="left" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: left;"><a href="http://4.bp.blogspot.com/-Y_6-BnAJWcE/VmXNqpDvxjI/AAAAAAABkkw/4kpSmg9rdtU/s1600/Screenshot_2015-12-07-10-23-52.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-Y_6-BnAJWcE/VmXNqpDvxjI/AAAAAAABkkw/4kpSmg9rdtU/s400/Screenshot_2015-12-07-10-23-52.png" width="225" /></a></td></tr><tr><td class="tr-caption" style="text-align: left;">openHAB LightWaveRF control using openHAB Android app</td></tr></tbody></table>
<p><br /><br /><br /><br />&lt;div class="separator" style="clear: both; text-align: left;"&gt;&lt;/div&gt;<br />&lt;h3&gt;Installing OpenHAB&lt;/h3&gt;&lt;div&gt;<span id="goog_2128785651"></span>I have put together a <a href="https://github.com/openenergymonitor/oem_openHab">guide from installing OpenHAB on an emonPi</a> with the config shown above to work with OpenEnergyMonitor on the oem_openHAB GitHub<span id="goog_2128785652"></span>. &lt;/div&gt;&lt;div&gt;<br />&lt;/div&gt;&lt;h3&gt;OpenHAB Configuration &lt;/h3&gt;OpenHAB configuration is based around two files ‘items and ‘sitemap’. In my openHAB emonPi install instructions I recommend cloning the oem_openHAB to the home directory then soft linking the Items and Sitemap files to the relevant config locations in /etc/openhab/configurations/. This makes the files easier to edit.<br /><br />It’s possible to have multiple user interfaces defined by multiple sitemaps e.g oem.sitemap, kids.sitemap or admin.sitemap etc.<br /><br /><b>Items</b><br /><b><br /></b>The items file defines all the ‘things’ you might want to view or control in openHAB. Items can be bound to ‘bindings’ which are optional packages that used to extend functionality of openHAB. This example makes use of the MQTT and HTTP bindings. The items file is usually located in /etc/openhab/configurations/items.<br /><br />For example the line in the items file to pull power 1 from emonhub MQTT is as follows:<br /><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;">Number  emonpi_ct1       “Power 1 [%d W]”    { mqtt=”&lt;[mosquitto:emonhub/rx/5/values:state:REGEX((.<em>),.</em>,.<em>,.</em>,.<em>,.</em>,.<em>,.</em>,.<em>,.</em>,.*)]” }</span><br /><br /><br />Notice the REGEX is used to tell openHAB that we want the first value in the 11 part CSV emonhub posts to MQTT to emonhub/rx/5/values.<br /><br />and the items line to control LightWaveRF plug 1 (publish “1 1” to /lwrf mqtt topic) is as follows:<br /><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;">Switch lwrf1   “LWRF Socket 1”  {mqtt=”&gt;[mosquitto:lwrf:command:ON:1 1],&gt;[mosquitto:lwrf:command:OFF:1 0]”}</span><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;"><br /></span><a href="https://github.com/openenergymonitor/oem_openHab/blob/master/oem.items">See the full items file used for this example on the open_openhab GitHub repo</a><br /><br /><b>Sitemap</b><br /><b><br /></b>The second openHAB config file of interest is ‘sitemap’. Sitemaps are used to create elements of a user interface for making openHAB items accessible to the frontend interface.<br /><br />For example the sitemap config line to produce the emonPi Power1 in the interface is as follows:<br /><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;">Text item=emonpi_ct1 icon=”firstfloor”</span><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;"><br /></span>And to produce the LightWaveRF control swithches:<br /><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;">Switch item=lwrf1 label=”LWRF Plug 1”</span><br /><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;"><br /></span><span style="background-color: white; color: #333333; font-family: &quot;consolas&quot; , &quot;liberation mono&quot; , &quot;menlo&quot; , &quot;courier&quot; , monospace; font-size: 12px; line-height: 16.8px; white-space: pre;"><br /></span><a href="https://github.com/openenergymonitor/oem_openHab/blob/master/oem.sitemap">See the full sitemap file used for this example on the open_openhab GitHub repo</a><br /><br />I have intentionally kept this ‘skeleton’ example as simple as possible. To view the full capabilities of openHAB including using groups checkout the <a href="http://demo.openhab.org:8080/openhab.app?sitemap=demo">openHAB demo</a> and corresponding demo <a href="https://github.com/openhab/openhab/blob/master/distribution/openhabhome/configurations/items/demo.items">items</a> and <a href="https://github.com/openhab/openhab/blob/master/distribution/openhabhome/configurations/sitemaps/demo.sitemap">sitemap</a> files.<br /><br />&lt;h3&gt;Demo&lt;/h3&gt;<br />Here’s a quick demo I made using openHAB to control LightWave RF plugs:<br /><br />&lt;div class="separator" style="clear: both; text-align: left;"&gt;<a href="http://3.bp.blogspot.com/-SzaE2KRbyrY/Vm2tX_kJbzI/AAAAAAABksQ/j_A9OuXi6KA/s1600/Screenshot%2B2015-12-13%2Bat%2B17.35.56.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="411" src="http://3.bp.blogspot.com/-SzaE2KRbyrY/Vm2tX_kJbzI/AAAAAAABksQ/j_A9OuXi6KA/s640/Screenshot%2B2015-12-13%2Bat%2B17.35.56.png" width="640" /></a>&lt;/div&gt;<br />&lt;div class="separator" style="clear: both; text-align: left;"&gt;&lt;iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/6uF0qU30q-g/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/6uF0qU30q-g?feature=player_embedded" width="320"&gt;&lt;/iframe&gt;&lt;/div&gt;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Remote Control of LightWave RF plugs via MQTT using emonPi with OOK Tx]]></title>
    <link href="http://blog.openenergymonitor.org/2015/11/remote-control-of-lightwave-rf-plugs/"/>
    <updated>2015-11-26T17:09:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2015/11/remote-control-of-lightwave-rf-plugs</id>
    <content type="html"><![CDATA[<p>Using a Raspberry Pi as an emonPi / emonBase web-connected base station for energy monitoring has many advantages (maintainability, remote access, debugging, updated etc.) but it does seem rather wasteful to have a 900Mhz 1GB RAM machine being used to post a couple of integers to a web-server! The always-on nature of a web-connected base station and plenty of spare processing power makes it ideal to use the emonPi for more than just energy monitoring; home automation and heating control optimisation are obvious candidates. <br /><br /><br /><b>Hardware</b><br /><b><br /></b>Many home automation products such as RF plugs, relays and heating remotes use a simple OOK (On-Off-Keying) wireless protocol. UK company LightWaveRF produce a <a href="http://www.megamanuk.com/lightwaverf/products/power-control/">variety of RF plugs</a> and <a href="http://www.megamanuk.com/lightwaverf/products/inline-switching/jsjslw830/">relays</a> which can be controlled via OOK RF. The protocol is also compatible with some <a href="http://www.ebay.co.uk/itm/321887470042?_trksid=p2057872.m2749.l2649&amp;var=510834121070&amp;ssPageName=STRK%3AMEBIDX%3AIT">cheaper OOK learning receiver relays</a>.  While maybe not strictly open-source the protocol and been reverse engineered allowing plugs to be easily controlled from Arduino / Raspberry Pi. There is an active <a href="http://lightwaverfcommunity.org.uk/forum/">LightWaveRF</a> online community. Using off-the shelf hardware like this is a ‘safe’ way to control lights, heaters and appliances  around a home without getting our hands dirty dealing with with high voltages. These plugs and relays can be used to control anything from lights to immersion heaters, most LightWaveRF plugs/relays will switch up to 13A / 3kW.<br /><br />Note: OOK protocol by it’s simplistic nature is not particularly secure, I would not recommend controlling anything you don’t mind getting accidently switched.<br />&lt;div&gt;<br />&lt;/div&gt;An OOK transmitter can easily be added to the emonPi.  We have started stocking <a href="http://shop.openenergymonitor.com/ook-on-off-keying-transmitter-433mhz/">OOK transmitter modules in the OpenEnergyMonitor store</a> as well as adding an option to have OOK module factory installed on <a href="http://shop.openenergymonitor.com/emonpi/">new emonPi’s</a>. <br /><br />See <a href="http://wiki.openenergymonitor.org/index.php?title=EmonPi#OOK">emonPi Technical Hardware Wiki</a> for details how to retrofit OOK TX module to existing emonPi’s.<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://3.bp.blogspot.com/-ooKdNYl_8fA/Vlc-c0pyyJI/AAAAAAABj5o/M6wlA5rH_Ko/s1600/emonPi_lwrf.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-ooKdNYl_8fA/Vlc-c0pyyJI/AAAAAAABj5o/M6wlA5rH_Ko/s640/emonPi_lwrf.png" width="600" /></a>&lt;/div&gt;<br /> <b>Software</b><br /><br />We have been working with <a href="https://github.com/lawrie">Lawrie Griffiths</a> from <a href="https://geekgrandad.wordpress.com/">Geek Grandad blog</a> to develop a <a href="https://github.com/lawrie/LightwaveRF">LightWaveRF MQTT service</a> to run on a Raspberry Pi to allow LightWaveRF plugs to be controlled via MQTT.<br /><br />&lt;table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="https://www.electricalsupplies.co.uk/media/catalog/product/0/0/0019040_megaman-lightwave-rf-handheld-remote-controller-white.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="https://www.electricalsupplies.co.uk/media/catalog/product/0/0/0019040_megaman-lightwave-rf-handheld-remote-controller-white.jpeg" width="213" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;<br />&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;Once running a plug can be controlled by publishing to the ‘lwrf’ MQTT topic:<br /><br />E.g “1 1” switches on plug 1 while “1 0” switches off plug 1. Plugs can be paired in the usual LightWaveRF plug.<br /><br /><b>See <a href="http://wiki.openenergymonitor.org/index.php/EmonPi#LightWaveRF_OOK">emonPi technical Wiki</a> for how to install &amp; setup</b>.<br /><br />Existing LightWaveRF remotes can be emulated allowing plugs to be controlled from either emonPi MQTT or via the remote.<br /><br />Now our plugs can be controlled via MQTT there are a many of options open as to how to control either via interface openHAB (blog post coming soon..), nodeRED, Android Tasker etc.<br /><br />I have been using nodeRED with input from Android <a href="http://owntracks.org/">OwnTracks</a> running on my phone to detect when I’m home and turn on a couple of lights:<br /><br />&lt;div class="" style="clear: both; text-align: center;"&gt;<b>Demo:</b>&lt;/div&gt;&lt;div class="" style="clear: both; text-align: center;"&gt;<b><br /></b>&lt;/div&gt;&lt;div class="" style="clear: both; text-align: center;"&gt;Using NodeRED and OwnTracks to turn on LightWave RF sockets when I arrive home: &lt;/div&gt;&lt;div class="" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div style="text-align: left;"&gt;<a href="http://3.bp.blogspot.com/-gt2MVmKylsk/VlOTJKgRb5I/AAAAAAABjrQ/hZUctXS_e_s/s1600/Screenshot%2B2015-11-23%2Bat%2B22.28.06.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="280" src="http://3.bp.blogspot.com/-gt2MVmKylsk/VlOTJKgRb5I/AAAAAAABjrQ/hZUctXS_e_s/s640/Screenshot%2B2015-11-23%2Bat%2B22.28.06.png" width="640" /></a>&lt;/div&gt;<b><br /></b>&lt;iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/GVKXgS01Vqw/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/GVKXgS01Vqw?feature=player_embedded" width="320"&gt;&lt;/iframe&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;Using Android Tasker with  AutoVoice and MQTT plugins to control LightWaveRF sockets:&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/QjIqo4QsywA/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/QjIqo4QsywA?feature=player_embedded" width="320"&gt;&lt;/iframe&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<b>Next Steps</b>&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;Now we can control appliances remotely via MQTT the next logical step is to add a mobile user interface. In my next blog post I plan to explore setting up <a href="http://www.openhab.org/">openHab</a> to control appliances. Here’s a early preview: &lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/6uF0qU30q-g/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/6uF0qU30q-g?feature=player_embedded" width="320"&gt;&lt;/iframe&gt;<br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;We plan to include out-of-the-box support for OOK LightWave RF, nodeRED and openHab pre-configured on our next emonPi pre-built SD card. Due for release in December 2015.&lt;/div&gt;<br /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[emonPi, NodeRed and MQTT]]></title>
    <link href="http://blog.openenergymonitor.org/2015/10/emonpi-nodered-and-mqtt/"/>
    <updated>2015-10-12T10:52:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2015/10/emonpi-nodered-and-mqtt</id>
    <content type="html"><![CDATA[<p>Using the <a href="http://openenergymonitor.org/emon/modules/emonpi">emonPi in it’s default configuration</a> works great to post data to Emoncms for logging and visualisation. However there may be times when you want some more flexibility and or ability to interface with other hardware.<br /><br />Using a tool called <a href="http://nodered.org/">Node-Red</a> the emonPi can become a central hub for home automation, control and notification. Node-RED is a tool for wiring together hardware devices, APIs and online services in new and interesting ways. At the heart of Node-RED is a visual editor allowing complex data flows to be wired together with only a little coding skills.  Here are some of my ideas of things I might like to achieve with Node-RED, For more inspiration check out <a href="http://www.youtube.com/watch?v=KPnwyTgZaS0&amp;t=29m18s">Martin’s IoT Google hangout 29min in</a>:<br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-dLsVZfkrCk8/Vm2c8jR7OVI/AAAAAAABksA/oPCn7WCPE9U/s1600/node-red.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="http://4.bp.blogspot.com/-dLsVZfkrCk8/Vm2c8jR7OVI/AAAAAAABksA/oPCn7WCPE9U/s200/node-red.png" width="200" /></a>&lt;/div&gt;<br />&lt;ul&gt;&lt;li&gt;Send power consumption notifications to my phone using <a href="http://flows.nodered.org/node/node-red-node-pushover">Node-RED and Pushover</a>&lt;/li&gt;&lt;li&gt;Send a notification to my phone when it’s a good time to use power e.g <a href="https://gist.github.com/dceejay/6572686">national power demand </a>is low and grid renewable generation input is high&lt;/li&gt;&lt;li&gt;Use an emonTH as a room thermostat temperature input to control my heating using <a href="http://shop.openenergymonitor.com/three-channel-wifi-relay-thermostat/">WiFi MQTT relay board</a> (blog post coming soon… :-) )&lt;/li&gt;&lt;li&gt;Switch my heating on when I arrive home using <a href="https://harizanov.com/2015/03/making-ifttt-if-this-then-that-talk-to-node-red/">node-RED and IFTT</a> Android / iOS location &lt;/li&gt;&lt;li&gt;Post energy data to another service e.g. thingspeak.com, pvoutput.org, xively.com etc..&lt;/li&gt;&lt;li&gt;Use <a href="http://flows.nodered.org/node/node-red-node-emoncms">node-RED to post data from other services to Emoncms</a> e.g <a href="https://gist.github.com/dceejay/6572686">national power demand</a>, home weather station, <a href="http://flows.nodered.org/node/node-red-node-openweathermap">weather forecast</a>  &lt;/li&gt;&lt;li&gt;Periodically tweet my home power consumption or solar PV output&lt;/li&gt;&lt;li&gt;Set an email when you emonTH batteries run low (see example below)&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;<b>Install Node-RED on emonPi / emonHub / Raspberry Pi </b>&lt;/h3&gt;Make emonPi file-system RW:<br /><i>$ rpi-rw</i><br /><br />Install Node-RED (taken from <a href="http://nodered.org/docs/hardware/raspberrypi.html">node-RED RaspberryPi install guide</a>):<br /><i>$ curl -sL https://deb.nodesource.com/setup_0.12 | sudo bash - </i><br /><i>$ sudo apt-get install -y build-essential python-dev python-rpi.gpio nodejs</i><br /><i>$ sudo npm install -g –unsafe-perm node-red</i><br /><i><br /></i>Open up port 1880 so we can access Node-RED editor:<br /><i>$ sudo iptables -A INPUT -p tcp -m tcp –dport 1880 -j ACCEPT</i><br /><i><br /></i>Open up port 1883 so we can access MQTT server:<br /><i>$ sudo iptables -A INPUT -p tcp -m tcp –dport 1883 -j ACCEPT</i><br /><i><br /></i>Make iptables rules persistent<br />$ apt-get install iptables-persistent<br /><br />Choose yes to save rules, if needed edit the persistent rules:<br />$ sudo nano /etc/iptables/rules.v4<br /><br /><i><br /></i>Start Node-RED with:<br /><i>$ node-red-pi –max-old-space-size=128</i><br /><br />To view the node-RED graphical editor browse to:<br /><a href="http://emonpi:1880/">http://emonpi:1880/</a> (or use IP address if this does not work)<br /><br />To use Node-RED as a permanent setup you will want to <a href="https://gist.github.com/bigmonkeyboy/9962293">set it up as a service to autostart at boot</a> and e<a href="http://nodered.org/docs/security.html">nable secure authentication access to node-RED editor</a>.<br /><br />When you are done don’t forget to put the emonPi back to read-only mode to preserve SD card lifespan:<br /><i>$ rpi-ro</i><br />&lt;div&gt;<br />&lt;/div&gt;&lt;h3&gt;<b>Getting data from the emonPi into Node-RED</b>&lt;/h3&gt;There are two options to get our energy data into Node-RED:<br /><br /><b>1. Real-time data from emonHub using MQTT (see example below):</b><br /><br /><a href="http://mqtt.org/">MQTT</a> is a lightweight communication protocol for small web-connected devices. The latest version of emonHub as setup on the emonPi (and emonHub from July 15) uses MQTT as a link to Emoncms and also to provide data to the emonPi LCD script. Since MQTT is already running all we need to do is to point Node-RED MQTT input block to subscribe to the <i>‘emonhub/rx/#</i>’ MQTT topic on port 1883. The ‘#’ topic includes data received from all nodes. To subscribe to just one node use e.g. emonPi use: <i>‘emonhub/5/values’ </i>or ‘<i>emonhub/10/values’</i> for emonTx.<br /><br />To subscribe the the emonPi’s MQTT topics externally (if your running node-RED on another machine) you will need to open up the MQTT port on the emonPi:<br /><br /><i>$ sudo iptables -A INPUT -p tcp -m tcp –dport 1883 -j ACCEPT</i><br /><br /><b>2. Historic data from Emoncms using HTTP API: </b><br /><br />To pull historic data already logged to Emoncms (e.g KWh data) into Node-RED we can use Emoncms’s API. Here is a simple example to pull in the latest value from the KWh feed, just enter your RW API key and feed ID:<br /><br /><a href="http://emoncms.org/feed/value.json&amp;apikey=APIKEY&amp;id=FEED_ID">http://emoncms.org/feed/value.json&amp;apikey=APIKEY&amp;id=FEED_ID</a><br /><br />To view all Emoncms API see: <a href="http://emoncms.org/input/api">http://emoncms.org/input/api</a><br /><br />&lt;h3&gt;<b>Node-RED example: send warning email when emonTH battery is low</b>&lt;/h3&gt;<b><br /></b>Simple but useful example, use Node-RED connecting to emonPi in real-time data via MQTT (localhost) and sending email (via Gmail SMTP) if emonTH battery drops below 1.7V. Also in this flow as an example is a node to decode emonPi power data. <br /><br />&lt;div class="separator" style="clear: both; text-align: center;"&gt;&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-gfgkoEkv-HY/VhuGvzIzqOI/AAAAAAABg6Q/BUKxbYx6IG0/s1600/Screenshot%2B2015-10-12%2Bat%2B11.05.39.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="204" src="http://4.bp.blogspot.com/-gfgkoEkv-HY/VhuGvzIzqOI/AAAAAAABg6Q/BUKxbYx6IG0/s640/Screenshot%2B2015-10-12%2Bat%2B11.05.39.png" width="640" /></a>&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;&lt;div class="separator" style="clear: both; text-align: left;"&gt;Here is the contents of each node: &lt;/div&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-QdCMAYzfeZw/VhuGuzSG1fI/AAAAAAABg6M/b0b31YoUcPA/s1600/Node%2BRED%2B%2B%2Bemonpi.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="179" src="http://4.bp.blogspot.com/-QdCMAYzfeZw/VhuGuzSG1fI/AAAAAAABg6M/b0b31YoUcPA/s320/Node%2BRED%2B%2B%2Bemonpi.png" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;MQTT Node subscribing to emonhub mqtt topic on localhost (running node-RED on emonPi)&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-ANX-AiX1Vg0/VhuGvI8h5wI/AAAAAAABg6U/wNu2U69oiwU/s1600/Node%2BRED%2B%2B%2Bemonpi1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="293" src="http://4.bp.blogspot.com/-ANX-AiX1Vg0/VhuGvI8h5wI/AAAAAAABg6U/wNu2U69oiwU/s320/Node%2BRED%2B%2B%2Bemonpi1.png" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Separate node to split the MQTT data up into nodes based on ID: e.g emonTx = 10, emonPi = 5, emonTH = 19&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-wM8zp4WGrCk/VhuGvBsYP1I/AAAAAAABg6g/KJAxe8zI53M/s1600/Node%2BRED%2B%2B%2Bemonpi2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="375" src="http://4.bp.blogspot.com/-wM8zp4WGrCk/VhuGvBsYP1I/AAAAAAABg6g/KJAxe8zI53M/s400/Node%2BRED%2B%2B%2Bemonpi2.png" width="400" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;CSV node to split up MQTT CSV string&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-NemcPlwD1Ws/VhuGvVuEs6I/AAAAAAABg6Y/XkUBKmteqrE/s1600/Node%2BRED%2B%2B%2Bemonpi3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-NemcPlwD1Ws/VhuGvVuEs6I/AAAAAAABg6Y/XkUBKmteqrE/s400/Node%2BRED%2B%2B%2Bemonpi3.png" width="361" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;If function node&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://2.bp.blogspot.com/-1mzPm3DVvVU/VhuGvi-MFlI/AAAAAAABg6c/KCFuKqCADrE/s1600/Node%2BRED%2B%2B%2Bemonpi4.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="278" src="http://2.bp.blogspot.com/-1mzPm3DVvVU/VhuGvi-MFlI/AAAAAAABg6c/KCFuKqCADrE/s320/Node%2BRED%2B%2B%2Bemonpi4.png" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;email node, enter your Gmail (or otherwise) SMTP login&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div class="separator" style="clear: both; text-align: center;"&gt;<br />&lt;/div&gt;Node-RED flow export, import by copy and pasting into import&gt;clipboard in Node-RED editor:<br /><br /><i><span style="font-size: xx-small;">[{“id”:”eb57a13e.14a86”,”type”:”mqtt-broker”,”broker”:”localhost”,”port”:”1883”,”clientid”:””},{“id”:”44c7eefa.bb381”,”type”:”mqtt in”,”name”:”MQTT: emonhub/rx/#”,”topic”:”emonhub/rx/#”,”broker”:”eb57a13e.14a86”,”x”:159,”y”:386,”z”:”fa6ca080.05936”,”wires”:[[“2c7fcc53.d38034”,”eb7e04d9.1481f8”]]},{“id”:”2c7fcc53.d38034”,”type”:”debug”,”name”:”RAW MQTT output: emonhub/rx/#”,”active”:false,”console”:”false”,”complete”:”topic”,”x”:242,”y”:461,”z”:”fa6ca080.05936”,”wires”:[]},{“id”:”eb7e04d9.1481f8”,”type”:”switch”,”name”:”Seperate Nodes”,”property”:”topic”,”rules”:[{“t”:”cont”,”v”:”5”},{“t”:”cont”,”v”:”19”},{“t”:”cont”,”v”:”20”}],”checkall”:”true”,”outputs”:3,”x”:343,”y”:317,”z”:”fa6ca080.05936”,”wires”:[[“b0618044.4f9e8”],[“9077dea0.6f882”],[]]},{“id”:”9077dea0.6f882”,”type”:”csv”,”name”:”emonTH 1: emonhub/19/values &gt; Decode MQTT CSV”,”sep”:”,”,”hdrin”:””,”hdrout”:””,”multi”:”one”,”ret”:”\n”,”temp”:”temp,temp_external,humidity,battery,pulsecount”,”x”:664,”y”:373,”z”:”fa6ca080.05936”,”wires”:[[“75ee731f.8a118c”]]},{“id”:”b0618044.4f9e8”,”type”:”csv”,”name”:”emonPi: emonhub/5/values &gt; Decode MQTT CSV”,”sep”:”,”,”hdrin”:””,”hdrout”:””,”multi”:”one”,”ret”:”\n”,”temp”:”power1,power2,power1_plus_2,Vrms,temp1,temp2,temp3,temp4,temp5,temp6,pulseCount”,”x”:647,”y”:236,”z”:”fa6ca080.05936”,”wires”:[[“cda897fa.325768”]]},{“id”:”cda897fa.325768”,”type”:”debug”,”name”:”Debug: emonPi Power1 output”,”active”:false,”console”:”false”,”complete”:”payload.power1”,”x”:1015,”y”:235,”z”:”fa6ca080.05936”,”wires”:[]},{“id”:”75ee731f.8a118c”,”type”:”function”,”name”:”If emonTH battery &lt; 1.7V”,”func”:”if (msg.payload.battery &lt; 1.7) {\n   return {payload:’WARNING: emonTH battery low  ‘+msg.payload.battery+’V’  };\n}”,”outputs”:1,”noerr”:0,”x”:1015,”y”:363,”z”:”fa6ca080.05936”,”wires”:[[“f8d8fd72.0727”]]},{“id”:”f8d8fd72.0727”,”type”:”delay”,”name”:”Limit 1 email per day”,”pauseType”:”rate”,”timeout”:”5”,”timeoutUnits”:”seconds”,”rate”:”1”,”rateUnits”:”day”,”randomFirst”:”1”,”randomLast”:”5”,”randomUnits”:”seconds”,”drop”:true,”x”:948,”y”:447,”z”:”fa6ca080.05936”,”wires”:[[“1d4154b2.e2beab”]]},{“id”:”1d4154b2.e2beab”,”type”:”e-mail”,”server”:”smtp.gmail.com”,”port”:”465”,”name”:””,”dname”:”Send warning email”,”x”:1198,”y”:439,”z”:”fa6ca080.05936”,”wires”:[]}]</span></i></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using emonPi Offline: How to setup a WIFI Hotspot on an emonPi]]></title>
    <link href="http://blog.openenergymonitor.org/2015/09/how-to-setup-wifi-hotspot-on-emonpi/"/>
    <updated>2015-09-09T16:58:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2015/09/how-to-setup-wifi-hotspot-on-emonpi</id>
    <content type="html"><![CDATA[<p>This guide details how to setup a WIFI Hotspot using the Edimax USB WIFI adapter on an EmonPi or EmonBase to make it possible to connect directly to an EmonPi from a tablet or computer without the need for a router or internet connection.<br /><br />The guide is based on <a href="http://www.daveconroy.com/turn-your-raspberry-pi-into-a-wifi-hotspot-with-edimax-nano-usb-ew-7811un-rtl8188cus-chipset">Dave Conroy’s guide</a> here but also covers setting up a DHCP server rather than ethernet to WIFI bridge.<br /><br />There are 3 pieces of software that need to be installed to get this to work:<br />&lt;ul&gt;&lt;li&gt;hostapd – WIFI Hotspot&lt;/li&gt;&lt;li&gt;edimax version of hostapd&lt;/li&gt;&lt;li&gt;isc-dhcp-server – DHCP Server&lt;/li&gt;&lt;/ul&gt;<b>1) Install dhcp server </b><br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo apt-get install isc-dhcp-server </span><br /><br /><b>2) Install Edimax version of hostapd</b><br /><br />Either use precompiled binary or compile yourself:<br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><b>Pre-compiled (update: does not seem to work with </b></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><b>wheezy, use self compile see below)</b></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wget http://www.daveconroy.com/wp3/wp-content/uploads/2013/07/hostapd.zip</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>unzip hostapd.zip <br />sudo mv /usr/sbin/hostapd /usr/sbin/hostapd.bak<br />sudo mv hostapd /usr/sbin/hostapd.edimax <br />sudo ln -sf /usr/sbin/hostapd.edimax /usr/sbin/hostapd <br />sudo chown root.root /usr/sbin/hostapd <br />sudo chmod 755 /usr/sbin/hostapd</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><b>Compile yourself (recommended for wheezy, tested March16)</b></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><i style="font-family: 'courier new', courier, monospace; font-size: small;">sudo apt-get install libnl-genl-3-dev libnl-3-dev</i><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>git clone https://github.com/lostincynicism/hostapd-rtl8188</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>cd hostapd-rtl8188/hostapd</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>sudo make</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>sudo make install </i></span><br /><br /><b>3) Configure /etc/network/interfaces</b><br /><br />Open the network interfaces file to edit:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">sudo nano /etc/network/interfaces </span><br /><br />Replace content with:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">auto lo</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">iface lo inet loopback</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">auto eth0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">allow-hotplug eth0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">iface eth0 inet manual</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">#allow-hotplug wlan0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">#iface wlan0 inet manual</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">#    wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">iface wlan0 inet static</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">address 192.168.42.1</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">netmask 255.255.255.0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">allow-hotplug eth1</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">iface eth1 inet dhcp</span><br /><br />If required add bridge to bridge eth0 to wlan0 - although it’s better to use NAT iptables forwarding since then we can still access pi via ssh (see below)<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">auto br0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">iface br0 inet dhcp</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">bridge_ports eth0 wlan0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">pre-up ifconfig eth0 0.0.0.0 up</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">pre-up ifconfig wlan0 0.0.0.0 up</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">pre-up brctl addbr br0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">pre-up brctl addif br0 eth0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">post-down ifconfig wlan0 0.0.0.0 down</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">post-down ifconfig eth0 0.0.0.0 down</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">post-down brctl delif br0 eth0</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">post-down brctl delbr br0</span><br /><br /><b>4) Configure /etc/hostapd/hostapd.conf</b><br />Open hostapd config file with:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">sudo nano /etc/hostapd/hostapd.conf</span><br /><br />Add the following lines to hostapd.conf (set SSID and password of your choice)<br /><b><br /></b><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><b>WITHOUT AUTHENTICATION  USE</b></i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><b><br /></b></i></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>interface=wlan0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>ssid=emonPi</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>driver=rtl871xdrv</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>hw_mode=g</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>channel=6</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>auth_algs=1</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wmm_enabled=0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><b><br /></b></i></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><b>WITH_AUTENTICATION USE</b></i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><b><br /></b></i></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>interface=wlan0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>driver=rtl871xdrv</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>ssid=emonPi</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>hw_mode=g</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>channel=6</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>macaddr_acl=0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wmm_enabled=0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>auth_algs=1</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>ignore_broadcast_ssid=0</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wpa=2</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wpa_passphrase=raspberry</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wpa_key_mgmt=WPA-PSK</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>wpa_pairwise=TKIP</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>rsn_pairwise=CCMP</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"></span><br /><br />Manual start to test everything is working, you should see a Wifi network called ‘emonPi’:<br /><br /><i>$ sudo hostapd -dd /etc/hostapd/hostapd.conf</i><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><br /><br /><br /><b>5) Configure /etc/default/hostapd</b><br /><b><br /></b><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">sudo nano /etc/default/hostapd</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"></span><br />Set<br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">DAEMON_CONF=”/etc/hostapd/hostapd.conf”</span><br /><br /><br /><b>6) Configure /etc/dhcp/dhcpd.conf</b><br />Open dhcpd config file:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">sudo nano /etc/dhcp/dhcpd.conf</span><br /><span style="font-size: x-small;"><br /></span><span style="font-size: x-small;">Add the following to the end of the file:</span><br /><span style="font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">lease-file-name “/home/pi/data/dhcpd.leases”;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">subnet 192.168.42.0 netmask 255.255.255.0 {</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        range 192.168.42.2 192.168.42.20;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        option broadcast-address 192.168.42.255;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        option routers 192.168.42.1;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        default-lease-time 600;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        max-lease-time 7200;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        option domain-name “local”;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">        option domain-name-servers 8.8.8.8, 8.8.4.4;</span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">}</span><br /><br />comment out <span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>#option domain-name “example.org”;</i></span><br /><i><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"></span></i><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>#option domain-name-servers ns1.example.org, ns2.example.org;</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i><br /></i></span>uncomment<br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">authoritative;</span><br /><br /><b>7) Configure /etc/default/isc-dhcp-server</b><br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;">sudo nano /etc/default/isc-dhcp-server </span><br /><br />Remove the comment from DHCPD_CONF, DHCPD_PID and then set the INTERFACES to “wlan0” (including “”), see example below:<br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"># Defaults for isc-dhcp-server initscript <br /># sourced by /etc/init.d/isc-dhcp-server <br /># installed at /etc/default/isc-dhcp-server by the maintainer scripts <br /># <br /># This is a POSIX shell fragment <br /># <br /><br /># Path to dhcpd’s config file (default: /etc/dhcp/dhcpd.conf). <br />DHCPD_CONF=/etc/dhcp/dhcpd.conf <br /><br /># Path to dhcpd’s PID file (default: /var/run/dhcpd.pid). <br />DHCPD_PID=/var/run/dhcpd.pid <br /><br /># Additional options to start dhcpd with. <br />#       Don’t use options -cf or -pf here; use DHCPD_CONF/ DHCPD_PID instead <br />#OPTIONS=”” <br /><br /># On what interfaces should the DHCP server (dhcpd) serve DHCP requests? <br />#       Separate multiple interfaces with spaces, e.g. “eth0 eth1”. <br />INTERFACES=”<b>wlan0</b>”</span><a href="http://askubuntu.com/questions/140126/how-do-i-configure-a-dhcp-server"></a><br /><b><br /></b><b><br /></b><b>8.) Setup NAT forwarding to bridge eth0 the wlan0 while still allowing us to access the Pi via SSH (pure network bridge does not)</b><br /><br />To set this up automatically on boot, edit the file /etc/sysctl.conf and add the following line to the bottom of the file:<br /><br /><i>net.ipv4.ip_forward=1</i><br /><br />Second, to enable NAT in the kernel, run the following commands:<br /><br /><i>sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</i><br />&lt;div&gt;<i>sudo iptables -A FORWARD -i eth0 -o wlan0 -m state –state RELATED,ESTABLISHED -j ACCEPT</i>&lt;/div&gt;<i></i>&lt;div&gt;<i>sudo iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT</i>&lt;/div&gt;<i>&lt;div&gt;<br />&lt;/div&gt;</i><br />&lt;div&gt;<b><i>If bride is also required to eth1 (for 3G dongle) add:</i></b><br /><i>sudo iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE</i>&lt;/div&gt;&lt;div&gt;<i>sudo iptables -A FORWARD -i eth1 -o wlan0 -m state –state RELATED,ESTABLISHED -j ACCEPT<br />sudo iptables -A FORWARD -i wlan0 -o eth1 -j ACCEPT</i><br /><br /><br /><br />sudo sh -c “iptables-save &gt; /etc/iptables.ipv4.nat”<br /><br />Now edit the file /etc/network/interfaces and add the following line to the bottom of the file:<br /><br />up iptables-restore &lt; /etc/iptables.ipv4.nat # This did not work for me I had to add entry to rc.local (see below)<br /><br /><b>8) Edit /etc/rc.local</b><br /><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;">sudo nano /etc/rc.local </span><br /><br />Add before exit 0 the following lines to tell the wlan interface to use ip address 10.0.1.1 and then start the isc-dhcp-server:<br /><br /><i>sudo iptables-restore &lt; /etc/iptables.ipv4.nat</i><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>sudo ifconfig wlan0 192.168.42.1</i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i></i></span><br /><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><i>sudo service isc-dhcp-server restart</i></span><br />&lt;pre style="-webkit-user-select: text; position: absolute; top: -99px;"&gt;sudo iptables-restore &lt; /etc/iptables.ipv4.nat&lt;/pre&gt;<span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace;"><span style="font-family: &quot;courier new&quot; , &quot;courier&quot; , monospace; font-size: x-small;"><br /></span></span><br /><b><br />9) Start services at boot </b><br /><br /><i>sudo update-rc.d isc-dhcp-server defaults<br />sudo update-rc.d hostapd defaults</i><br /><br /><br />Thats it restart your emonpi/emonbase to finish and then connect to network emonPi with password: raspberry <br /><br /><b>11) Add a Real Time Clock (RTC)</b><br />When running an emonPi in offline mode we recommend adding a hardware RTC to ensure the system time is always correct. See <a href="http://wiki.openenergymonitor.org/index.php?title=EmonPi#Adding_a_Real_Time_Clock_.28RTC.29">emonPi Wiki:</a><br /><br /><b><br /></b><br />&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://wiki.openenergymonitor.org/images/EmonPi_RTC.JPG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://wiki.openenergymonitor.org/images/EmonPi_RTC.JPG" height="191" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Hardware RTC&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;<b><br /></b><b><br /></b><b><br /></b><b><br /></b><b><br /></b><b>Resources </b><br />Useful blogs, guides and forum threads that I used to work out how to set up the above:<br /><a href="http://www.daveconroy.com/turn-your-raspberry-pi-into-a-wifi-hotspot-with-edimax-nano-usb-ew-7811un-rtl8188cus-chipset">http://www.daveconroy.com/turn-your-raspberry-pi-into-a-wifi-hotspot-with-edimax-nano-usb-ew-7811un-rtl8188cus-chipset</a><br /><a href="http://askubuntu.com/questions/140126/how-do-i-configure-a-dhcp-server">http://askubuntu.com/questions/140126/how-do-i-configure-a-dhcp-server</a><br /><a href="http://ubuntuforums.org/showthread.php?t=2068111">http://ubuntuforums.org/showthread.php?t=2068111</a><br /><a href="http://raspberrypi.stackexchange.com/questions/9678/static-ip-failing-for-wlan0">http://raspberrypi.stackexchange.com/questions/9678/static-ip-failing-for-wlan0</a><br /><a href="https://forums.opensuse.org/showthread.php/438756-DHCP-can-t-write-to-dhcpd-leases">https://forums.opensuse.org/showthread.php/438756-DHCP-can-t-write-to-dhcpd-leases</a><br /><a href="http://elinux.org/RPI-Wireless-Hotspot">http://elinux.org/RPI-Wireless-Hotspot</a><br /><a href="http://askubuntu.com/questions/140126/how-do-i-configure-a-dhcp-server">http://askubuntu.com/questions/140126/how-do-i-configure-a-dhcp-server</a><br />http://www.instructables.com/id/Raspberry-Pi-as-a-3g-Huawei-E303-wireless-Edima/?ALLSTEPS<br /><br /><br />&lt;/div&gt;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[At Watt Cost? A review of the emonPi Raspberry Pi based energy monitor]]></title>
    <link href="http://blog.openenergymonitor.org/2015/09/at-watt-cost-review-of-emonpi-raspberry/"/>
    <updated>2015-09-04T15:10:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2015/09/at-watt-cost-review-of-emonpi-raspberry</id>
    <content type="html"><![CDATA[<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 18.666666666666664px; font-style: normal; font-variant: normal; font-weight: 700; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">At Watt Cost ?</span></div>
<h3 style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.6667px; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><i>A review of the emonPi, a Raspberry Pi based energy monitoring system developed by OpenEnergyMonitor, by <a href="https://twitter.com/irlionel">Lionel Smith</a> : </i></span></h3>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><br /></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><i><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.6667px; font-variant: normal; font-weight: 700; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Measurement is the first step that leads to control and eventually to improvement</span><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.6667px; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">. If you can’t measure something, you can’t understand it. If you can’t understand it, you can’t control it. If you can’t control it, you can’t improve it.” </span></i><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><br class="kix-line-break" /></span><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">― H. James Harrington</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><img alt="emoncms_solarPV_laptop_mobile.png" height="335px;" src="https://lh4.googleusercontent.com/FSDua1EX8hwKoqYpyipDLNH-c9JjigVa5wmOBUH8XwV0xqRBNCk5M4C0DhrYIxBcrvP0ENLcnKr-Ps4voKdXI_QM_MKFkDwz4NSBWv3V_VzLe5XtS0U14VkJx4J0Q3zL6kSiCJw" style="border: none; transform: rotate(0rad);" width="602px;" /></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Do we know how much electricity can be saved by using low energy lighting such as LED's or how much electricity is saved by turning off lighting when not in use?</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Finding out how much electricity is being used by one or all of your appliances, is the first step in being able to cut down on consumption, and in doing so spend less on electricity. It goes without saying that reducing your consumption equates to doing your bit towards creating a sustainable world. </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Glyn Hudson, Trystan Lea and the rest of the team at </span><a href="http://openenergymonitor.org/" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">OpenEnergyMonitor.org</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> have developed some monitoring technology to help us understand and optimise our energy consumption and generation. This allows us to approach the problem of energy consumption in a logical and informed way.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The Raspberry Pi isn't great at measuring analogue voltages, so various Arduino based measurement boards have been developed which process and digitise the inputs and transfer them to the Pi. </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">In early 2014 an idea was born to create a shield which plugged directly onto a Raspberry Pi to make a single unit energy monitoring solution, primarily aimed at domestic users. A whole bunch of discussions and a fair amount of blood, sweat and tears culminated in a </span><a href="https://www.kickstarter.com/projects/openenergymonitor/emonpi-open-hardware-raspberry-pi-based-energy-mon" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">Kickstarter campaign</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> which raised £24,723 to help bring the project to life</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">This piece of kit is dubbed the emonPi, which is a Raspberry Pi based, open-source, web-connected, energy &amp; environmental monitor. This unit gives you the ability to measure home energy, solar PV, heatpump generation and temperature.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><img alt="emonPi_MyElectric_Daffs.JPG" height="452px;" src="https://lh5.googleusercontent.com/eiPQWuAtp9R9R8VOjaSv2TPwYXRj2D9vtDQUJl2p7qYykBRrpGLpn4PKgt3riBqPC-SAFr1Kwt-8rnaD8W_M1lDoVEys_urRtx3dYhaFKrb1YtpqTb8usAUM1pdNtNCnDO4Yg9Fk" style="border: none; transform: rotate(0rad);" width="602px;" /></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Everything on the site is fully open-source, which means you are free to tinker and improve to suit your needs. There is a very active community so help is readily available.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Aside from the obvious current and voltage values, temperature and humidity can also be measured by adding the appropriate nodes. All this information is then formatted on the Pi and either stored locally or uploaded via an Internet connection to a hosted application called EmonCMS. </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Once you've built up some data, various visualisations can be applied to create some really informative graphs. </span><br /><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><br /></span><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-5Zvy6qVObaM/VemzJ06LFOI/AAAAAAABdWY/EIVz8qafdio/s1600/emoncms_dashboards.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="297" src="http://4.bp.blogspot.com/-5Zvy6qVObaM/VemzJ06LFOI/AAAAAAABdWY/EIVz8qafdio/s640/emoncms_dashboards.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Emoncms MyElectric and SolarPV Dashboards</td></tr></tbody></table></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 700; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The emonPi is available in both kit form or as a complete unit. Complete units are housed in a professional looking case sourced from Lincoln Binns. Even if you can’t resist the urge to experiment and order your system in kit form, it is highly recommended that you order the aluminium case to house the finished unit in. Aside from protecting everything inside, the case really gives the unit a polished, professional look.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Inside the case you will find a standard Raspberry Pi 2, the GPIO serial connected Arduino measurement shield and an I2C connected 2 x 16-character display.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><img alt="Emonpibare (1).png" height="322" src="https://lh5.googleusercontent.com/yA_duDSWg-ocGt9Rolim0p7rdi5sMTZtLtR6WX_jc62IiRBvw2r1yfZ8sFPvUYl--9tP0ImpYc2HgNl9K-_34HeQJ4qCm6O8aabOZUwlKCvKasCE55HGIjn8MpJ7n0GDQm1Kym-ZJns7EyO7" style="-webkit-transform: rotate(0.00rad); border: none; transform: rotate(0.00rad);" width="400" /></span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The unit contains built in 433Mhz low power RF which is used for communicating with its external nodes. These nodes can be used to add additional power readings (emonTx) or remote temperature and humidity (emonTH) . </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Fire up the system with a LAN cable plugged in and the on board display conveniently displays its IP address. Punch that into your favourite browser ( on a PC in the same LAN ) and you get to the login page. Once logged in, you are able to setup the WiFi if you have added an external USB WiFi adapter.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The built in 16 x 2 display will also confirm the status of connected devices. In order to measure temperature, an optional DS18B20 temperature sensor needs to be connected. The emonPi can talk to multiple (up to 6) of these sensors as they are individually addressable. </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Power can be measured using a clip-on CT current sensor and a 9VAC reference supply. You can cheat and omit the 9VAC supply input resulting in the AC voltage being fixed in the software, but then you are not reading true Real Power or Power Factor, so this is not recommended. If measuring solar PV two clip-on CT sensors are required and the 9VAC voltage input is essential as it's required to tell the unit if you generating or consuming power. The second CT can be used to isolate a particular load and see how much that draws. As an example CT 1 could be measuring the total of your house while CT 2 could tell you how much just your water heater or stove uses.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Another method to measure power is to use an optical pulse counter sensor that picks up the LED flashes generated by most modern electricity and gas meters.</span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Being able to visualise the power used by your appliances gives a whole new insight into the power needed to run them. The author used the system to evaluate the claims made by the supplier of a hot water boiler control unit that only allows the boiler to heat the water 3 times a day based on your predicted usage. Using the emonPi and Emoncms system it was easy to see exactly how much saving was achieved after installing the control unit. </span></div>
<div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">The emonPi is a fantastic piece of kit and well worth having if you would like to contribute towards a greener future.</span></div>
<p><b style="font-weight: normal;"><br /></b><br />&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Weblinks for more information:</span>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Home Page –<a href="https://www.blogger.com/goog_615289264"><span id="goog_615289265"></span> </a></span><a href="https://www.blogger.com/"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://openenergymonitor.org/</span><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> <span id="goog_615289266"></span></span></a>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">emonPi User Guide - </span><a href="http://openenergymonitor.org/emon/modules/emonpi" style="text-decoration: none;"><span style="background-color: transparent; color: #1155cc; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: underline; vertical-align: baseline; white-space: pre-wrap;">http://openenergymonitor.org/emon/modules/emonpi</span></a>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Wiki - </span><a href="http://wiki.openenergymonitor.org/" style="text-decoration: none;"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://wiki.openenergymonitor.org</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> </span>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Shop - </span><a href="http://shop.openenergymonitor.com/" style="text-decoration: none;"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://shop.openenergymonitor.com/</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> </span>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">User Forum - </span><a href="http://openenergymonitor.org/emon/forum" style="text-decoration: none;"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://openenergymonitor.org/emon/forum</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> </span>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Blog - </span><a href="http://openenergymonitor.blogspot.com/" style="text-decoration: none;"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://openenergymonitor.blogspot.com/</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> </span>&lt;/div&gt;&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">Emoncms - </span><a href="http://emoncms.org/" style="text-decoration: none;"><span style="background-color: transparent; color: #666600; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;">http://emoncms.org</span></a><span style="background-color: transparent; color: black; font-family: Calibri; font-size: 14.666666666666666px; font-style: normal; font-variant: normal; font-weight: 400; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"> </span>&lt;/div&gt;<b style="font-weight: normal;"><br /></b><br />&lt;div dir="ltr" style="line-height: 1.295; margin-bottom: 8pt; margin-top: 0pt;"&gt;<span style="background-color: transparent; color: red; font-family: Calibri; font-size: 14.6667px; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;"><b>Safety Warning: Interfacing with mains voltages can be potentially lethal. If you are not competent, or not sure of what you are doing rather seek the assistance of a qualified professional.</b></span>&lt;/div&gt;<br /></p>
]]></content>
  </entry>
  
</feed>
