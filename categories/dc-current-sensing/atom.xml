<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: DC current sensing | Blog | OpenEnergyMonitor]]></title>
  <link href="http://blog.openenergymonitor.org/categories/dc-current-sensing/atom.xml" rel="self"/>
  <link href="http://blog.openenergymonitor.org/"/>
  <updated>2016-04-25T15:56:13+00:00</updated>
  <id>http://blog.openenergymonitor.org/</id>
  <author>
    <name><![CDATA[Glyn Hudson]]></name>
    <email><![CDATA[support@openenergymonitor.zendesk.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[3 Phases AC monitoring]]></title>
    <link href="http://blog.openenergymonitor.org/2012/02/if-you-are-active-member-of/"/>
    <updated>2012-02-13T11:49:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2012/02/if-you-are-active-member-of</id>
    <content type="html"><![CDATA[<div dir="ltr" style="text-align: left;" trbidi="on">Note: this topic is still in development, there is an on-going discussion on the forum:&nbsp;<a href="http://openenergymonitor.org/emon/node/431">http://openenergymonitor.org/emon/node/431</a><br /><br />If you are an active member of OpenEnergyMonitor.org, then you know for sure that one of the challenges the project is facing is monitoring tri-phase AC systems (220V-400V).<br /><div>In theory it is as simple and easy as monitoring three one-phase systems with one voltage sensor per voltage phase, but in real life, it is not as easy as that.</div><div>Most of the time, plugs of the different phases are far from each others, and often there are no plugs for one or more phases (if it's for a special purpose like a night water heater). So this implies cabling one plug for each of the three phases in the cabinet and using 3 voltage sensors.</div><div><br /></div><div>This would hit one of the most important&nbsp;features of OpenEnergyMonitor: non-invasiveness.&nbsp;It would imply significantly more cabling and electrical work, this would also mean higher costs.</div><div><br /></div><div>I happen to know enough about principles of electrical power to be convinced that we can use one voltage sensor and three current sensors to monitor three-phases systems. Here is the theory:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-QxOn2-0s1_8/Tzjt2UEskxI/AAAAAAAAAQw/FeAWyFnM0nY/s1600/acp50.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-QxOn2-0s1_8/Tzjt2UEskxI/AAAAAAAAAQw/FeAWyFnM0nY/s1600/acp50.gif" /></a></div><div class="separator" style="clear: both; text-align: center;"><i><span style="font-size: xx-small;">Source:&nbsp;http://www.electronics-tutorials.ws/</span></i></div><div class="separator" style="clear: both; text-align: left;">The three voltage vectors are <b>always</b> shifted by 120°. What changes is the angle between a certain phase voltage and current vectors (a change caused by the properties of your load, but that's another story). So if the angle between two voltage vectors is always the same, then the phase shift of a current vector to the another phase voltage vector is exactly the phase shift of that current vector to its voltage vector + 120°.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b>Example from the figure above:</b></div><div class="separator" style="clear: both; text-align: left;">Phaseshift of red phase current and voltage= Phaseshift of red current vector and yellow voltage vector.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">So if we calculate the power factor of a current with any other voltage, we will of course get a wrong one, but we can always shift it by 120° and get the right one.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">I have a setup of what I call "See-a-Watt" (which is basically a device based on the plans and code of OpenEnergyMonitor, but that combines data acquisition ethernet connection) installed in a building on the campus of my university, with access to a three-phases installation. So I decided to test the theory there.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The approach is as follows:</div><div class="separator" style="clear: both; text-align: left;"></div><ol style="text-align: left;"><li>Sample one voltage waveform out of three</li><li>Sample three current waveforms (of each phase</li><li>Calculate the phase shift (aka. power factor) of each of the three current waveforms to the one voltage waveform.</li><li>Send Vrms1, I1,I2, I3 and the power factors relative to each phase to emonCMS</li><li>Reverse the power factors to get the "wrong" phase, then compensate it with&nbsp;120° and recalculate the "right" power factor</li><li>Calculate the "right" powers = Ix * Vrms1 *'correct PF'</li></ol><br /><div class="separator" style="clear: both; text-align: left;">With the help of Trystan (he's much better with PHP than me and he knows emonCMS like the back of his hand) we implemented a function in emonCMS that reverses the "wrong" PF to the "wrong" phase shift angle, then shift it by + or -&nbsp;120° and recalculate the PF.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">This setup is working now for more than 6 weeks without any problem and the accuracy is comparable to the traditional accuracy of the non-invasive method: 1-2% not more.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Here is the code on the device side:&nbsp;<a href="https://github.com/AminfiBerlin/See-a-Watt-3-Phases">https://github.com/AminfiBerlin/See-a-Watt-3-Phases</a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">and here is the commit on emonCMS that introduced the phaseshift function:&nbsp;<a href="https://github.com/openenergymonitor/emoncms3/commit/a41c57d457df77697540b1a89a74486951e058ee">https://github.com/openenergymonitor/emoncms3/commit/a41c57d457df77697540b1a89a74486951e058ee</a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Needless to say that this is still in beta, I did not have any problem with it so far but that doesn't mean it's perfect. Please feel free to download the code and test it in every possible way.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><i>This is my first real contribution to any OpenSource project at all, I feel so proud and happy to be able to give back as much as I can.</i></div><div class="separator" style="clear: both; text-align: left;"><i><br /></i></div><div class="separator" style="clear: both; text-align: left;"><i>By&nbsp;<span class="Apple-style-span" style="background-color: white; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;"><a href="http://openenergymonitor.org/emon/user/15">Amin Zayani</a></span></i></div><div><br /></div></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A start on DC current sensing]]></title>
    <link href="http://blog.openenergymonitor.org/2009/06/start-on-dc-current-sensing/"/>
    <updated>2009-06-22T15:08:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2009/06/start-on-dc-current-sensing</id>
    <content type="html"><![CDATA[<p>Now that both the <a href="http://www.wyfsd.org/cms/index.php?page=wind_turbine_workshop_2008&amp;lan=en">North Wales</a> and <a href="http://cardiffwind.blogspot.com/">Cardiff <span class="blsp-spelling-error" id="SPELLING_ERROR_0">EWB</span> wind turbines</a> have been built, it would be good to have some sort of laptop based graphical output of the power produced from the wind turbine when its taken up to a site for testing and so I have been looking at how to modify the <span class="blsp-spelling-error" id="SPELLING_ERROR_1">OpenEnergyMonitor</span> design to do that.<br /><br />The wind turbine creates 12V DC electricity. It can produce up to around 500W of power, about 40Amps.<br /><br />I have decided to go along the invasive current sensing route with a sense resistor (also known as a shunt). When dealing with such high currents the sense resistor needs to be quite beefy! Here’s a picture of my test setup using a computer power supply to simulate the wind turbine and a 50W halogen as a load. The large block in the middle is the <a href="http://uk.farnell.com/jsp/search/productdetail.jsp?sku=1339340&amp;_requestid=124438">sense resistor</a>.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://3.bp.blogspot.com/_Yqa3j9ZhET8/Sj-hhYQQF_I/AAAAAAAAAUw/4V1fki-YNMw/s1600-h/shunt.JPG"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 240px;" src="http://3.bp.blogspot.com/_Yqa3j9ZhET8/Sj-hhYQQF_I/AAAAAAAAAUw/4V1fki-YNMw/s320/shunt.JPG" alt="" id="BLOGGER_PHOTO_ID_5350172477157808114" border="0" /></a>I’m now on the stage of getting parts for a circuit that will allow the <span class="blsp-spelling-error" id="SPELLING_ERROR_2">Arduino</span> to read the voltage across the sense resistor.<br /><br />I came across quite a lot of good circuit examples and advice on the linear technologies website <a href="http://www.linear.com/ad/current_sense.jsp">here</a>. <span class="blsp-spelling-error" id="SPELLING_ERROR_3">Im</span> thinking of following the battery current monitor circuit which can be found in their <a href="http://www.linear.com/ad/08-dc.pdf">DC <span class="blsp-spelling-error" id="SPELLING_ERROR_4">pdf</span></a>. Here’s the schematic<span style="text-decoration: underline;">:</span><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_Yqa3j9ZhET8/Sj-kUKRgE3I/AAAAAAAAAU4/xvJ4LYcy_LI/s1600-h/circuit.png"><img style="margin: 0px auto 10px; display: block; text-align: center; cursor: pointer; width: 320px; height: 214px;" src="http://2.bp.blogspot.com/_Yqa3j9ZhET8/Sj-kUKRgE3I/AAAAAAAAAU4/xvJ4LYcy_LI/s320/circuit.png" alt="" id="BLOGGER_PHOTO_ID_5350175548601537394" border="0" /></a>It can measure both current flowing in to the battery when the wind turbine is generating and current flowing out of the battery when there are loads connected.<br /><br />I will post up the results once its built, I also need to make a load that can vary between 0 and 500W so it can be tested properly, the current plan is to make that load from a mini 12V kettle and a mixture of 50W 20W and 10W halogen bulbs all of which can be turned on and off from the <span class="blsp-spelling-error" id="SPELLING_ERROR_5">Arduino</span>. Should be fun!<br /><br />If anyone has any experience with <span class="blsp-spelling-error" id="SPELLING_ERROR_6">renewables</span> and DC current measuring circuits I would be glad of any suggestions on any of the above.</p>
]]></content>
  </entry>
  
</feed>
