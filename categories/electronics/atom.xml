<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: electronics | Blog | OpenEnergyMonitor]]></title>
  <link href="http://blog.openenergymonitor.org/categories/electronics/atom.xml" rel="self"/>
  <link href="http://blog.openenergymonitor.org/"/>
  <updated>2016-04-22T01:40:16+00:00</updated>
  <id>http://blog.openenergymonitor.org/</id>
  <author>
    <name><![CDATA[Glyn Hudson]]></name>
    <email><![CDATA[support@openenergymonitor.zendesk.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Power emonTx from single AC power supply - Part 2 bench testing ]]></title>
    <link href="http://blog.openenergymonitor.org/2013/01/power-emontx-from-single-ac-power/"/>
    <updated>2013-01-31T23:49:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2013/01/power-emontx-from-single-ac-power</id>
    <content type="html"><![CDATA[<p><br />&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;Back in May last year we did some work (with the help of Robert Wall and others) into the design of an AC-DC circuit to allow the emonTx to run off a single AC power adapter while at the same time taking accurate AC voltage samples to be used for Vrms, real power, frequency and power factor calculations. <a href="http://openenergymonitor.blogspot.co.uk/2012/05/emontx-single-ac-power-supply.html">Read the original blog post detailing how the circuit works</a>. Basicly, it’s a half wave rectifier circuit with a carefully chosen value current limiting resistor. &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;Just to recap, the challenge is powering the emonTx with 3.3V DC while not loading the AC adapter as to not effect the quality of the AC sine wave sample. An as close to perfect AC sample is desirable for best accuracy of real power readings, &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;We have finally got round to testing the circuit we simulated using LT SPICE. In summary, results are positive, the circuit works as expected!&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;Here’s what I did: the following circuit was built on a bread board, using an emonTx with the voltage regulator. The <a href="http://shop.openenergymonitor.com/ac-ac-adapter-uk-plug/">standard Ideal Power 9V AC-AC adapter</a> from the shop was used for the test.<br /><br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://4.bp.blogspot.com/-efRwc-_9iZo/UQsBx0N6oJI/AAAAAAAAdH0/ueIjVqug5Eg/s1600/2013-01-31+20.50.48.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/-efRwc-_9iZo/UQsBx0N6oJI/AAAAAAAAdH0/ueIjVqug5Eg/s320/2013-01-31+20.50.48.jpg" width="320" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Scope trace showing input to voltage regulator&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style="text-align: center;"&gt;<a href="http://1.bp.blogspot.com/-3El_MoBPMCI/T8H-QwqxftI/AAAAAAAAbn4/Zl-kBlwbQRI/s1600/Half+wave+rectifier+power+supply+labeled+diagram.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="188" src="http://1.bp.blogspot.com/-3El_MoBPMCI/T8H-QwqxftI/AAAAAAAAbn4/Zl-kBlwbQRI/s640/Half+wave+rectifier+power+supply+labeled+diagram.png" width="640" /></a>&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="tr-caption" style="text-align: center;"&gt;Half-wave rectifier circuit&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;A sketch was uploaded to the ATmega328 on the emonTx to cycle through a number of different power levels while using a scope to measure the sawtooth voltage waveform going into the MCP1702 voltage regulator. The following was recorded  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;table cellpadding="4" cellspacing="0" style="width: 100%px;"&gt; &lt;colgroup&gt;&lt;col width="51*"&gt;&lt;/col&gt; &lt;col width="51*"&gt;&lt;/col&gt; &lt;col width="51*"&gt;&lt;/col&gt; &lt;col width="51*"&gt;&lt;/col&gt; &lt;col width="51*"&gt;&lt;/col&gt; &lt;/colgroup&gt;&lt;tbody&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="20%"&gt;<b>Power State</b>&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="20%"&gt;<b>Current draw</b>&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="20%"&gt;<b>Vrms into MCP1702</b>&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: 1px solid #000000; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0.1cm;" width="20%"&gt;<b>Delta V into MCP1702</b>&lt;/td&gt;  &lt;td style="border: 1px solid #000000; padding: 0.1cm;" width="20%"&gt;<b>AC Voltage sample ripple     </b>&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;Sleep&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;25uA&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;16.4V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;0V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="20%"&gt;<br /><br />&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;ATmega328 only&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;7.7mA&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;12.7V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;2.72V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="20%"&gt;<br /><br />&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;ATmega328 + RFM12B     &lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;8.1mA&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;12.5V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;2.8V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="20%"&gt;<br /><br />&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;ATmega328 + LED&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;16.9mA&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;10.1V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;5.5V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="20%"&gt;<br /><br />&lt;/td&gt; &lt;/tr&gt;&lt;tr valign="TOP"&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;ATmega328 + LED + RFM12B&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;17.3mA&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;10V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm; padding-top: 0cm;" width="20%"&gt;5.53V&lt;/td&gt;  &lt;td style="border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 1px solid #000000; border-top: none; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm; padding-top: 0cm;" width="20%"&gt;Approx 80mV (limit of the scope)&lt;/td&gt; &lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;The voltage limited zener diode was omitted from the test setup but will be present in the main circuit to avoid over volting the MCP1702 when supply is un-loaded.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;The AC voltage sample will be taken when the emonTx is consuming 7.7mA (ATmega328 only running), the test has assured me that the circuit will be able to provide 3.3V DC without hardly any distortion to the AC waveform. There was only a 80mV ripple when drawing 17mA we can expect the ripple to be under half this when the emonTx is drawing 7.7mA.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;It’s interesting to note that the RMF12B (when idle, not sleeping) draws 0.4mA and the LED draws 9.2mA. The circuit is speed up to 20mA max so it would be possible to add one DS28B20 that will at maxim consume 2.3mA for short periods.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;AC-DC circuit will be incorporated into the next version of the emonTx. Further testing will be done on this prototype to double check everything.  &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;Roll on single power supply Real Power accurate energy monitoring. As well as being a neater setup it will also significantly reduce the carbon footprint and amount of electrical waste which will eventually go into landfill if we can enable the emonTx to only need the one plug-in power adapter. &lt;/div&gt;&lt;div style="margin-bottom: 0cm;"&gt;<br />&lt;/div&gt;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Triac based MK2 PV Controller by Calypso Rye]]></title>
    <link href="http://blog.openenergymonitor.org/2012/07/triac-based-mk2-pv-controller-by/"/>
    <updated>2012-07-16T13:42:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2012/07/triac-based-mk2-pv-controller-by</id>
    <content type="html"><![CDATA[<div class="separator" style="clear: both; text-align: center;"></div>
<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-Y8lRjQvqoZg/UAQXPSAleMI/AAAAAAAACdU/9CxAGNIB73Y/s1600/IMGP9704.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="http://3.bp.blogspot.com/-Y8lRjQvqoZg/UAQXPSAleMI/AAAAAAAACdU/9CxAGNIB73Y/s400/IMGP9704.JPG" width="400" /></a></div>
<p><br /><br /><a href="http://openenergymonitor.org/emon/user/956">Calypso Rye</a> writes:<br /><br />&lt;div style="background-color: #dddddd; font-size: 90%; padding: 10px;"&gt;Based on the standard VI sketch which uses calcVI() in EmonLib, I’ve had a system in place for the last couple of months which diverts surplus PV power to our immersion heater.  This system has proved to be both effective and reliable, and I am most grateful for everyone who has helped me along the way.  The main downside to this arrangement is that it requires an expensive item of third-party kit to distribute the power.  (I know that others have found cheaper ways, but my Carlo Gavazzi unit cost me £70).<br /><br />Other contributors to this forum have shown that a standard triac can be easily controlled by an Arduino.  By using a zero-crossing detector such as the Motorola MOC3041, it should be possible for the Arduino to allocate mains cycles directly to the load rather than delegating this task to a separate device.<br /><br />A Mk2 system of this type has been working in our garage for the last few days.  The sketch and a schematic diagram are attached, its main features being:<br /><br />- a comprehensive ‘debug’ mode which allows real world conditions to be simulated ;<br />&lt;div&gt;<br />- a continuous mode of operation, for both measurement and distribution of power;&lt;/div&gt;&lt;div&gt;<br />- an “energy bucket” concept which gives precise control of surplus power;<br /><br />- interleaved windows for measurement and generation, each only 20mS;<br /><br />- a rapid response time to changing conditions (50mS);<br /><br />- suitable timing for ‘arming’ a zero-crossing trigger device;<br /><br />- a single LPF which determines the dc-offset of raw VI samples;<br /><br />- a programmable safety margin for biassing import v. export;<br /><br />- minimal calibration is required.&lt;/div&gt;&lt;/div&gt;<br />Read the full post on the forum here: <a href="http://openenergymonitor.org/emon/node/841">http://openenergymonitor.org/emon/node/841</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Single AC power supply + voltage sensing]]></title>
    <link href="http://blog.openenergymonitor.org/2012/06/it-works-single-ac-power-supply-voltage/"/>
    <updated>2012-06-18T03:21:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2012/06/it-works-single-ac-power-supply-voltage</id>
    <content type="html"><![CDATA[<div dir="ltr" style="text-align: left;" trbidi="on">The idea of using the same AC-AC power adaptor for both sensing voltage and supplying power to emonTx has been discussed on the forums for months (see <a href="http://openenergymonitor.org/emon/node/309" target="_blank">this topic</a>), and about six weeks ago Glyn posted <a href="http://openenergymonitor.blogspot.de/2012/05/emontx-single-ac-power-supply.html" target="_blank">a simulation of a possible circuit</a>.<br /><br />I had the time this weekend to give it a try, bought the necessary components and put it all on a breadboard. After a sleepless night I can confirm: It works!<br /><br />Here is my messy setup:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-vFgjTQRFaMY/T96bNDBEo-I/AAAAAAAAARQ/BNybcVJIFfs/s1600/2012-06-18+04.55.43.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="380" src="http://1.bp.blogspot.com/-vFgjTQRFaMY/T96bNDBEo-I/AAAAAAAAARQ/BNybcVJIFfs/s640/2012-06-18+04.55.43.jpg" width="640" /></a><a href="http://1.bp.blogspot.com/-vFgjTQRFaMY/T96bNDBEo-I/AAAAAAAAARQ/BNybcVJIFfs/s1600/2012-06-18+04.55.43.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><br /><div style="text-align: left;"><br /></div></div><div style="text-align: left;"><br /></div><div style="text-align: left;"><a href="http://www.blogger.com/goog_1837366350"><br /></a></div><span style="clear: left; color: black; float: left; margin-bottom: 1em; margin-right: 1em; text-align: left;">Small modifications had to be made to get it to work: I added a 1uF cap between 3.3v and GND to&nbsp;filter out some noise and redefined the voltage calibration coefficient in the code.</span><span style="clear: left; color: black; float: left; margin-bottom: 1em; margin-right: 1em; text-align: left;">But the main problem (took me all night to figure it out) is that the usual emonTx sketch wont work straight ahead. The line that lights up the LED (on pin 9) at the end of the setup loop has to be commented out, otherwise the setup won't work. It's no problem to flash it 2ms after each packet is sent, but apparently having it on in the beginning will prevent the program from starting. Maybe there isn't enough current to do it and move on (I must say that I use 10k ohm resistors for the voltage dividers). If it's not that then maybe full wave rectification could help.</span><span style="clear: left; color: black; float: left; margin-bottom: 1em; margin-right: 1em; text-align: left;">I used a humble Xprotolab to measure the Vin, Vout and at some other points in the circuit. It behaves almost exactly like the simulation. fft also shows very little noise.</span><span style="clear: left; color: black; float: left; margin-bottom: 1em; margin-right: 1em; text-align: left;">Would be great if other members could repeat this experiment to see if the results will be the same.</span><span style="clear: left; color: black; float: left; margin-bottom: 1em; margin-right: 1em; text-align: left;">Next step: Voltage sensing on the base ;)&nbsp;</span><a href="http://1.bp.blogspot.com/-vFgjTQRFaMY/T96bNDBEo-I/AAAAAAAAARQ/BNybcVJIFfs/s1600/2012-06-18+04.55.43.jpg" imageanchor="1"><br style="color: black;" /></a></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[3 Phases AC monitoring]]></title>
    <link href="http://blog.openenergymonitor.org/2012/02/if-you-are-active-member-of/"/>
    <updated>2012-02-13T11:49:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2012/02/if-you-are-active-member-of</id>
    <content type="html"><![CDATA[<div dir="ltr" style="text-align: left;" trbidi="on">Note: this topic is still in development, there is an on-going discussion on the forum:&nbsp;<a href="http://openenergymonitor.org/emon/node/431">http://openenergymonitor.org/emon/node/431</a><br /><br />If you are an active member of OpenEnergyMonitor.org, then you know for sure that one of the challenges the project is facing is monitoring tri-phase AC systems (220V-400V).<br /><div>In theory it is as simple and easy as monitoring three one-phase systems with one voltage sensor per voltage phase, but in real life, it is not as easy as that.</div><div>Most of the time, plugs of the different phases are far from each others, and often there are no plugs for one or more phases (if it's for a special purpose like a night water heater). So this implies cabling one plug for each of the three phases in the cabinet and using 3 voltage sensors.</div><div><br /></div><div>This would hit one of the most important&nbsp;features of OpenEnergyMonitor: non-invasiveness.&nbsp;It would imply significantly more cabling and electrical work, this would also mean higher costs.</div><div><br /></div><div>I happen to know enough about principles of electrical power to be convinced that we can use one voltage sensor and three current sensors to monitor three-phases systems. Here is the theory:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-QxOn2-0s1_8/Tzjt2UEskxI/AAAAAAAAAQw/FeAWyFnM0nY/s1600/acp50.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-QxOn2-0s1_8/Tzjt2UEskxI/AAAAAAAAAQw/FeAWyFnM0nY/s1600/acp50.gif" /></a></div><div class="separator" style="clear: both; text-align: center;"><i><span style="font-size: xx-small;">Source:&nbsp;http://www.electronics-tutorials.ws/</span></i></div><div class="separator" style="clear: both; text-align: left;">The three voltage vectors are <b>always</b> shifted by 120°. What changes is the angle between a certain phase voltage and current vectors (a change caused by the properties of your load, but that's another story). So if the angle between two voltage vectors is always the same, then the phase shift of a current vector to the another phase voltage vector is exactly the phase shift of that current vector to its voltage vector + 120°.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b>Example from the figure above:</b></div><div class="separator" style="clear: both; text-align: left;">Phaseshift of red phase current and voltage= Phaseshift of red current vector and yellow voltage vector.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">So if we calculate the power factor of a current with any other voltage, we will of course get a wrong one, but we can always shift it by 120° and get the right one.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">I have a setup of what I call "See-a-Watt" (which is basically a device based on the plans and code of OpenEnergyMonitor, but that combines data acquisition ethernet connection) installed in a building on the campus of my university, with access to a three-phases installation. So I decided to test the theory there.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">The approach is as follows:</div><div class="separator" style="clear: both; text-align: left;"></div><ol style="text-align: left;"><li>Sample one voltage waveform out of three</li><li>Sample three current waveforms (of each phase</li><li>Calculate the phase shift (aka. power factor) of each of the three current waveforms to the one voltage waveform.</li><li>Send Vrms1, I1,I2, I3 and the power factors relative to each phase to emonCMS</li><li>Reverse the power factors to get the "wrong" phase, then compensate it with&nbsp;120° and recalculate the "right" power factor</li><li>Calculate the "right" powers = Ix * Vrms1 *'correct PF'</li></ol><br /><div class="separator" style="clear: both; text-align: left;">With the help of Trystan (he's much better with PHP than me and he knows emonCMS like the back of his hand) we implemented a function in emonCMS that reverses the "wrong" PF to the "wrong" phase shift angle, then shift it by + or -&nbsp;120° and recalculate the PF.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">This setup is working now for more than 6 weeks without any problem and the accuracy is comparable to the traditional accuracy of the non-invasive method: 1-2% not more.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Here is the code on the device side:&nbsp;<a href="https://github.com/AminfiBerlin/See-a-Watt-3-Phases">https://github.com/AminfiBerlin/See-a-Watt-3-Phases</a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">and here is the commit on emonCMS that introduced the phaseshift function:&nbsp;<a href="https://github.com/openenergymonitor/emoncms3/commit/a41c57d457df77697540b1a89a74486951e058ee">https://github.com/openenergymonitor/emoncms3/commit/a41c57d457df77697540b1a89a74486951e058ee</a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Needless to say that this is still in beta, I did not have any problem with it so far but that doesn't mean it's perfect. Please feel free to download the code and test it in every possible way.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><i>This is my first real contribution to any OpenSource project at all, I feel so proud and happy to be able to give back as much as I can.</i></div><div class="separator" style="clear: both; text-align: left;"><i><br /></i></div><div class="separator" style="clear: both; text-align: left;"><i>By&nbsp;<span class="Apple-style-span" style="background-color: white; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 14px;"><a href="http://openenergymonitor.org/emon/user/15">Amin Zayani</a></span></i></div><div><br /></div></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cheap AC transformers are no good]]></title>
    <link href="http://blog.openenergymonitor.org/2011/06/cheap-ac-transformer-are-no-good/"/>
    <updated>2011-06-24T11:15:00+00:00</updated>
    <id>http://blog.openenergymonitor.org/2011/06/cheap-ac-transformer-are-no-good</id>
    <content type="html"><![CDATA[<div style="text-align: left;">The Open Energy Monitor uses an AC transformer as a voltage sensor, but the choice of this transformer can influence the accuracy of your monitor.</div>
<div>
<br /></div>
<div>Jean Claude from JeeLabs (brilliant engineer BTW) investigated the difference between a bad and a good AC transformers and here are the results in images:</div>
<div>
<br /></div>
<div>1) Bad quality transformer:</div>
<div>
<br /></div>
<meta equiv="Content-Type" content="text/html;charset=UTF-8" />
<p><img src="http://jeelabs.org/wp-content/uploads/2011/06/open1.png" style="display:block; margin:0px auto 10px; text-align:center;cursor:pointer; cursor:hand;width: 604px; height: 108px;" border="0" alt="" />&lt;div&gt;
<br />&lt;/div&gt;&lt;div&gt;2)Better quality transformer:&lt;/div&gt;&lt;div&gt;
<br />&lt;/div&gt;&lt;div&gt;<meta charset="utf-8" /><a href="http://jeelabs.org/wp-content/uploads/2011/06/better.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img src="http://jeelabs.org/wp-content/uploads/2011/06/better.png" border="0" alt="" style="display: block; margin-top: 0px; margin-right: auto; margin-bottom: 10px; margin-left: auto; text-align: center; cursor: pointer; width: 604px; height: 301px; " /></a>&lt;/div&gt;&lt;div&gt;
<br />&lt;/div&gt;&lt;div&gt;You can read his complete post on his blog: <a href="http://jeelabs.org/2011/06/24/alternating-current/">JeeLabs Daily Weblog</a>.&lt;/div&gt;</p>
]]></content>
  </entry>
  
</feed>
