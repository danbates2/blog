<!doctype html>
  <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
  <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
  <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
  <!--[if gt IE 8]><!--> <html> <!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>emonTx single AC power supply - Part 1 Simulation - Blog | OpenEnergyMonitor</title>
    <meta name="author" content="Glyn Hudson">
    <meta name="description" content="OpenEnergyMonitor Blog">
    
    <meta name="viewport" content="width=device-width">
    <link rel="canonical" href="http://blog.openenergymonitor.org/2012/05/emontx-single-ac-power-supply/">

    <meta property="fb:app_id" content="">
    <meta property="og:title" content="emonTx single AC power supply - Part 1 Simulation">
    <meta property="og:site_name" content="Blog | OpenEnergyMonitor">
    <meta property="og:url" content="http://blog.openenergymonitor.org/2012/05/emontx-single-ac-power-supply/">
    <meta property="og:type" content="article">
    <meta property="og:description" content="">
    <meta property="og:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@openenergymon">
    
    <meta name="twitter:title" content="emonTx single AC power supply - Part 1 Simulation">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="https://guide.openenergymonitor.org/images/favicon-192x192.png">

    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
    <link href="/atom.xml" rel="alternate" title="Blog | OpenEnergyMonitor" type="application/atom+xml">
    <link rel='shortcut icon' href='/images/favicon.ico' />
    <link rel='icon' type='image/png' href='/images/favicon-192x192.png' sizes='192x192' />
    
    
    
    <link rel="shortcut icon" href="/favicon.ico">
	<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="196x196" href="/images/favicon-192.png">
	<link rel="icon" type="image/png" sizes="160x160" href="/images/favicon-160.png">
	<link rel="icon" type="image/png" sizes="96x96" href="/images/favicon-96.png">
	<link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
	<link rel="apple-touch-icon" href="/images/favicon-57.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon-114.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/images/favicon-72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/images/favicon-144.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/images/favicon-60.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/images/favicon-76.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180.png">
	<meta name="msapplication-TileColor" content="#FFFFFF">
	<meta name="msapplication-TileImage" content="/images/favicon-144.png">
	<meta name="msapplication-config" content="/images/browserconfig.xml">
	
  </head>

  <body >

    <header>
      <div class="grid-wrapper">
  <div class="grid">

    <div class="grid__item three-tenths lap-two-sixths palm-one-whole ha-title">
  <a href="/" class="site-title">
    <!--<img width='40' src='/images/favicon-192x192.png'> -->
    
    <span style="color:#555;font-weight:bold;font-family:Arial;font-size:20"'>
Open</span><span style="color:#0699fa;font-weight:bold;font-family:Arial;font-size:20"'>EnergyMonitor</span>

  </a>
</div>

<div class="grid__item seven-tenths lap-four-sixths palm-one-whole">
  <nav>
    <input type="checkbox" id="toggle">
<label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
<ul class="menu pull-right">
  <li><a href="http://openenergymonitor.org">Home</a></li>
  <li><a href="http://shop.openenergymonitor.com">Online-Store</a></li>
  <li><a href="http://guide.openenergymonitor.org">User Guide</a></li>
  <li><a href="http://emoncms.org">Emoncms</a></li>
  <li><a href="http://community.openenergymonitor.org">Forum</a></li>
</ul>
  </nav>
</div>

  </div>
</div>
    </header>

    

    <div class="grid-wrapper">
      <div class="grid grid-center">
        
        <div class="grid__item two-thirds lap-one-whole palm-one-whole">
        

          <article class="post">
  <div class='edit-github'><a href='https://github.com/openenergymonitor/blog/tree/master/source/_posts/2012-05-27-emontx-single-ac-power-supply.html'>Edit this post on GitHub</a></div>
  
  <header>
  
  <h1 class="title indent">emonTx single AC power supply - Part 1 Simulation</h1>
  

  
  <div class="meta clearfix">
    <time datetime="2012-05-27T21:29:00+00:00" pubdate data-updated="true"><i class="icon-calendar"></i> 2012-05-27 21:29:00 +00002012-05-27 21:29:00 +0000
    <span class="byline author vcard"><i class='icon-user'></i> Glyn Hudson</span> <br>
    <span><i class='icon-time'></i> three minutes reading time</span> <br>
    <span>
    <i class="icon-tags"></i>
    <ul class="tags unstyled">
    
      
        <li><a class='category' href='/categories/emontx/'>emonTx</a></li>
      
    
    </ul>
  </span> <br>
    
      <a class='comments'
         href="/2012/05/emontx-single-ac-power-supply/#disqus_thread"
         >Comments</a>
    
  </div>
  
</header>


  <table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><div style="text-align: left;">The current <a href="http://openenergymonitor.org/emon/emontx">emonTx V2.x</a> can monitor AC voltage, real power, power factor and direction of current flow, this is possible by using a plug-in 9V AC-AC transformer to provide a stepped-down AC voltage waveform. See&nbsp;<a href="http://openenergymonitor.org/emon/buildingblocks/measuring-voltage-with-an-acac-power-adapter">Measuring AC Voltage with an AC to AC power adapter</a>&nbsp;in the building blocks section for more details. The emonTx also requires an additional (separate) DC power source, this is usually provided by a 5V USB&nbsp;plug-in&nbsp;adaptor.<br /><br /></div><div style="text-align: left;">Obviously it's desirable to do away with one of the power supplies and to use the AC-AC adapter to provide both the AC signal and the DC power to the emonTx. Early tests indicated that using the AC signal to provide a DC power supply&nbsp;adversely&nbsp;effected&nbsp;the quality of the AC&nbsp;signal&nbsp;and therefore the voltage and real power reading of the emonTx. Full wave&nbsp;rectification with a bridge rectifier creates a power supply with floating supply rails&nbsp;and loading the AC-AC adaptor caused distortion of the AC sine wave sample signal.</div><div style="text-align: left;"><br /></div><div style="text-align: left;">There has been an interesting <a href="http://openenergymonitor.org/emon/node/309">form thread</a> on the topic of using a single AC power supply for the emonTx. There were number of suggestions for circuits to&nbsp;achieve&nbsp;this. Many of the circuits suggested looked&nbsp;feasible&nbsp;but some added&nbsp;considerable&nbsp;complexity&nbsp;and components such as centre-tapped or isolating transformers. We are keen to use an off-the-shelf certified power supply unit wherever direct connection to mains power is involved.&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><span style="text-align: center;">Recently</span>&nbsp;<a href="http://openenergymonitor.org/emon/user/924">Robert Wall</a> contacted us with a single AC power supply circuit design based on a half-wave rectifier and LDO linear voltage regulator. The circuit only requires an additional two capacitors, two diodes and one resistor to&nbsp;supplement the&nbsp;components we already have on the emonTx PCB. Robert has been very helpful offering his expertise and experience as an Electronic Engineer to the project. The technical testing report on the <a href="http://openenergymonitor.org/emon/buildingblocks/report-yhdc-sct-013-000-current-transformer">SCT-013-000 CT</a> and <a href="http://openenergymonitor.org/emon/buildingblocks/report-mascot-9v-acac-adaptor">Mascot AC-AC adapter</a> in the building blocks section are all Robert's work.&nbsp;</div><div style="text-align: left;"><br /></div><div style="text-align: left;"><i>Note: this circuit design is still in development, we are currently at the simulation stage</i></div><div style="text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-3El_MoBPMCI/T8H-QwqxftI/AAAAAAAAbn4/Zl-kBlwbQRI/s1600/Half+wave+rectifier+power+supply+labeled+diagram.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="188" src="http://1.bp.blogspot.com/-3El_MoBPMCI/T8H-QwqxftI/AAAAAAAAbn4/Zl-kBlwbQRI/s640/Half+wave+rectifier+power+supply+labeled+diagram.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: 13px;">Fig1. Half wave rectifier AC-DC power supply and AC voltage sample&nbsp;</span></div></td></tr></tbody></table><div class="separator" style="clear: both; text-align: left;">The key to Robert's circuit is current limiting resistor R1, this limits the current draw from capacitor C1. The resistor value was chosen to attempt to charge C1 gradually over the positive half cycle. See the&nbsp;labelled&nbsp;waveforms below to see how this works in <strike>practice</strike> simulation! C2 is a de-coupling capacitor and R3-R5 reduce the AC sample to the correct magnitude and bias ready to be sampled by the ATmega328 ADC.&nbsp;</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-LrkqHchGQfg/T8FaT2Amz6I/AAAAAAAAbnQ/W3fqDUGCEzI/s1600/Simulation+waveforms+under+normal+operating+conditions.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="369" src="http://4.bp.blogspot.com/-LrkqHchGQfg/T8FaT2Amz6I/AAAAAAAAbnQ/W3fqDUGCEzI/s640/Simulation+waveforms+under+normal+operating+conditions.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Fig2. Simulation waveforms under normal operating conditions</td></tr></tbody></table><div class="separator" style="clear: both; text-align: left;">To demonstrate the effect of the current limiting resistor R1 the simulation was ran with R1= 1 ohm, see the labelled waveforms in Fig.3 below. The capacitor C1 now charges up quicker drawing more current from the AC-AC adapter, this loads the adapter creating a 'dip' in the AC sample waveform. This will&nbsp;negatively&nbsp;effect the voltage and real power reading on the emonTx.&nbsp;</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-fk2Npys5kp0/T8FaSBg5KhI/AAAAAAAAbnE/ug8gSng4hqo/s1600/Effect+of+low+value+current+limiting+resistor+R1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="284" src="http://4.bp.blogspot.com/-fk2Npys5kp0/T8FaSBg5KhI/AAAAAAAAbnE/ug8gSng4hqo/s640/Effect+of+low+value+current+limiting+resistor+R1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Fig. 3 Demonstrating the effect of low value current limiting resistor R1</td></tr></tbody></table>Simulation has indicated that with a current draw of about 8mA (ATmega328) and using the Mascot AC-AC power adapter with a mains voltage of about 240Vrms results in a -6mV&nbsp;difference&nbsp;in the Vrms of the sample waveform when compared with a perfect&nbsp;sine wave. This should be small enough to not&nbsp;adversely&nbsp;effect the AC voltage and real power reading, a tweaking of the calibration will probably be required.<br /><br />The next step is to move beyond the&nbsp;virtual;&nbsp;build up a prototype to see if it performs in practice like the simulation suggests!<br /><br />I've posted the<a href="http://www.linear.com/designtools/software/#LTspice"> LTspice</a> simulation files used to generate the simulation waveforms on the forum:&nbsp;<a href="http://openenergymonitor.org/emon/node/704">http://openenergymonitor.org/emon/node/704</a>
      <b>To engage in discussion regarding this post, please post on our <a href="http://community.openenergymonitor.org">Community Forum</a></b>.
    <br>
</article>



        </div>

        
        <aside id="sidebar" class="grid__item one-third lap-one-whole palm-one-whole">
          <div class="grid">

 
 <section id="recent-posts" class="aside-module grid__item one-whole lap-one-half">
  <h1 class="title delta">Recent Posts</h1>
  <ul class="divided">
    
      
        <li class="post">
          <a href="/2016/05/website-changes/">New Forum, Blog and User Guide Website</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/05/Part3-Aggregated-supply-and-demand/">Part 3: Aggregated supply and demand across multiple households</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Part-2-Exploring-carbon-intensity/">Part 2: Exploring carbon intensity and renewable energy matching: real-time grid CO2 intensity + on-site and grid renewable energy</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Understand-CO2-intensity-grid-electricity/">Part 1: Attempting to measure and understand the CO2 intensity of grid electricity</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Git-Sub-Modules/">GitHub Submodules</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/04/Home-Assistant/">Home Assistant and emonPi</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/03/raspberry-pi-3/">Raspberry Pi 3 </a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/02/outdoor-temperature-data-from-weather/">Outdoor Temperature Data from Weather Underground to Emoncms & MQTT</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/02/heat-pump-testing-initial-results/">Heat pump Testing: Initial results</a>
        </li>
      
    
      
        <li class="post">
          <a href="/2016/01/french-low-carbon-energy-film-featuring/">Low carbon energy film featuring OpenEnergyMonitor</a>
        </li>
      
    
  </ul>
</section>
  
  
</div>
        </aside>
        
      </div>
    </div>

    <footer>
      <div class="grid-wrapper">
  <div class="grid">
    <div class="grid__item">
      <div class="copyright">
  <a rel="me" href='https://twitter.com/openenergymon'><i class="icon-twitter"></i></a>
  <a rel="me" href='https://github.com/openenergymonitor'><i class="icon-github"></i></a>
  <a rel="me" href='http://blog.openenergymonitor.org/atom.xml'><i class="icon-rss"></i></a>

  <div class="credit">
    Website powered by <a href='http://jekyllrb.com/'>Jekyll</a> and the <a href='https://github.com/coogie/oscailte'>Oscalite theme</a>.<br />
    Hosted by <a href='https://pages.github.com/'>GitHub</a> and served by <a href='https://cloudflare.com'>CloudFlare</a>.
  </div>
</div>
    </div>
  </div>
</div>
    </footer>

    <!--[if lt IE 7]>
      <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
    <![endif]-->

    <script>
  var _gaq=[['_setAccount','UA-10321170-4'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
<script>
  var disqus_shortname = 'openenergymonitor';
  
    
    var disqus_script = 'count.js';
  
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  }());
</script>


<script>
  $(document).ready(function(){
    if (!window.jXHR){
      var jxhr = document.createElement('script');
      jxhr.type = 'text/javascript';
      jxhr.src = '/javascripts/libs/jXHR.js';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jxhr, s);
    }

    github.showRepos({
      user: 'openenergymonitor',
      count: 5,
      skip_forks: true,
      target: '#gh_repos'
    });
  });
</script>
<script src="/javascripts/github.js"></script>

  </body>
</html>