---
layout: post
title: emonGLCD V1.3 Switches - fix!
date: '2012-04-12T05:26:00.000-07:00'
author: Glyn Hudson
categories:
- emonGLCD
modified_time: '2012-04-12T13:51:58.549-07:00'
thumbnail: http://1.bp.blogspot.com/-RfCv8uKzpMw/T4bArjw0Z3I/AAAAAAAAZ_0/6Qk37khJ4aA/s72-c/IMG1348.jpg
blogger_id: tag:blogger.com,1999:blog-2472065242652647619.post-1563341668529715622
blogger_orig_url: http://blog.openenergymonitor.org/2012/04/emonglcd-v13-switches-fix.html
---

It was mentioned in <a href="http://openenergymonitor.blogspot.co.uk/2012/02/emonglcd-v13-pcb.html">this blog post </a>regarding the current version of the emonGLCD (V1.3) that a hardware error rendered the push switches un-usable. This is not the case any more!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-RfCv8uKzpMw/T4bArjw0Z3I/AAAAAAAAZ_0/6Qk37khJ4aA/s1600/IMG1348.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://1.bp.blogspot.com/-RfCv8uKzpMw/T4bArjw0Z3I/AAAAAAAAZ_0/6Qk37khJ4aA/s320/IMG1348.jpg" width="320" /></a></div><br /><br />It turns out that this error can be fixed in software. The switches can be made to work with no hardware modifications. The <a href="https://github.com/openenergymonitor/emonGLCD/">emonGLCD tester sketch</a> has been updated with the required fix.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-JlrYaGzD0So/T4c_7eKq1uI/AAAAAAAAaAM/IZC87swXDPQ/s1600/glcd_sw2__19976_zoom.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://3.bp.blogspot.com/-JlrYaGzD0So/T4c_7eKq1uI/AAAAAAAAaAM/IZC87swXDPQ/s320/glcd_sw2__19976_zoom.jpg" width="320" /></a></div><br /><br />Here are the details:<br /><br />The push switches are connected ADC 1,2 and 5 (digital 15,16 and 19). When pressed they are pulled low through resistor R5.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-El2msFAJQQ4/T4bAYwmMe0I/AAAAAAAAZ_s/O_C7Eq1g4yQ/s1600/Screenshot+at+2012-04-12+12:43:13.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://1.bp.blogspot.com/-El2msFAJQQ4/T4bAYwmMe0I/AAAAAAAAZ_s/O_C7Eq1g4yQ/s320/Screenshot+at+2012-04-12+12:43:13.png" width="283" /></a></div><div class="separator" style="clear: both; text-align: left;">The Atmega328 has internal pull-up resistors (20K) which can be enabled by setting the port as output and doing a high digital write:</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"></div><pre style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;"><div class="line" id="LC62" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #333333; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 1em; padding-right: 0px; padding-top: 0px;"><br /><span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">pinMode</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">(</span><span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">switchpin</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">,</span> <span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">INPUT</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">);</span> </div><br /><div class="line" id="LC63" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #333333; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 1em; padding-right: 0px; padding-top: 0px;"><br /><span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">digitalWrite</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">(</span><span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">switchpin</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">,</span> <span class="n" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">HIGH</span><span class="p" style="border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font: inherit; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px;">);</span></div><br /></pre>The switches are active low, meaning a logic 0 will be read on digital 15,16 and 19 when the relevant switch is pressed.&nbsp;<div><br />Thanks to forum member <a href="http://openenergymonitor.org/emon/user/859">Drsdre</a> for bringing this elegant fix to our attention. This is a real open-hardware success story!   If you've bought an emonGLCD from us we will send out on request the three switches to be added free of charge. <br /><br />We have created an item for the extra switches in the shop, just click buy (it's free) and quote your original order number: <a href="http://shop.openenergymonitor.com/displays/">http://shop.openenergymonitor.com/displays/</a><br /><br />All emonGLCD kits bought from the shop from now on will include the switches. <br /><br />Happy days. </div>