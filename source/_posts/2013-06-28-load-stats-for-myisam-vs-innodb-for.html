---
layout: post
title: Load stat's for MYISAM vs INNODB for feed storage on the RaspberryPI
date: '2013-06-28T01:26:00.000-07:00'
author: Trystan Lea
categories:
- emoncms
- feed storage
modified_time: '2013-07-04T05:04:50.316-07:00'
thumbnail: http://3.bp.blogspot.com/-TDFZZ7cyfbE/Uc1E7dSLCeI/AAAAAAAACtI/vbG7etiFS2g/s72-c/innodb_raspi_load.png
blogger_id: tag:blogger.com,1999:blog-2472065242652647619.post-4813048027616214485
blogger_orig_url: http://blog.openenergymonitor.org/2013/06/load-stats-for-myisam-vs-innodb-for.html
---

Here are some historic load stats for a raspberrypi running here, with 36 feeds being written to.<br /><div><br /></div><div>First using the INNODB storage engine:<br /><div class="separator" style="clear: both; text-align: center;"><span style="text-align: left;"><br /></span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-TDFZZ7cyfbE/Uc1E7dSLCeI/AAAAAAAACtI/vbG7etiFS2g/s925/innodb_raspi_load.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="280" src="http://3.bp.blogspot.com/-TDFZZ7cyfbE/Uc1E7dSLCeI/AAAAAAAACtI/vbG7etiFS2g/s640/innodb_raspi_load.png" width="640" /></a></div>A load of 3.5 causes an issue where the time that is recorded for data packets coming in gets messed up creating bunched up datapoints:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Jhg1mpnwIMQ/Uc1HL91zhjI/AAAAAAAACtg/h-vzID3xHro/s948/timingissue.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="270" src="http://4.bp.blogspot.com/-Jhg1mpnwIMQ/Uc1HL91zhjI/AAAAAAAACtg/h-vzID3xHro/s640/timingissue.png" width="640" /></a></div><br />Switching the storage engine over the MYISAM, reduced the load to around 0.2 and the timing issue is no longer present:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-vPe12-x2Gtc/Uc1FAYirGeI/AAAAAAAACtQ/Q5bp_VsvwmQ/s944/piloadmyisam.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="274" src="http://4.bp.blogspot.com/-vPe12-x2Gtc/Uc1FAYirGeI/AAAAAAAACtQ/Q5bp_VsvwmQ/s640/piloadmyisam.png" width="640" /></a></div><br />To convert your raspberry pi emoncms Innodb tables to MYISAM you can run the following script on your raspberrypi which will go through each table converting them in turn:<br /><br /><br /><br />&nbsp; $mysqli = new mysqli("localhost","root","raspberry","emoncms");<br /><br />&nbsp; $result = $mysqli-&gt;query("SHOW tables");<br />&nbsp; while ($row = $result-&gt;fetch_array())<br />&nbsp; {<br />&nbsp; &nbsp; echo "ALTER TABLE `".$row[0]."` ENGINE=MYISAM\n";<br />&nbsp; &nbsp; $mysqli-&gt;query("ALTER TABLE `".$row[0]."` ENGINE=MYISAM");<br />&nbsp; }<br /><br /></div>